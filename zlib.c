multiline_comment|/*&n; * zlib wrappers to make sure we don&squot;t silently miss errors&n; * at init time.&n; */
macro_line|#include &quot;cache.h&quot;
DECL|function|git_inflate_init
r_void
id|git_inflate_init
c_func
(paren
id|z_streamp
id|strm
)paren
(brace
r_const
r_char
op_star
id|err
suffix:semicolon
r_switch
c_cond
(paren
id|inflateInit
c_func
(paren
id|strm
)paren
)paren
(brace
r_case
id|Z_OK
suffix:colon
r_return
suffix:semicolon
r_case
id|Z_MEM_ERROR
suffix:colon
id|err
op_assign
l_string|&quot;out of memory&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|Z_VERSION_ERROR
suffix:colon
id|err
op_assign
l_string|&quot;wrong version&quot;
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|err
op_assign
l_string|&quot;error&quot;
suffix:semicolon
)brace
id|die
c_func
(paren
l_string|&quot;inflateInit: %s (%s)&quot;
comma
id|err
comma
id|strm-&gt;msg
ques
c_cond
id|strm-&gt;msg
suffix:colon
l_string|&quot;no message&quot;
)paren
suffix:semicolon
)brace
DECL|function|git_inflate_end
r_void
id|git_inflate_end
c_func
(paren
id|z_streamp
id|strm
)paren
(brace
r_if
c_cond
(paren
id|inflateEnd
c_func
(paren
id|strm
)paren
op_ne
id|Z_OK
)paren
id|error
c_func
(paren
l_string|&quot;inflateEnd: %s&quot;
comma
id|strm-&gt;msg
ques
c_cond
id|strm-&gt;msg
suffix:colon
l_string|&quot;failed&quot;
)paren
suffix:semicolon
)brace
DECL|function|git_inflate
r_int
id|git_inflate
c_func
(paren
id|z_streamp
id|strm
comma
r_int
id|flush
)paren
(brace
r_int
id|ret
op_assign
id|inflate
c_func
(paren
id|strm
comma
id|flush
)paren
suffix:semicolon
r_const
r_char
op_star
id|err
suffix:semicolon
r_switch
c_cond
(paren
id|ret
)paren
(brace
multiline_comment|/* Out of memory is fatal. */
r_case
id|Z_MEM_ERROR
suffix:colon
id|die
c_func
(paren
l_string|&quot;inflate: out of memory&quot;
)paren
suffix:semicolon
multiline_comment|/* Data corruption errors: we may want to recover from them (fsck) */
r_case
id|Z_NEED_DICT
suffix:colon
id|err
op_assign
l_string|&quot;needs dictionary&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|Z_DATA_ERROR
suffix:colon
id|err
op_assign
l_string|&quot;data stream error&quot;
suffix:semicolon
r_break
suffix:semicolon
r_case
id|Z_STREAM_ERROR
suffix:colon
id|err
op_assign
l_string|&quot;stream consistency error&quot;
suffix:semicolon
r_break
suffix:semicolon
r_default
suffix:colon
id|err
op_assign
l_string|&quot;unknown error&quot;
suffix:semicolon
r_break
suffix:semicolon
multiline_comment|/* Z_BUF_ERROR: normal, needs more space in the output buffer */
r_case
id|Z_BUF_ERROR
suffix:colon
r_case
id|Z_OK
suffix:colon
r_case
id|Z_STREAM_END
suffix:colon
r_return
id|ret
suffix:semicolon
)brace
id|error
c_func
(paren
l_string|&quot;inflate: %s (%s)&quot;
comma
id|err
comma
id|strm-&gt;msg
ques
c_cond
id|strm-&gt;msg
suffix:colon
l_string|&quot;no message&quot;
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
eof
