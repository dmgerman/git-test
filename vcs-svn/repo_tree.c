multiline_comment|/*&n; * Licensed under a two-clause BSD-style license.&n; * See LICENSE for details.&n; */
macro_line|#include &quot;git-compat-util.h&quot;
macro_line|#include &quot;strbuf.h&quot;
macro_line|#include &quot;repo_tree.h&quot;
macro_line|#include &quot;fast_export.h&quot;
DECL|function|repo_read_path
r_const
r_char
op_star
id|repo_read_path
c_func
(paren
r_const
r_uint32
op_star
id|path
comma
r_uint32
op_star
id|mode_out
)paren
(brace
r_int
id|err
suffix:semicolon
r_static
r_struct
id|strbuf
id|buf
op_assign
id|STRBUF_INIT
suffix:semicolon
id|strbuf_reset
c_func
(paren
op_amp
id|buf
)paren
suffix:semicolon
id|err
op_assign
id|fast_export_ls
c_func
(paren
id|REPO_MAX_PATH_DEPTH
comma
id|path
comma
id|mode_out
comma
op_amp
id|buf
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
(brace
r_if
c_cond
(paren
id|errno
op_ne
id|ENOENT
)paren
id|die_errno
c_func
(paren
l_string|&quot;BUG: unexpected fast_export_ls error&quot;
)paren
suffix:semicolon
multiline_comment|/* Treat missing paths as directories. */
op_star
id|mode_out
op_assign
id|REPO_MODE_DIR
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
r_return
id|buf.buf
suffix:semicolon
)brace
DECL|function|repo_copy
r_void
id|repo_copy
c_func
(paren
r_uint32
id|revision
comma
r_const
r_uint32
op_star
id|src
comma
r_const
r_uint32
op_star
id|dst
)paren
(brace
r_int
id|err
suffix:semicolon
r_uint32
id|mode
suffix:semicolon
r_static
r_struct
id|strbuf
id|data
op_assign
id|STRBUF_INIT
suffix:semicolon
id|strbuf_reset
c_func
(paren
op_amp
id|data
)paren
suffix:semicolon
id|err
op_assign
id|fast_export_ls_rev
c_func
(paren
id|revision
comma
id|REPO_MAX_PATH_DEPTH
comma
id|src
comma
op_amp
id|mode
comma
op_amp
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|err
)paren
(brace
r_if
c_cond
(paren
id|errno
op_ne
id|ENOENT
)paren
id|die_errno
c_func
(paren
l_string|&quot;BUG: unexpected fast_export_ls_rev error&quot;
)paren
suffix:semicolon
id|fast_export_delete
c_func
(paren
id|REPO_MAX_PATH_DEPTH
comma
id|dst
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|fast_export_modify
c_func
(paren
id|REPO_MAX_PATH_DEPTH
comma
id|dst
comma
id|mode
comma
id|data.buf
)paren
suffix:semicolon
)brace
DECL|function|repo_delete
r_void
id|repo_delete
c_func
(paren
r_uint32
op_star
id|path
)paren
(brace
id|fast_export_delete
c_func
(paren
id|REPO_MAX_PATH_DEPTH
comma
id|path
)paren
suffix:semicolon
)brace
eof
