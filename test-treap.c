multiline_comment|/*&n; * test-treap.c: code to exercise the svn importer&squot;s treap structure&n; */
macro_line|#include &quot;cache.h&quot;
macro_line|#include &quot;vcs-svn/obj_pool.h&quot;
macro_line|#include &quot;vcs-svn/trp.h&quot;
DECL|struct|int_node
r_struct
id|int_node
(brace
DECL|member|n
r_uintmax
id|n
suffix:semicolon
DECL|member|children
r_struct
id|trp_node
id|children
suffix:semicolon
)brace
suffix:semicolon
id|obj_pool_gen
c_func
(paren
id|node
comma
r_struct
id|int_node
comma
l_int|3
)paren
DECL|function|node_cmp
r_static
r_int
id|node_cmp
c_func
(paren
r_struct
id|int_node
op_star
id|a
comma
r_struct
id|int_node
op_star
id|b
)paren
(brace
r_return
(paren
id|a-&gt;n
OG
id|b-&gt;n
)paren
(paren
id|a-&gt;n
OL
id|b-&gt;n
)paren
suffix:semicolon
)brace
id|trp_gen
c_func
(paren
r_static
comma
id|treap_
comma
r_struct
id|int_node
comma
id|children
comma
id|node
comma
id|node_cmp
)paren
DECL|function|strtonode
r_static
r_void
id|strtonode
c_func
(paren
r_struct
id|int_node
op_star
id|item
comma
r_const
r_char
op_star
id|s
)paren
(brace
r_char
op_star
id|end
suffix:semicolon
id|item-&gt;n
op_assign
id|strtoumax
c_func
(paren
id|s
comma
op_amp
id|end
comma
l_int|10
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|s
op_eq
l_char|&squot;&bslash;0&squot;
op_logical_or
(paren
op_star
id|end
op_ne
l_char|&squot;&bslash;n&squot;
op_logical_and
op_star
id|end
op_ne
l_char|&squot;&bslash;0&squot;
)paren
)paren
id|die
c_func
(paren
l_string|&quot;invalid integer: %s&quot;
comma
id|s
)paren
suffix:semicolon
)brace
DECL|function|main
r_int
id|main
c_func
(paren
r_int
id|argc
comma
r_char
op_star
id|argv
(braket
)braket
)paren
(brace
r_struct
id|strbuf
id|sb
op_assign
id|STRBUF_INIT
suffix:semicolon
r_struct
id|trp_root
id|root
op_assign
(brace
op_complement
l_int|0
)brace
suffix:semicolon
r_uint32
id|item
suffix:semicolon
r_if
c_cond
(paren
id|argc
op_ne
l_int|1
)paren
id|usage
c_func
(paren
l_string|&quot;test-treap &lt; ints&quot;
)paren
suffix:semicolon
r_while
c_loop
(paren
id|strbuf_getline
c_func
(paren
op_amp
id|sb
comma
id|stdin
comma
l_char|&squot;&bslash;n&squot;
)paren
op_ne
id|EOF
)paren
(brace
r_struct
id|int_node
op_star
id|node
op_assign
id|node_pointer
c_func
(paren
id|node_alloc
c_func
(paren
l_int|1
)paren
)paren
suffix:semicolon
id|item
op_assign
id|node_offset
c_func
(paren
id|node
)paren
suffix:semicolon
id|strtonode
c_func
(paren
id|node
comma
id|sb.buf
)paren
suffix:semicolon
id|node
op_assign
id|treap_insert
c_func
(paren
op_amp
id|root
comma
id|node_pointer
c_func
(paren
id|item
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|node_offset
c_func
(paren
id|node
)paren
op_ne
id|item
)paren
id|die
c_func
(paren
l_string|&quot;inserted %&quot;
id|PRIu32
l_string|&quot; in place of %&quot;
id|PRIu32
l_string|&quot;&quot;
comma
id|node_offset
c_func
(paren
id|node
)paren
comma
id|item
)paren
suffix:semicolon
)brace
id|item
op_assign
id|node_offset
c_func
(paren
id|treap_first
c_func
(paren
op_amp
id|root
)paren
)paren
suffix:semicolon
r_while
c_loop
(paren
op_complement
id|item
)paren
(brace
r_uint32
id|next
suffix:semicolon
r_struct
id|int_node
op_star
id|tmp
op_assign
id|node_pointer
c_func
(paren
id|node_alloc
c_func
(paren
l_int|1
)paren
)paren
suffix:semicolon
id|tmp-&gt;n
op_assign
id|node_pointer
c_func
(paren
id|item
)paren
op_member_access_from_pointer
id|n
suffix:semicolon
id|next
op_assign
id|node_offset
c_func
(paren
id|treap_next
c_func
(paren
op_amp
id|root
comma
id|node_pointer
c_func
(paren
id|item
)paren
)paren
)paren
suffix:semicolon
id|treap_remove
c_func
(paren
op_amp
id|root
comma
id|node_pointer
c_func
(paren
id|item
)paren
)paren
suffix:semicolon
id|item
op_assign
id|node_offset
c_func
(paren
id|treap_nsearch
c_func
(paren
op_amp
id|root
comma
id|tmp
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|item
op_ne
id|next
op_logical_and
(paren
op_logical_neg
op_complement
id|item
op_logical_or
id|node_pointer
c_func
(paren
id|item
)paren
op_member_access_from_pointer
id|n
op_ne
id|tmp-&gt;n
)paren
)paren
id|die
c_func
(paren
l_string|&quot;found %&quot;
id|PRIuMAX
l_string|&quot; in place of %&quot;
id|PRIuMAX
l_string|&quot;&quot;
comma
op_complement
id|item
ques
c_cond
id|node_pointer
c_func
(paren
id|item
)paren
op_member_access_from_pointer
id|n
suffix:colon
op_complement
(paren
r_uintmax
)paren
l_int|0
comma
op_complement
id|next
ques
c_cond
id|node_pointer
c_func
(paren
id|next
)paren
op_member_access_from_pointer
id|n
suffix:colon
op_complement
(paren
r_uintmax
)paren
l_int|0
)paren
suffix:semicolon
id|printf
c_func
(paren
l_string|&quot;%&quot;
id|PRIuMAX
l_string|&quot;&bslash;n&quot;
comma
id|tmp-&gt;n
)paren
suffix:semicolon
)brace
id|node_reset
c_func
(paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
eof
