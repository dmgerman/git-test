macro_line|#include &quot;cache.h&quot;
macro_line|#include &quot;commit.h&quot;
macro_line|#include &quot;tag.h&quot;
macro_line|#include &quot;merge-recursive.h&quot;
DECL|function|better_branch_name
r_static
r_const
r_char
op_star
id|better_branch_name
c_func
(paren
r_const
r_char
op_star
id|branch
)paren
(brace
r_static
r_char
id|githead_env
(braket
l_int|8
op_plus
l_int|40
op_plus
l_int|1
)braket
suffix:semicolon
r_char
op_star
id|name
suffix:semicolon
r_if
c_cond
(paren
id|strlen
c_func
(paren
id|branch
)paren
op_ne
l_int|40
)paren
r_return
id|branch
suffix:semicolon
id|sprintf
c_func
(paren
id|githead_env
comma
l_string|&quot;GITHEAD_%s&quot;
comma
id|branch
)paren
suffix:semicolon
id|name
op_assign
id|getenv
c_func
(paren
id|githead_env
)paren
suffix:semicolon
r_return
id|name
ques
c_cond
id|name
suffix:colon
id|branch
suffix:semicolon
)brace
DECL|function|get_ref
r_static
r_struct
id|commit
op_star
id|get_ref
c_func
(paren
r_const
r_char
op_star
id|ref
)paren
(brace
r_int
r_char
id|sha1
(braket
l_int|20
)braket
suffix:semicolon
r_struct
id|object
op_star
id|object
suffix:semicolon
r_if
c_cond
(paren
id|get_sha1
c_func
(paren
id|ref
comma
id|sha1
)paren
)paren
id|die
c_func
(paren
l_string|&quot;Could not resolve ref &squot;%s&squot;&quot;
comma
id|ref
)paren
suffix:semicolon
id|object
op_assign
id|deref_tag
c_func
(paren
id|parse_object
c_func
(paren
id|sha1
)paren
comma
id|ref
comma
id|strlen
c_func
(paren
id|ref
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|object
)paren
r_return
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|object-&gt;type
op_eq
id|OBJ_TREE
)paren
r_return
id|make_virtual_commit
c_func
(paren
(paren
r_struct
id|tree
op_star
)paren
id|object
comma
id|better_branch_name
c_func
(paren
id|ref
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|object-&gt;type
op_ne
id|OBJ_COMMIT
)paren
r_return
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|parse_commit
c_func
(paren
(paren
r_struct
id|commit
op_star
)paren
id|object
)paren
)paren
id|die
c_func
(paren
l_string|&quot;Could not parse commit &squot;%s&squot;&quot;
comma
id|sha1_to_hex
c_func
(paren
id|object-&gt;sha1
)paren
)paren
suffix:semicolon
r_return
(paren
r_struct
id|commit
op_star
)paren
id|object
suffix:semicolon
)brace
DECL|function|cmd_merge_recursive
r_int
id|cmd_merge_recursive
c_func
(paren
r_int
id|argc
comma
r_const
r_char
op_star
op_star
id|argv
comma
r_const
r_char
op_star
id|prefix
)paren
(brace
r_static
r_const
r_char
op_star
id|bases
(braket
l_int|20
)braket
suffix:semicolon
r_static
r_int
id|bases_count
op_assign
l_int|0
suffix:semicolon
r_int
id|i
comma
id|clean
suffix:semicolon
r_const
r_char
op_star
id|branch1
comma
op_star
id|branch2
suffix:semicolon
r_struct
id|commit
op_star
id|result
comma
op_star
id|h1
comma
op_star
id|h2
suffix:semicolon
r_struct
id|commit_list
op_star
id|ca
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|lock_file
op_star
id|lock
op_assign
id|xcalloc
c_func
(paren
l_int|1
comma
r_sizeof
(paren
r_struct
id|lock_file
)paren
)paren
suffix:semicolon
r_int
id|index_fd
suffix:semicolon
r_int
id|subtree_merge
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|argv
(braket
l_int|0
)braket
)paren
(brace
r_int
id|namelen
op_assign
id|strlen
c_func
(paren
id|argv
(braket
l_int|0
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|8
OL
id|namelen
op_logical_and
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|0
)braket
op_plus
id|namelen
l_int|8
comma
l_string|&quot;-subtree&quot;
)paren
)paren
id|subtree_merge
op_assign
l_int|1
suffix:semicolon
)brace
id|git_config
c_func
(paren
id|merge_recursive_config
comma
l_int|NULL
)paren
suffix:semicolon
id|merge_recursive_setup
c_func
(paren
id|subtree_merge
)paren
suffix:semicolon
r_if
c_cond
(paren
id|argc
OL
l_int|4
)paren
id|die
c_func
(paren
l_string|&quot;Usage: %s &lt;base&gt;... -- &lt;head&gt; &lt;remote&gt; ...&bslash;n&quot;
comma
id|argv
(braket
l_int|0
)braket
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
OL
id|argc
suffix:semicolon
op_increment
id|i
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
id|i
)braket
comma
l_string|&quot;--&quot;
)paren
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|bases_count
OL
r_sizeof
(paren
id|bases
)paren
op_div
r_sizeof
(paren
op_star
id|bases
)paren
)paren
id|bases
(braket
id|bases_count
op_increment
)braket
op_assign
id|argv
(braket
id|i
)braket
suffix:semicolon
)brace
r_if
c_cond
(paren
id|argc
id|i
op_ne
l_int|3
)paren
multiline_comment|/* &quot;--&quot; &quot;&lt;head&gt;&quot; &quot;&lt;remote&gt;&quot; */
id|die
c_func
(paren
l_string|&quot;Not handling anything other than two heads merge.&quot;
)paren
suffix:semicolon
id|branch1
op_assign
id|argv
(braket
op_increment
id|i
)braket
suffix:semicolon
id|branch2
op_assign
id|argv
(braket
op_increment
id|i
)braket
suffix:semicolon
id|h1
op_assign
id|get_ref
c_func
(paren
id|branch1
)paren
suffix:semicolon
id|h2
op_assign
id|get_ref
c_func
(paren
id|branch2
)paren
suffix:semicolon
id|branch1
op_assign
id|better_branch_name
c_func
(paren
id|branch1
)paren
suffix:semicolon
id|branch2
op_assign
id|better_branch_name
c_func
(paren
id|branch2
)paren
suffix:semicolon
r_if
c_cond
(paren
id|merge_recursive_verbosity
op_ge
l_int|3
)paren
id|printf
c_func
(paren
l_string|&quot;Merging %s with %s&bslash;n&quot;
comma
id|branch1
comma
id|branch2
)paren
suffix:semicolon
id|index_fd
op_assign
id|hold_locked_index
c_func
(paren
id|lock
comma
l_int|1
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|bases_count
suffix:semicolon
id|i
op_increment
)paren
(brace
r_struct
id|commit
op_star
id|ancestor
op_assign
id|get_ref
c_func
(paren
id|bases
(braket
id|i
)braket
)paren
suffix:semicolon
id|ca
op_assign
id|commit_list_insert
c_func
(paren
id|ancestor
comma
op_amp
id|ca
)paren
suffix:semicolon
)brace
id|clean
op_assign
id|merge_recursive
c_func
(paren
id|h1
comma
id|h2
comma
id|branch1
comma
id|branch2
comma
id|ca
comma
op_amp
id|result
)paren
suffix:semicolon
r_if
c_cond
(paren
id|active_cache_changed
op_logical_and
(paren
id|write_cache
c_func
(paren
id|index_fd
comma
id|active_cache
comma
id|active_nr
)paren
op_logical_or
id|commit_locked_index
c_func
(paren
id|lock
)paren
)paren
)paren
id|die
(paren
l_string|&quot;unable to write %s&quot;
comma
id|get_index_file
c_func
(paren
)paren
)paren
suffix:semicolon
r_return
id|clean
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
)brace
eof
