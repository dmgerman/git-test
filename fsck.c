macro_line|#include &quot;cache.h&quot;
macro_line|#include &quot;object.h&quot;
macro_line|#include &quot;blob.h&quot;
macro_line|#include &quot;tree.h&quot;
macro_line|#include &quot;tree-walk.h&quot;
macro_line|#include &quot;commit.h&quot;
macro_line|#include &quot;tag.h&quot;
macro_line|#include &quot;fsck.h&quot;
DECL|function|fsck_walk_tree
r_static
r_int
id|fsck_walk_tree
c_func
(paren
r_struct
id|tree
op_star
id|tree
comma
id|fsck_walk_func
id|walk
comma
r_void
op_star
id|data
)paren
(brace
r_struct
id|tree_desc
id|desc
suffix:semicolon
r_struct
id|name_entry
id|entry
suffix:semicolon
r_int
id|res
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|parse_tree
c_func
(paren
id|tree
)paren
)paren
r_return
l_int|1
suffix:semicolon
id|init_tree_desc
c_func
(paren
op_amp
id|desc
comma
id|tree-&gt;buffer
comma
id|tree-&gt;size
)paren
suffix:semicolon
r_while
c_loop
(paren
id|tree_entry
c_func
(paren
op_amp
id|desc
comma
op_amp
id|entry
)paren
)paren
(brace
r_int
id|result
suffix:semicolon
r_if
c_cond
(paren
id|S_ISGITLINK
c_func
(paren
id|entry.mode
)paren
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
id|S_ISDIR
c_func
(paren
id|entry.mode
)paren
)paren
id|result
op_assign
id|walk
c_func
(paren
op_amp
id|lookup_tree
c_func
(paren
id|entry.sha1
)paren
op_member_access_from_pointer
id|object
comma
id|OBJ_TREE
comma
id|data
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|S_ISREG
c_func
(paren
id|entry.mode
)paren
op_logical_or
id|S_ISLNK
c_func
(paren
id|entry.mode
)paren
)paren
id|result
op_assign
id|walk
c_func
(paren
op_amp
id|lookup_blob
c_func
(paren
id|entry.sha1
)paren
op_member_access_from_pointer
id|object
comma
id|OBJ_BLOB
comma
id|data
)paren
suffix:semicolon
r_else
(brace
id|result
op_assign
id|error
c_func
(paren
l_string|&quot;in tree %s: entry %s has bad mode %.6o&bslash;n&quot;
comma
id|sha1_to_hex
c_func
(paren
id|tree-&gt;object.sha1
)paren
comma
id|entry.path
comma
id|entry.mode
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|result
OL
l_int|0
)paren
r_return
id|result
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|res
)paren
id|res
op_assign
id|result
suffix:semicolon
)brace
r_return
id|res
suffix:semicolon
)brace
DECL|function|fsck_walk_commit
r_static
r_int
id|fsck_walk_commit
c_func
(paren
r_struct
id|commit
op_star
id|commit
comma
id|fsck_walk_func
id|walk
comma
r_void
op_star
id|data
)paren
(brace
r_struct
id|commit_list
op_star
id|parents
suffix:semicolon
r_int
id|res
suffix:semicolon
r_int
id|result
suffix:semicolon
r_if
c_cond
(paren
id|parse_commit
c_func
(paren
id|commit
)paren
)paren
r_return
l_int|1
suffix:semicolon
id|result
op_assign
id|walk
c_func
(paren
(paren
r_struct
id|object
op_star
)paren
id|commit-&gt;tree
comma
id|OBJ_TREE
comma
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OL
l_int|0
)paren
r_return
id|result
suffix:semicolon
id|res
op_assign
id|result
suffix:semicolon
id|parents
op_assign
id|commit-&gt;parents
suffix:semicolon
r_while
c_loop
(paren
id|parents
)paren
(brace
id|result
op_assign
id|walk
c_func
(paren
(paren
r_struct
id|object
op_star
)paren
id|parents-&gt;item
comma
id|OBJ_COMMIT
comma
id|data
)paren
suffix:semicolon
r_if
c_cond
(paren
id|result
OL
l_int|0
)paren
r_return
id|result
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|res
)paren
id|res
op_assign
id|result
suffix:semicolon
id|parents
op_assign
id|parents-&gt;next
suffix:semicolon
)brace
r_return
id|res
suffix:semicolon
)brace
DECL|function|fsck_walk_tag
r_static
r_int
id|fsck_walk_tag
c_func
(paren
r_struct
id|tag
op_star
id|tag
comma
id|fsck_walk_func
id|walk
comma
r_void
op_star
id|data
)paren
(brace
r_if
c_cond
(paren
id|parse_tag
c_func
(paren
id|tag
)paren
)paren
r_return
l_int|1
suffix:semicolon
r_return
id|walk
c_func
(paren
id|tag-&gt;tagged
comma
id|OBJ_ANY
comma
id|data
)paren
suffix:semicolon
)brace
DECL|function|fsck_walk
r_int
id|fsck_walk
c_func
(paren
r_struct
id|object
op_star
id|obj
comma
id|fsck_walk_func
id|walk
comma
r_void
op_star
id|data
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|obj
)paren
r_return
l_int|1
suffix:semicolon
r_switch
c_cond
(paren
id|obj-&gt;type
)paren
(brace
r_case
id|OBJ_BLOB
suffix:colon
r_return
l_int|0
suffix:semicolon
r_case
id|OBJ_TREE
suffix:colon
r_return
id|fsck_walk_tree
c_func
(paren
(paren
r_struct
id|tree
op_star
)paren
id|obj
comma
id|walk
comma
id|data
)paren
suffix:semicolon
r_case
id|OBJ_COMMIT
suffix:colon
r_return
id|fsck_walk_commit
c_func
(paren
(paren
r_struct
id|commit
op_star
)paren
id|obj
comma
id|walk
comma
id|data
)paren
suffix:semicolon
r_case
id|OBJ_TAG
suffix:colon
r_return
id|fsck_walk_tag
c_func
(paren
(paren
r_struct
id|tag
op_star
)paren
id|obj
comma
id|walk
comma
id|data
)paren
suffix:semicolon
r_default
suffix:colon
id|error
c_func
(paren
l_string|&quot;Unknown object type for %s&quot;
comma
id|sha1_to_hex
c_func
(paren
id|obj-&gt;sha1
)paren
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
)brace
eof
