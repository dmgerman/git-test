macro_line|#include &quot;cache.h&quot;
macro_line|#include &quot;string-list.h&quot;
multiline_comment|/*&n; * Parse an argument into a string list.  arg should either be a&n; * &squot;:&squot;-separated list of strings, or &quot;-&quot; to indicate an empty string&n; * list (as opposed to &quot;&quot;, which indicates a string list containing a&n; * single empty string).  list-&gt;strdup_strings must be set.&n; */
DECL|function|parse_string_list
r_static
r_void
id|parse_string_list
c_func
(paren
r_struct
id|string_list
op_star
id|list
comma
r_const
r_char
op_star
id|arg
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|arg
comma
l_string|&quot;-&quot;
)paren
)paren
r_return
suffix:semicolon
(paren
r_void
)paren
id|string_list_split
c_func
(paren
id|list
comma
id|arg
comma
l_char|&squot;:&squot;
comma
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|write_list
r_static
r_void
id|write_list
c_func
(paren
r_const
r_struct
id|string_list
op_star
id|list
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|list-&gt;nr
suffix:semicolon
id|i
op_increment
)paren
id|printf
c_func
(paren
l_string|&quot;[%d]: &bslash;&quot;%s&bslash;&quot;&bslash;n&quot;
comma
id|i
comma
id|list-&gt;items
(braket
id|i
)braket
dot
id|string
)paren
suffix:semicolon
)brace
DECL|function|write_list_compact
r_static
r_void
id|write_list_compact
c_func
(paren
r_const
r_struct
id|string_list
op_star
id|list
)paren
(brace
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|list-&gt;nr
)paren
id|printf
c_func
(paren
l_string|&quot;-&bslash;n&quot;
)paren
suffix:semicolon
r_else
(brace
id|printf
c_func
(paren
l_string|&quot;%s&quot;
comma
id|list-&gt;items
(braket
l_int|0
)braket
dot
id|string
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|1
suffix:semicolon
id|i
OL
id|list-&gt;nr
suffix:semicolon
id|i
op_increment
)paren
id|printf
c_func
(paren
l_string|&quot;:%s&quot;
comma
id|list-&gt;items
(braket
id|i
)braket
dot
id|string
)paren
suffix:semicolon
id|printf
c_func
(paren
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
)brace
)brace
DECL|function|prefix_cb
r_static
r_int
id|prefix_cb
c_func
(paren
r_struct
id|string_list_item
op_star
id|item
comma
r_void
op_star
id|cb_data
)paren
(brace
r_const
r_char
op_star
id|prefix
op_assign
(paren
r_const
r_char
op_star
)paren
id|cb_data
suffix:semicolon
r_return
id|starts_with
c_func
(paren
id|item-&gt;string
comma
id|prefix
)paren
suffix:semicolon
)brace
DECL|function|main
r_int
id|main
c_func
(paren
r_int
id|argc
comma
r_char
op_star
op_star
id|argv
)paren
(brace
r_if
c_cond
(paren
id|argc
op_eq
l_int|5
op_logical_and
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;split&quot;
)paren
)paren
(brace
r_struct
id|string_list
id|list
op_assign
id|STRING_LIST_INIT_DUP
suffix:semicolon
r_int
id|i
suffix:semicolon
r_const
r_char
op_star
id|s
op_assign
id|argv
(braket
l_int|2
)braket
suffix:semicolon
r_int
id|delim
op_assign
op_star
id|argv
(braket
l_int|3
)braket
suffix:semicolon
r_int
id|maxsplit
op_assign
id|atoi
c_func
(paren
id|argv
(braket
l_int|4
)braket
)paren
suffix:semicolon
id|i
op_assign
id|string_list_split
c_func
(paren
op_amp
id|list
comma
id|s
comma
id|delim
comma
id|maxsplit
)paren
suffix:semicolon
id|printf
c_func
(paren
l_string|&quot;%d&bslash;n&quot;
comma
id|i
)paren
suffix:semicolon
id|write_list
c_func
(paren
op_amp
id|list
)paren
suffix:semicolon
id|string_list_clear
c_func
(paren
op_amp
id|list
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|argc
op_eq
l_int|5
op_logical_and
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;split_in_place&quot;
)paren
)paren
(brace
r_struct
id|string_list
id|list
op_assign
id|STRING_LIST_INIT_NODUP
suffix:semicolon
r_int
id|i
suffix:semicolon
r_char
op_star
id|s
op_assign
id|xstrdup
c_func
(paren
id|argv
(braket
l_int|2
)braket
)paren
suffix:semicolon
r_int
id|delim
op_assign
op_star
id|argv
(braket
l_int|3
)braket
suffix:semicolon
r_int
id|maxsplit
op_assign
id|atoi
c_func
(paren
id|argv
(braket
l_int|4
)braket
)paren
suffix:semicolon
id|i
op_assign
id|string_list_split_in_place
c_func
(paren
op_amp
id|list
comma
id|s
comma
id|delim
comma
id|maxsplit
)paren
suffix:semicolon
id|printf
c_func
(paren
l_string|&quot;%d&bslash;n&quot;
comma
id|i
)paren
suffix:semicolon
id|write_list
c_func
(paren
op_amp
id|list
)paren
suffix:semicolon
id|string_list_clear
c_func
(paren
op_amp
id|list
comma
l_int|0
)paren
suffix:semicolon
id|free
c_func
(paren
id|s
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|argc
op_eq
l_int|4
op_logical_and
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;filter&quot;
)paren
)paren
(brace
multiline_comment|/*&n;&t;&t; * Retain only the items that have the specified prefix.&n;&t;&t; * Arguments: list|- prefix&n;&t;&t; */
r_struct
id|string_list
id|list
op_assign
id|STRING_LIST_INIT_DUP
suffix:semicolon
r_const
r_char
op_star
id|prefix
op_assign
id|argv
(braket
l_int|3
)braket
suffix:semicolon
id|parse_string_list
c_func
(paren
op_amp
id|list
comma
id|argv
(braket
l_int|2
)braket
)paren
suffix:semicolon
id|filter_string_list
c_func
(paren
op_amp
id|list
comma
l_int|0
comma
id|prefix_cb
comma
(paren
r_void
op_star
)paren
id|prefix
)paren
suffix:semicolon
id|write_list_compact
c_func
(paren
op_amp
id|list
)paren
suffix:semicolon
id|string_list_clear
c_func
(paren
op_amp
id|list
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|argc
op_eq
l_int|3
op_logical_and
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;remove_duplicates&quot;
)paren
)paren
(brace
r_struct
id|string_list
id|list
op_assign
id|STRING_LIST_INIT_DUP
suffix:semicolon
id|parse_string_list
c_func
(paren
op_amp
id|list
comma
id|argv
(braket
l_int|2
)braket
)paren
suffix:semicolon
id|string_list_remove_duplicates
c_func
(paren
op_amp
id|list
comma
l_int|0
)paren
suffix:semicolon
id|write_list_compact
c_func
(paren
op_amp
id|list
)paren
suffix:semicolon
id|string_list_clear
c_func
(paren
op_amp
id|list
comma
l_int|0
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|fprintf
c_func
(paren
id|stderr
comma
l_string|&quot;%s: unknown function name: %s&bslash;n&quot;
comma
id|argv
(braket
l_int|0
)braket
comma
id|argv
(braket
l_int|1
)braket
ques
c_cond
id|argv
(braket
l_int|1
)braket
suffix:colon
l_string|&quot;(there was none)&quot;
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
eof
