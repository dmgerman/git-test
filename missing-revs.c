macro_line|#include &quot;cache.h&quot;
macro_line|#include &quot;rev-cache.h&quot;
DECL|variable|missing_revs_usage
r_static
r_const
r_char
id|missing_revs_usage
(braket
)braket
op_assign
l_string|&quot;git-missing-revs &lt;rev-cache-file&gt; &lt;want-sha1&gt;...&quot;
suffix:semicolon
DECL|macro|REV_WANT
mdefine_line|#define REV_WANT 01
DECL|macro|REV_HAVE
mdefine_line|#define REV_HAVE 02
DECL|function|process
r_static
r_void
id|process
c_func
(paren
r_struct
id|rev_cache
op_star
id|head_list
)paren
(brace
r_while
c_loop
(paren
id|head_list
)paren
(brace
r_struct
id|rev_cache
op_star
id|rc
op_assign
id|head_list
suffix:semicolon
r_struct
id|rev_list_elem
op_star
id|e
suffix:semicolon
id|head_list
op_assign
id|rc-&gt;head_list
suffix:semicolon
id|rc-&gt;head_list
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|has_sha1_file
c_func
(paren
id|rc-&gt;sha1
)paren
)paren
(brace
id|rc-&gt;work
op_or_assign
id|REV_HAVE
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_if
c_cond
(paren
id|rc-&gt;work
op_amp
(paren
id|REV_WANT
op_or
id|REV_HAVE
)paren
)paren
r_continue
suffix:semicolon
id|rc-&gt;work
op_or_assign
id|REV_WANT
suffix:semicolon
id|printf
c_func
(paren
l_string|&quot;%s&bslash;n&quot;
comma
id|sha1_to_hex
c_func
(paren
id|rc-&gt;sha1
)paren
)paren
suffix:semicolon
r_for
c_loop
(paren
id|e
op_assign
id|rc-&gt;parents
suffix:semicolon
id|e
suffix:semicolon
id|e
op_assign
id|e-&gt;next
)paren
(brace
r_if
c_cond
(paren
id|e-&gt;ri-&gt;work
op_amp
id|REV_HAVE
)paren
r_continue
suffix:semicolon
id|e-&gt;ri-&gt;head_list
op_assign
id|head_list
suffix:semicolon
id|head_list
op_assign
id|e-&gt;ri
suffix:semicolon
)brace
)brace
)brace
DECL|function|main
r_int
id|main
c_func
(paren
r_int
id|ac
comma
r_char
op_star
op_star
id|av
)paren
(brace
r_const
r_char
op_star
id|rev_cache_file
suffix:semicolon
r_struct
id|rev_cache
op_star
id|head_list
op_assign
l_int|NULL
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
id|ac
OL
l_int|3
)paren
id|usage
c_func
(paren
id|missing_revs_usage
)paren
suffix:semicolon
id|rev_cache_file
op_assign
id|av
(braket
l_int|1
)braket
suffix:semicolon
id|read_rev_cache
c_func
(paren
id|rev_cache_file
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|2
suffix:semicolon
id|i
OL
id|ac
suffix:semicolon
id|i
op_increment
)paren
(brace
r_int
r_char
id|sha1
(braket
l_int|20
)braket
suffix:semicolon
r_int
id|pos
suffix:semicolon
r_struct
id|rev_cache
op_star
id|rc
suffix:semicolon
r_if
c_cond
(paren
id|get_sha1_hex
c_func
(paren
id|av
(braket
id|i
)braket
comma
id|sha1
)paren
)paren
id|die
c_func
(paren
l_string|&quot;%s: not an SHA1&quot;
comma
id|av
(braket
id|i
)braket
)paren
suffix:semicolon
r_if
c_cond
(paren
(paren
id|pos
op_assign
id|find_rev_cache
c_func
(paren
id|sha1
)paren
)paren
OL
l_int|0
)paren
(brace
multiline_comment|/* We could be asked for tags, which would not&n;&t;&t;&t; * appear in the rev-cache.&n;&t;&t;&t; */
id|puts
c_func
(paren
id|av
(braket
id|i
)braket
)paren
suffix:semicolon
r_continue
suffix:semicolon
)brace
id|rc
op_assign
id|rev_cache
(braket
id|pos
)braket
suffix:semicolon
id|rc-&gt;head_list
op_assign
id|head_list
suffix:semicolon
id|head_list
op_assign
id|rc
suffix:semicolon
)brace
id|process
c_func
(paren
id|head_list
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
eof
