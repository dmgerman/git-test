macro_line|#include &quot;cache.h&quot;
macro_line|#include &quot;remote.h&quot;
macro_line|#include &quot;refs.h&quot;
DECL|variable|remotes
r_static
r_struct
id|remote
op_star
op_star
id|remotes
suffix:semicolon
DECL|variable|allocated_remotes
r_static
r_int
id|allocated_remotes
suffix:semicolon
DECL|macro|BUF_SIZE
mdefine_line|#define BUF_SIZE (2048)
DECL|variable|buffer
r_static
r_char
id|buffer
(braket
id|BUF_SIZE
)braket
suffix:semicolon
DECL|function|add_push_refspec
r_static
r_void
id|add_push_refspec
c_func
(paren
r_struct
id|remote
op_star
id|remote
comma
r_const
r_char
op_star
id|ref
)paren
(brace
r_int
id|nr
op_assign
id|remote-&gt;push_refspec_nr
op_plus
l_int|1
suffix:semicolon
id|remote-&gt;push_refspec
op_assign
id|xrealloc
c_func
(paren
id|remote-&gt;push_refspec
comma
id|nr
op_star
r_sizeof
(paren
r_char
op_star
)paren
)paren
suffix:semicolon
id|remote-&gt;push_refspec
(braket
id|nr
op_minus
l_int|1
)braket
op_assign
id|ref
suffix:semicolon
id|remote-&gt;push_refspec_nr
op_assign
id|nr
suffix:semicolon
)brace
DECL|function|add_uri
r_static
r_void
id|add_uri
c_func
(paren
r_struct
id|remote
op_star
id|remote
comma
r_const
r_char
op_star
id|uri
)paren
(brace
r_int
id|nr
op_assign
id|remote-&gt;uri_nr
op_plus
l_int|1
suffix:semicolon
id|remote-&gt;uri
op_assign
id|xrealloc
c_func
(paren
id|remote-&gt;uri
comma
id|nr
op_star
r_sizeof
(paren
r_char
op_star
)paren
)paren
suffix:semicolon
id|remote-&gt;uri
(braket
id|nr
op_minus
l_int|1
)braket
op_assign
id|uri
suffix:semicolon
id|remote-&gt;uri_nr
op_assign
id|nr
suffix:semicolon
)brace
DECL|function|make_remote
r_static
r_struct
id|remote
op_star
id|make_remote
c_func
(paren
r_const
r_char
op_star
id|name
comma
r_int
id|len
)paren
(brace
r_int
id|i
comma
id|empty
op_assign
l_int|1
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|allocated_remotes
suffix:semicolon
id|i
op_increment
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|remotes
(braket
id|i
)braket
)paren
(brace
r_if
c_cond
(paren
id|empty
OL
l_int|0
)paren
id|empty
op_assign
id|i
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
id|len
ques
c_cond
(paren
op_logical_neg
id|strncmp
c_func
(paren
id|name
comma
id|remotes
(braket
id|i
)braket
op_member_access_from_pointer
id|name
comma
id|len
)paren
op_logical_and
op_logical_neg
id|remotes
(braket
id|i
)braket
op_member_access_from_pointer
id|name
(braket
id|len
)braket
)paren
suffix:colon
op_logical_neg
id|strcmp
c_func
(paren
id|name
comma
id|remotes
(braket
id|i
)braket
op_member_access_from_pointer
id|name
)paren
)paren
r_return
id|remotes
(braket
id|i
)braket
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|empty
OL
l_int|0
)paren
(brace
id|empty
op_assign
id|allocated_remotes
suffix:semicolon
id|allocated_remotes
op_add_assign
id|allocated_remotes
ques
c_cond
id|allocated_remotes
suffix:colon
l_int|1
suffix:semicolon
id|remotes
op_assign
id|xrealloc
c_func
(paren
id|remotes
comma
r_sizeof
(paren
op_star
id|remotes
)paren
op_star
id|allocated_remotes
)paren
suffix:semicolon
id|memset
c_func
(paren
id|remotes
op_plus
id|empty
comma
l_int|0
comma
(paren
id|allocated_remotes
id|empty
)paren
op_star
r_sizeof
(paren
op_star
id|remotes
)paren
)paren
suffix:semicolon
)brace
id|remotes
(braket
id|empty
)braket
op_assign
id|xcalloc
c_func
(paren
l_int|1
comma
r_sizeof
(paren
r_struct
id|remote
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|len
)paren
id|remotes
(braket
id|empty
)braket
op_member_access_from_pointer
id|name
op_assign
id|xstrndup
c_func
(paren
id|name
comma
id|len
)paren
suffix:semicolon
r_else
id|remotes
(braket
id|empty
)braket
op_member_access_from_pointer
id|name
op_assign
id|xstrdup
c_func
(paren
id|name
)paren
suffix:semicolon
r_return
id|remotes
(braket
id|empty
)braket
suffix:semicolon
)brace
DECL|function|read_remotes_file
r_static
r_void
id|read_remotes_file
c_func
(paren
r_struct
id|remote
op_star
id|remote
)paren
(brace
id|FILE
op_star
id|f
op_assign
id|fopen
c_func
(paren
id|git_path
c_func
(paren
l_string|&quot;remotes/%s&quot;
comma
id|remote-&gt;name
)paren
comma
l_string|&quot;r&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|f
)paren
r_return
suffix:semicolon
r_while
c_loop
(paren
id|fgets
c_func
(paren
id|buffer
comma
id|BUF_SIZE
comma
id|f
)paren
)paren
(brace
r_int
id|value_list
suffix:semicolon
r_char
op_star
id|s
comma
op_star
id|p
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|prefixcmp
c_func
(paren
id|buffer
comma
l_string|&quot;URL:&quot;
)paren
)paren
(brace
id|value_list
op_assign
l_int|0
suffix:semicolon
id|s
op_assign
id|buffer
op_plus
l_int|4
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|prefixcmp
c_func
(paren
id|buffer
comma
l_string|&quot;Push:&quot;
)paren
)paren
(brace
id|value_list
op_assign
l_int|1
suffix:semicolon
id|s
op_assign
id|buffer
op_plus
l_int|5
suffix:semicolon
)brace
r_else
r_continue
suffix:semicolon
r_while
c_loop
(paren
id|isspace
c_func
(paren
op_star
id|s
)paren
)paren
id|s
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
op_star
id|s
)paren
r_continue
suffix:semicolon
id|p
op_assign
id|s
op_plus
id|strlen
c_func
(paren
id|s
)paren
suffix:semicolon
r_while
c_loop
(paren
id|isspace
c_func
(paren
id|p
(braket
l_int|1
)braket
)paren
)paren
op_star
op_decrement
id|p
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|value_list
)paren
(brace
r_case
l_int|0
suffix:colon
id|add_uri
c_func
(paren
id|remote
comma
id|xstrdup
c_func
(paren
id|s
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
l_int|1
suffix:colon
id|add_push_refspec
c_func
(paren
id|remote
comma
id|xstrdup
c_func
(paren
id|s
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
id|fclose
c_func
(paren
id|f
)paren
suffix:semicolon
)brace
DECL|function|read_branches_file
r_static
r_void
id|read_branches_file
c_func
(paren
r_struct
id|remote
op_star
id|remote
)paren
(brace
r_const
r_char
op_star
id|slash
op_assign
id|strchr
c_func
(paren
id|remote-&gt;name
comma
l_char|&squot;/&squot;
)paren
suffix:semicolon
r_int
id|n
op_assign
id|slash
ques
c_cond
id|slash
id|remote-&gt;name
suffix:colon
l_int|1000
suffix:semicolon
id|FILE
op_star
id|f
op_assign
id|fopen
c_func
(paren
id|git_path
c_func
(paren
l_string|&quot;branches/%.*s&quot;
comma
id|n
comma
id|remote-&gt;name
)paren
comma
l_string|&quot;r&quot;
)paren
suffix:semicolon
r_char
op_star
id|s
comma
op_star
id|p
suffix:semicolon
r_int
id|len
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|f
)paren
r_return
suffix:semicolon
id|s
op_assign
id|fgets
c_func
(paren
id|buffer
comma
id|BUF_SIZE
comma
id|f
)paren
suffix:semicolon
id|fclose
c_func
(paren
id|f
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|s
)paren
r_return
suffix:semicolon
r_while
c_loop
(paren
id|isspace
c_func
(paren
op_star
id|s
)paren
)paren
id|s
op_increment
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
op_star
id|s
)paren
r_return
suffix:semicolon
id|p
op_assign
id|s
op_plus
id|strlen
c_func
(paren
id|s
)paren
suffix:semicolon
r_while
c_loop
(paren
id|isspace
c_func
(paren
id|p
(braket
l_int|1
)braket
)paren
)paren
op_star
op_decrement
id|p
op_assign
l_int|0
suffix:semicolon
id|len
op_assign
id|p
id|s
suffix:semicolon
r_if
c_cond
(paren
id|slash
)paren
id|len
op_add_assign
id|strlen
c_func
(paren
id|slash
)paren
suffix:semicolon
id|p
op_assign
id|xmalloc
c_func
(paren
id|len
op_plus
l_int|1
)paren
suffix:semicolon
id|strcpy
c_func
(paren
id|p
comma
id|s
)paren
suffix:semicolon
r_if
c_cond
(paren
id|slash
)paren
id|strcat
c_func
(paren
id|p
comma
id|slash
)paren
suffix:semicolon
id|add_uri
c_func
(paren
id|remote
comma
id|p
)paren
suffix:semicolon
)brace
DECL|variable|default_remote_name
r_static
r_char
op_star
id|default_remote_name
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|current_branch
r_static
r_const
r_char
op_star
id|current_branch
op_assign
l_int|NULL
suffix:semicolon
DECL|variable|current_branch_len
r_static
r_int
id|current_branch_len
op_assign
l_int|0
suffix:semicolon
DECL|function|handle_config
r_static
r_int
id|handle_config
c_func
(paren
r_const
r_char
op_star
id|key
comma
r_const
r_char
op_star
id|value
)paren
(brace
r_const
r_char
op_star
id|name
suffix:semicolon
r_const
r_char
op_star
id|subkey
suffix:semicolon
r_struct
id|remote
op_star
id|remote
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|prefixcmp
c_func
(paren
id|key
comma
l_string|&quot;branch.&quot;
)paren
op_logical_and
id|current_branch
op_logical_and
op_logical_neg
id|strncmp
c_func
(paren
id|key
op_plus
l_int|7
comma
id|current_branch
comma
id|current_branch_len
)paren
op_logical_and
op_logical_neg
id|strcmp
c_func
(paren
id|key
op_plus
l_int|7
op_plus
id|current_branch_len
comma
l_string|&quot;.remote&quot;
)paren
)paren
(brace
id|free
c_func
(paren
id|default_remote_name
)paren
suffix:semicolon
id|default_remote_name
op_assign
id|xstrdup
c_func
(paren
id|value
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|prefixcmp
c_func
(paren
id|key
comma
l_string|&quot;remote.&quot;
)paren
)paren
r_return
l_int|0
suffix:semicolon
id|name
op_assign
id|key
op_plus
l_int|7
suffix:semicolon
id|subkey
op_assign
id|strrchr
c_func
(paren
id|name
comma
l_char|&squot;.&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|subkey
)paren
r_return
id|error
c_func
(paren
l_string|&quot;Config with no key for remote %s&quot;
comma
id|name
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|subkey
op_eq
l_char|&squot;/&squot;
)paren
(brace
id|warning
c_func
(paren
l_string|&quot;Config remote shorthand cannot begin with &squot;/&squot;: %s&quot;
comma
id|name
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|remote
op_assign
id|make_remote
c_func
(paren
id|name
comma
id|subkey
id|name
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|value
)paren
(brace
multiline_comment|/* if we ever have a boolean variable, e.g. &quot;remote.*.disabled&quot;&n;&t;&t; * [remote &quot;frotz&quot;]&n;&t;&t; *      disabled&n;&t;&t; * is a valid way to set it to true; we get NULL in value so&n;&t;&t; * we need to handle it here.&n;&t;&t; *&n;&t;&t; * if (!strcmp(subkey, &quot;.disabled&quot;)) {&n;&t;&t; *      val = git_config_bool(key, value);&n;&t;&t; *      return 0;&n;&t;&t; * } else&n;&t;&t; *&n;&t;&t; */
r_return
l_int|0
suffix:semicolon
multiline_comment|/* ignore unknown booleans */
)brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|subkey
comma
l_string|&quot;.url&quot;
)paren
)paren
(brace
id|add_uri
c_func
(paren
id|remote
comma
id|xstrdup
c_func
(paren
id|value
)paren
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|subkey
comma
l_string|&quot;.push&quot;
)paren
)paren
(brace
id|add_push_refspec
c_func
(paren
id|remote
comma
id|xstrdup
c_func
(paren
id|value
)paren
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|subkey
comma
l_string|&quot;.receivepack&quot;
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|remote-&gt;receivepack
)paren
id|remote-&gt;receivepack
op_assign
id|xstrdup
c_func
(paren
id|value
)paren
suffix:semicolon
r_else
id|error
c_func
(paren
l_string|&quot;more than one receivepack given, using the first&quot;
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|read_config
r_static
r_void
id|read_config
c_func
(paren
r_void
)paren
(brace
r_int
r_char
id|sha1
(braket
l_int|20
)braket
suffix:semicolon
r_const
r_char
op_star
id|head_ref
suffix:semicolon
r_int
id|flag
suffix:semicolon
r_if
c_cond
(paren
id|default_remote_name
)paren
singleline_comment|// did this already
r_return
suffix:semicolon
id|default_remote_name
op_assign
id|xstrdup
c_func
(paren
l_string|&quot;origin&quot;
)paren
suffix:semicolon
id|current_branch
op_assign
l_int|NULL
suffix:semicolon
id|head_ref
op_assign
id|resolve_ref
c_func
(paren
l_string|&quot;HEAD&quot;
comma
id|sha1
comma
l_int|0
comma
op_amp
id|flag
)paren
suffix:semicolon
r_if
c_cond
(paren
id|head_ref
op_logical_and
(paren
id|flag
op_amp
id|REF_ISSYMREF
)paren
op_logical_and
op_logical_neg
id|prefixcmp
c_func
(paren
id|head_ref
comma
l_string|&quot;refs/heads/&quot;
)paren
)paren
(brace
id|current_branch
op_assign
id|head_ref
op_plus
id|strlen
c_func
(paren
l_string|&quot;refs/heads/&quot;
)paren
suffix:semicolon
id|current_branch_len
op_assign
id|strlen
c_func
(paren
id|current_branch
)paren
suffix:semicolon
)brace
id|git_config
c_func
(paren
id|handle_config
)paren
suffix:semicolon
)brace
DECL|function|remote_get
r_struct
id|remote
op_star
id|remote_get
c_func
(paren
r_const
r_char
op_star
id|name
)paren
(brace
r_struct
id|remote
op_star
id|ret
suffix:semicolon
id|read_config
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|name
)paren
id|name
op_assign
id|default_remote_name
suffix:semicolon
id|ret
op_assign
id|make_remote
c_func
(paren
id|name
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|name
(braket
l_int|0
)braket
op_ne
l_char|&squot;/&squot;
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|ret-&gt;uri
)paren
id|read_remotes_file
c_func
(paren
id|ret
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ret-&gt;uri
)paren
id|read_branches_file
c_func
(paren
id|ret
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|ret-&gt;uri
)paren
id|add_uri
c_func
(paren
id|ret
comma
id|name
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ret-&gt;uri
)paren
r_return
l_int|NULL
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
eof
