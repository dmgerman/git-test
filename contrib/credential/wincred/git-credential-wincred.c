multiline_comment|/*&n; * A git credential helper that interface with Windows&squot; Credential Manager&n; *&n; */
macro_line|#include &lt;windows.h&gt;
macro_line|#include &lt;stdio.h&gt;
macro_line|#include &lt;io.h&gt;
macro_line|#include &lt;fcntl.h&gt;
multiline_comment|/* common helpers */
DECL|macro|ARRAY_SIZE
mdefine_line|#define ARRAY_SIZE(x) (sizeof(x)/sizeof(x[0]))
DECL|function|die
r_static
r_void
id|die
c_func
(paren
r_const
r_char
op_star
id|err
comma
dot
dot
dot
)paren
(brace
r_char
id|msg
(braket
l_int|4096
)braket
suffix:semicolon
id|va_list
id|params
suffix:semicolon
id|va_start
c_func
(paren
id|params
comma
id|err
)paren
suffix:semicolon
id|vsnprintf
c_func
(paren
id|msg
comma
r_sizeof
(paren
id|msg
)paren
comma
id|err
comma
id|params
)paren
suffix:semicolon
id|fprintf
c_func
(paren
id|stderr
comma
l_string|&quot;%s&bslash;n&quot;
comma
id|msg
)paren
suffix:semicolon
id|va_end
c_func
(paren
id|params
)paren
suffix:semicolon
m_exit
(paren
l_int|1
)paren
suffix:semicolon
)brace
DECL|function|xmalloc
r_static
r_void
op_star
id|xmalloc
c_func
(paren
r_int
id|size
)paren
(brace
r_void
op_star
id|ret
op_assign
id|malloc
c_func
(paren
id|size
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ret
op_logical_and
op_logical_neg
id|size
)paren
id|ret
op_assign
id|malloc
c_func
(paren
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ret
)paren
id|die
c_func
(paren
l_string|&quot;Out of memory&quot;
)paren
suffix:semicolon
r_return
id|ret
suffix:semicolon
)brace
multiline_comment|/* MinGW doesn&squot;t have wincred.h, so we need to define stuff */
DECL|struct|_CREDENTIAL_ATTRIBUTEW
r_typedef
r_struct
id|_CREDENTIAL_ATTRIBUTEW
(brace
DECL|member|Keyword
id|LPWSTR
id|Keyword
suffix:semicolon
DECL|member|Flags
id|DWORD
id|Flags
suffix:semicolon
DECL|member|ValueSize
id|DWORD
id|ValueSize
suffix:semicolon
DECL|member|Value
id|LPBYTE
id|Value
suffix:semicolon
DECL|typedef|CREDENTIAL_ATTRIBUTEW
DECL|typedef|PCREDENTIAL_ATTRIBUTEW
)brace
id|CREDENTIAL_ATTRIBUTEW
comma
op_star
id|PCREDENTIAL_ATTRIBUTEW
suffix:semicolon
DECL|struct|_CREDENTIALW
r_typedef
r_struct
id|_CREDENTIALW
(brace
DECL|member|Flags
id|DWORD
id|Flags
suffix:semicolon
DECL|member|Type
id|DWORD
id|Type
suffix:semicolon
DECL|member|TargetName
id|LPWSTR
id|TargetName
suffix:semicolon
DECL|member|Comment
id|LPWSTR
id|Comment
suffix:semicolon
DECL|member|LastWritten
id|FILETIME
id|LastWritten
suffix:semicolon
DECL|member|CredentialBlobSize
id|DWORD
id|CredentialBlobSize
suffix:semicolon
DECL|member|CredentialBlob
id|LPBYTE
id|CredentialBlob
suffix:semicolon
DECL|member|Persist
id|DWORD
id|Persist
suffix:semicolon
DECL|member|AttributeCount
id|DWORD
id|AttributeCount
suffix:semicolon
DECL|member|Attributes
id|PCREDENTIAL_ATTRIBUTEW
id|Attributes
suffix:semicolon
DECL|member|TargetAlias
id|LPWSTR
id|TargetAlias
suffix:semicolon
DECL|member|UserName
id|LPWSTR
id|UserName
suffix:semicolon
DECL|typedef|CREDENTIALW
DECL|typedef|PCREDENTIALW
)brace
id|CREDENTIALW
comma
op_star
id|PCREDENTIALW
suffix:semicolon
DECL|macro|CRED_TYPE_GENERIC
mdefine_line|#define CRED_TYPE_GENERIC 1
DECL|macro|CRED_PERSIST_LOCAL_MACHINE
mdefine_line|#define CRED_PERSIST_LOCAL_MACHINE 2
DECL|macro|CRED_MAX_ATTRIBUTES
mdefine_line|#define CRED_MAX_ATTRIBUTES 64
DECL|typedef|CredWriteWT
r_typedef
id|BOOL
(paren
id|WINAPI
op_star
id|CredWriteWT
)paren
(paren
id|PCREDENTIALW
comma
id|DWORD
)paren
suffix:semicolon
DECL|typedef|CredEnumerateWT
r_typedef
id|BOOL
(paren
id|WINAPI
op_star
id|CredEnumerateWT
)paren
(paren
id|LPCWSTR
comma
id|DWORD
comma
id|DWORD
op_star
comma
id|PCREDENTIALW
op_star
op_star
)paren
suffix:semicolon
DECL|typedef|CredFreeT
r_typedef
id|VOID
(paren
id|WINAPI
op_star
id|CredFreeT
)paren
(paren
id|PVOID
)paren
suffix:semicolon
DECL|typedef|CredDeleteWT
r_typedef
id|BOOL
(paren
id|WINAPI
op_star
id|CredDeleteWT
)paren
(paren
id|LPCWSTR
comma
id|DWORD
comma
id|DWORD
)paren
suffix:semicolon
DECL|variable|advapi
r_static
id|HMODULE
id|advapi
suffix:semicolon
DECL|variable|CredWriteW
r_static
id|CredWriteWT
id|CredWriteW
suffix:semicolon
DECL|variable|CredEnumerateW
r_static
id|CredEnumerateWT
id|CredEnumerateW
suffix:semicolon
DECL|variable|CredFree
r_static
id|CredFreeT
id|CredFree
suffix:semicolon
DECL|variable|CredDeleteW
r_static
id|CredDeleteWT
id|CredDeleteW
suffix:semicolon
DECL|function|load_cred_funcs
r_static
r_void
id|load_cred_funcs
c_func
(paren
r_void
)paren
(brace
multiline_comment|/* load DLLs */
id|advapi
op_assign
id|LoadLibrary
c_func
(paren
l_string|&quot;advapi32.dll&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|advapi
)paren
id|die
c_func
(paren
l_string|&quot;failed to load advapi32.dll&quot;
)paren
suffix:semicolon
multiline_comment|/* get function pointers */
id|CredWriteW
op_assign
(paren
id|CredWriteWT
)paren
id|GetProcAddress
c_func
(paren
id|advapi
comma
l_string|&quot;CredWriteW&quot;
)paren
suffix:semicolon
id|CredEnumerateW
op_assign
(paren
id|CredEnumerateWT
)paren
id|GetProcAddress
c_func
(paren
id|advapi
comma
l_string|&quot;CredEnumerateW&quot;
)paren
suffix:semicolon
id|CredFree
op_assign
(paren
id|CredFreeT
)paren
id|GetProcAddress
c_func
(paren
id|advapi
comma
l_string|&quot;CredFree&quot;
)paren
suffix:semicolon
id|CredDeleteW
op_assign
(paren
id|CredDeleteWT
)paren
id|GetProcAddress
c_func
(paren
id|advapi
comma
l_string|&quot;CredDeleteW&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|CredWriteW
op_logical_or
op_logical_neg
id|CredEnumerateW
op_logical_or
op_logical_neg
id|CredFree
op_logical_or
op_logical_neg
id|CredDeleteW
)paren
id|die
c_func
(paren
l_string|&quot;failed to load functions&quot;
)paren
suffix:semicolon
)brace
DECL|variable|wusername
DECL|variable|password
DECL|variable|protocol
DECL|variable|host
DECL|variable|path
DECL|variable|target
r_static
id|WCHAR
op_star
id|wusername
comma
op_star
id|password
comma
op_star
id|protocol
comma
op_star
id|host
comma
op_star
id|path
comma
id|target
(braket
l_int|1024
)braket
suffix:semicolon
DECL|function|write_item
r_static
r_void
id|write_item
c_func
(paren
r_const
r_char
op_star
id|what
comma
id|LPCWSTR
id|wbuf
comma
r_int
id|wlen
)paren
(brace
r_char
op_star
id|buf
suffix:semicolon
r_int
id|len
op_assign
id|WideCharToMultiByte
c_func
(paren
id|CP_UTF8
comma
l_int|0
comma
id|wbuf
comma
id|wlen
comma
l_int|NULL
comma
l_int|0
comma
l_int|NULL
comma
id|FALSE
)paren
suffix:semicolon
id|buf
op_assign
id|xmalloc
c_func
(paren
id|len
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|WideCharToMultiByte
c_func
(paren
id|CP_UTF8
comma
l_int|0
comma
id|wbuf
comma
id|wlen
comma
id|buf
comma
id|len
comma
l_int|NULL
comma
id|FALSE
)paren
)paren
id|die
c_func
(paren
l_string|&quot;WideCharToMultiByte failed!&quot;
)paren
suffix:semicolon
id|printf
c_func
(paren
l_string|&quot;%s=&quot;
comma
id|what
)paren
suffix:semicolon
id|fwrite
c_func
(paren
id|buf
comma
l_int|1
comma
id|len
comma
id|stdout
)paren
suffix:semicolon
id|putchar
c_func
(paren
l_char|&squot;&bslash;n&squot;
)paren
suffix:semicolon
id|free
c_func
(paren
id|buf
)paren
suffix:semicolon
)brace
multiline_comment|/*&n; * Match an (optional) expected string and a delimiter in the target string,&n; * consuming the matched text by updating the target pointer.&n; */
DECL|function|match_part
r_static
r_int
id|match_part
c_func
(paren
id|LPCWSTR
op_star
id|ptarget
comma
id|LPCWSTR
id|want
comma
id|LPCWSTR
id|delim
)paren
(brace
id|LPCWSTR
id|delim_pos
comma
id|start
op_assign
op_star
id|ptarget
suffix:semicolon
r_int
id|len
suffix:semicolon
multiline_comment|/* find start of delimiter (or end-of-string if delim is empty) */
r_if
c_cond
(paren
op_star
id|delim
)paren
id|delim_pos
op_assign
id|wcsstr
c_func
(paren
id|start
comma
id|delim
)paren
suffix:semicolon
r_else
id|delim_pos
op_assign
id|start
op_plus
id|wcslen
c_func
(paren
id|start
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * match text up to delimiter, or end of string (e.g. the &squot;/&squot; after&n;&t; * host is optional if not followed by a path)&n;&t; */
r_if
c_cond
(paren
id|delim_pos
)paren
id|len
op_assign
id|delim_pos
id|start
suffix:semicolon
r_else
id|len
op_assign
id|wcslen
c_func
(paren
id|start
)paren
suffix:semicolon
multiline_comment|/* update ptarget if we either found a delimiter or need a match */
r_if
c_cond
(paren
id|delim_pos
op_logical_or
id|want
)paren
op_star
id|ptarget
op_assign
id|delim_pos
ques
c_cond
id|delim_pos
op_plus
id|wcslen
c_func
(paren
id|delim
)paren
suffix:colon
id|start
op_plus
id|len
suffix:semicolon
r_return
op_logical_neg
id|want
op_logical_or
(paren
op_logical_neg
id|wcsncmp
c_func
(paren
id|want
comma
id|start
comma
id|len
)paren
op_logical_and
op_logical_neg
id|want
(braket
id|len
)braket
)paren
suffix:semicolon
)brace
DECL|function|match_cred
r_static
r_int
id|match_cred
c_func
(paren
r_const
id|CREDENTIALW
op_star
id|cred
)paren
(brace
id|LPCWSTR
id|target
op_assign
id|cred-&gt;TargetName
suffix:semicolon
r_if
c_cond
(paren
id|wusername
op_logical_and
id|wcscmp
c_func
(paren
id|wusername
comma
id|cred-&gt;UserName
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_return
id|match_part
c_func
(paren
op_amp
id|target
comma
id|L
l_string|&quot;git&quot;
comma
id|L
l_string|&quot;:&quot;
)paren
op_logical_and
id|match_part
c_func
(paren
op_amp
id|target
comma
id|protocol
comma
id|L
l_string|&quot;://&quot;
)paren
op_logical_and
id|match_part
c_func
(paren
op_amp
id|target
comma
id|wusername
comma
id|L
l_string|&quot;@&quot;
)paren
op_logical_and
id|match_part
c_func
(paren
op_amp
id|target
comma
id|host
comma
id|L
l_string|&quot;/&quot;
)paren
op_logical_and
id|match_part
c_func
(paren
op_amp
id|target
comma
id|path
comma
id|L
l_string|&quot;&quot;
)paren
suffix:semicolon
)brace
DECL|function|get_credential
r_static
r_void
id|get_credential
c_func
(paren
r_void
)paren
(brace
id|CREDENTIALW
op_star
op_star
id|creds
suffix:semicolon
id|DWORD
id|num_creds
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|CredEnumerateW
c_func
(paren
id|L
l_string|&quot;git:*&quot;
comma
l_int|0
comma
op_amp
id|num_creds
comma
op_amp
id|creds
)paren
)paren
r_return
suffix:semicolon
multiline_comment|/* search for the first credential that matches username */
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|num_creds
suffix:semicolon
op_increment
id|i
)paren
r_if
c_cond
(paren
id|match_cred
c_func
(paren
id|creds
(braket
id|i
)braket
)paren
)paren
(brace
id|write_item
c_func
(paren
l_string|&quot;username&quot;
comma
id|creds
(braket
id|i
)braket
op_member_access_from_pointer
id|UserName
comma
id|wcslen
c_func
(paren
id|creds
(braket
id|i
)braket
op_member_access_from_pointer
id|UserName
)paren
)paren
suffix:semicolon
id|write_item
c_func
(paren
l_string|&quot;password&quot;
comma
(paren
id|LPCWSTR
)paren
id|creds
(braket
id|i
)braket
op_member_access_from_pointer
id|CredentialBlob
comma
id|creds
(braket
id|i
)braket
op_member_access_from_pointer
id|CredentialBlobSize
op_div
r_sizeof
(paren
id|WCHAR
)paren
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
id|CredFree
c_func
(paren
id|creds
)paren
suffix:semicolon
)brace
DECL|function|store_credential
r_static
r_void
id|store_credential
c_func
(paren
r_void
)paren
(brace
id|CREDENTIALW
id|cred
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|wusername
op_logical_or
op_logical_neg
id|password
)paren
r_return
suffix:semicolon
id|cred.Flags
op_assign
l_int|0
suffix:semicolon
id|cred.Type
op_assign
id|CRED_TYPE_GENERIC
suffix:semicolon
id|cred.TargetName
op_assign
id|target
suffix:semicolon
id|cred.Comment
op_assign
id|L
l_string|&quot;saved by git-credential-wincred&quot;
suffix:semicolon
id|cred.CredentialBlobSize
op_assign
(paren
id|wcslen
c_func
(paren
id|password
)paren
)paren
op_star
r_sizeof
(paren
id|WCHAR
)paren
suffix:semicolon
id|cred.CredentialBlob
op_assign
(paren
id|LPVOID
)paren
id|password
suffix:semicolon
id|cred.Persist
op_assign
id|CRED_PERSIST_LOCAL_MACHINE
suffix:semicolon
id|cred.AttributeCount
op_assign
l_int|0
suffix:semicolon
id|cred.Attributes
op_assign
l_int|NULL
suffix:semicolon
id|cred.TargetAlias
op_assign
l_int|NULL
suffix:semicolon
id|cred.UserName
op_assign
id|wusername
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|CredWriteW
c_func
(paren
op_amp
id|cred
comma
l_int|0
)paren
)paren
id|die
c_func
(paren
l_string|&quot;CredWrite failed&quot;
)paren
suffix:semicolon
)brace
DECL|function|erase_credential
r_static
r_void
id|erase_credential
c_func
(paren
r_void
)paren
(brace
id|CREDENTIALW
op_star
op_star
id|creds
suffix:semicolon
id|DWORD
id|num_creds
suffix:semicolon
r_int
id|i
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|CredEnumerateW
c_func
(paren
id|L
l_string|&quot;git:*&quot;
comma
l_int|0
comma
op_amp
id|num_creds
comma
op_amp
id|creds
)paren
)paren
r_return
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|num_creds
suffix:semicolon
op_increment
id|i
)paren
(brace
r_if
c_cond
(paren
id|match_cred
c_func
(paren
id|creds
(braket
id|i
)braket
)paren
)paren
id|CredDeleteW
c_func
(paren
id|creds
(braket
id|i
)braket
op_member_access_from_pointer
id|TargetName
comma
id|creds
(braket
id|i
)braket
op_member_access_from_pointer
id|Type
comma
l_int|0
)paren
suffix:semicolon
)brace
id|CredFree
c_func
(paren
id|creds
)paren
suffix:semicolon
)brace
DECL|function|utf8_to_utf16_dup
r_static
id|WCHAR
op_star
id|utf8_to_utf16_dup
c_func
(paren
r_const
r_char
op_star
id|str
)paren
(brace
r_int
id|wlen
op_assign
id|MultiByteToWideChar
c_func
(paren
id|CP_UTF8
comma
l_int|0
comma
id|str
comma
l_int|1
comma
l_int|NULL
comma
l_int|0
)paren
suffix:semicolon
id|WCHAR
op_star
id|wstr
op_assign
id|xmalloc
c_func
(paren
r_sizeof
(paren
id|WCHAR
)paren
op_star
id|wlen
)paren
suffix:semicolon
id|MultiByteToWideChar
c_func
(paren
id|CP_UTF8
comma
l_int|0
comma
id|str
comma
l_int|1
comma
id|wstr
comma
id|wlen
)paren
suffix:semicolon
r_return
id|wstr
suffix:semicolon
)brace
DECL|function|read_credential
r_static
r_void
id|read_credential
c_func
(paren
r_void
)paren
(brace
r_char
id|buf
(braket
l_int|1024
)braket
suffix:semicolon
r_while
c_loop
(paren
id|fgets
c_func
(paren
id|buf
comma
r_sizeof
(paren
id|buf
)paren
comma
id|stdin
)paren
)paren
(brace
r_char
op_star
id|v
suffix:semicolon
r_int
id|len
op_assign
id|strlen
c_func
(paren
id|buf
)paren
suffix:semicolon
multiline_comment|/* strip trailing CR / LF */
r_while
c_loop
(paren
id|len
op_logical_and
id|strchr
c_func
(paren
l_string|&quot;&bslash;r&bslash;n&quot;
comma
id|buf
(braket
id|len
l_int|1
)braket
)paren
)paren
id|buf
(braket
op_decrement
id|len
)braket
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
op_star
id|buf
)paren
r_break
suffix:semicolon
id|v
op_assign
id|strchr
c_func
(paren
id|buf
comma
l_char|&squot;=&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|v
)paren
id|die
c_func
(paren
l_string|&quot;bad input: %s&quot;
comma
id|buf
)paren
suffix:semicolon
op_star
id|v
op_increment
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|buf
comma
l_string|&quot;protocol&quot;
)paren
)paren
id|protocol
op_assign
id|utf8_to_utf16_dup
c_func
(paren
id|v
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|buf
comma
l_string|&quot;host&quot;
)paren
)paren
id|host
op_assign
id|utf8_to_utf16_dup
c_func
(paren
id|v
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|buf
comma
l_string|&quot;path&quot;
)paren
)paren
id|path
op_assign
id|utf8_to_utf16_dup
c_func
(paren
id|v
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|buf
comma
l_string|&quot;username&quot;
)paren
)paren
(brace
id|wusername
op_assign
id|utf8_to_utf16_dup
c_func
(paren
id|v
)paren
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|buf
comma
l_string|&quot;password&quot;
)paren
)paren
id|password
op_assign
id|utf8_to_utf16_dup
c_func
(paren
id|v
)paren
suffix:semicolon
r_else
id|die
c_func
(paren
l_string|&quot;unrecognized input&quot;
)paren
suffix:semicolon
)brace
)brace
DECL|function|main
r_int
id|main
c_func
(paren
r_int
id|argc
comma
r_char
op_star
id|argv
(braket
)braket
)paren
(brace
r_const
r_char
op_star
id|usage
op_assign
l_string|&quot;Usage: git credential-wincred &lt;get|store|erase&gt;&bslash;n&quot;
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|argv
(braket
l_int|1
)braket
)paren
id|die
c_func
(paren
id|usage
)paren
suffix:semicolon
multiline_comment|/* git use binary pipes to avoid CRLF-issues */
id|_setmode
c_func
(paren
id|_fileno
c_func
(paren
id|stdin
)paren
comma
id|_O_BINARY
)paren
suffix:semicolon
id|_setmode
c_func
(paren
id|_fileno
c_func
(paren
id|stdout
)paren
comma
id|_O_BINARY
)paren
suffix:semicolon
id|read_credential
c_func
(paren
)paren
suffix:semicolon
id|load_cred_funcs
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|protocol
op_logical_or
op_logical_neg
(paren
id|host
op_logical_or
id|path
)paren
)paren
r_return
l_int|0
suffix:semicolon
multiline_comment|/* prepare &squot;target&squot;, the unique key for the credential */
id|wcscpy
c_func
(paren
id|target
comma
id|L
l_string|&quot;git:&quot;
)paren
suffix:semicolon
id|wcsncat
c_func
(paren
id|target
comma
id|protocol
comma
id|ARRAY_SIZE
c_func
(paren
id|target
)paren
)paren
suffix:semicolon
id|wcsncat
c_func
(paren
id|target
comma
id|L
l_string|&quot;://&quot;
comma
id|ARRAY_SIZE
c_func
(paren
id|target
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|wusername
)paren
(brace
id|wcsncat
c_func
(paren
id|target
comma
id|wusername
comma
id|ARRAY_SIZE
c_func
(paren
id|target
)paren
)paren
suffix:semicolon
id|wcsncat
c_func
(paren
id|target
comma
id|L
l_string|&quot;@&quot;
comma
id|ARRAY_SIZE
c_func
(paren
id|target
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|host
)paren
id|wcsncat
c_func
(paren
id|target
comma
id|host
comma
id|ARRAY_SIZE
c_func
(paren
id|target
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|path
)paren
(brace
id|wcsncat
c_func
(paren
id|target
comma
id|L
l_string|&quot;/&quot;
comma
id|ARRAY_SIZE
c_func
(paren
id|target
)paren
)paren
suffix:semicolon
id|wcsncat
c_func
(paren
id|target
comma
id|path
comma
id|ARRAY_SIZE
c_func
(paren
id|target
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;get&quot;
)paren
)paren
id|get_credential
c_func
(paren
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;store&quot;
)paren
)paren
id|store_credential
c_func
(paren
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;erase&quot;
)paren
)paren
id|erase_credential
c_func
(paren
)paren
suffix:semicolon
multiline_comment|/* otherwise, ignore unknown action */
r_return
l_int|0
suffix:semicolon
)brace
eof
