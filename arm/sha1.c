multiline_comment|/*&n; * SHA-1 implementation optimized for ARM&n; *&n; * Copyright:   (C) 2005 by Nicolas Pitre &lt;nico@cam.org&gt;&n; * Created:     September 17, 2005&n; */
macro_line|#include &lt;string.h&gt;
macro_line|#include &quot;sha1.h&quot;
r_extern
r_void
id|arm_sha_transform
c_func
(paren
r_uint32
op_star
id|hash
comma
r_const
r_int
r_char
op_star
id|data
comma
r_uint32
op_star
id|W
)paren
suffix:semicolon
DECL|function|arm_SHA1_Init
r_void
id|arm_SHA1_Init
c_func
(paren
id|arm_SHA_CTX
op_star
id|c
)paren
(brace
id|c-&gt;len
op_assign
l_int|0
suffix:semicolon
id|c-&gt;hash
(braket
l_int|0
)braket
op_assign
l_int|0x67452301
suffix:semicolon
id|c-&gt;hash
(braket
l_int|1
)braket
op_assign
l_int|0xefcdab89
suffix:semicolon
id|c-&gt;hash
(braket
l_int|2
)braket
op_assign
l_int|0x98badcfe
suffix:semicolon
id|c-&gt;hash
(braket
l_int|3
)braket
op_assign
l_int|0x10325476
suffix:semicolon
id|c-&gt;hash
(braket
l_int|4
)braket
op_assign
l_int|0xc3d2e1f0
suffix:semicolon
)brace
DECL|function|arm_SHA1_Update
r_void
id|arm_SHA1_Update
c_func
(paren
id|arm_SHA_CTX
op_star
id|c
comma
r_const
r_void
op_star
id|p
comma
r_int
r_int
id|n
)paren
(brace
r_uint32
id|workspace
(braket
l_int|80
)braket
suffix:semicolon
r_int
r_int
id|partial
suffix:semicolon
r_int
r_int
id|done
suffix:semicolon
id|partial
op_assign
id|c-&gt;len
op_amp
l_int|0x3f
suffix:semicolon
id|c-&gt;len
op_add_assign
id|n
suffix:semicolon
r_if
c_cond
(paren
(paren
id|partial
op_plus
id|n
)paren
op_ge
l_int|64
)paren
(brace
r_if
c_cond
(paren
id|partial
)paren
(brace
id|done
op_assign
l_int|64
id|partial
suffix:semicolon
id|memcpy
c_func
(paren
id|c-&gt;buffer
op_plus
id|partial
comma
id|p
comma
id|done
)paren
suffix:semicolon
id|arm_sha_transform
c_func
(paren
id|c-&gt;hash
comma
id|c-&gt;buffer
comma
id|workspace
)paren
suffix:semicolon
id|partial
op_assign
l_int|0
suffix:semicolon
)brace
r_else
id|done
op_assign
l_int|0
suffix:semicolon
r_while
c_loop
(paren
id|n
op_ge
id|done
op_plus
l_int|64
)paren
(brace
id|arm_sha_transform
c_func
(paren
id|c-&gt;hash
comma
id|p
op_plus
id|done
comma
id|workspace
)paren
suffix:semicolon
id|done
op_add_assign
l_int|64
suffix:semicolon
)brace
)brace
r_else
id|done
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|n
id|done
)paren
id|memcpy
c_func
(paren
id|c-&gt;buffer
op_plus
id|partial
comma
id|p
op_plus
id|done
comma
id|n
id|done
)paren
suffix:semicolon
)brace
DECL|function|arm_SHA1_Final
r_void
id|arm_SHA1_Final
c_func
(paren
r_int
r_char
op_star
id|hash
comma
id|arm_SHA_CTX
op_star
id|c
)paren
(brace
r_uint64
id|bitlen
suffix:semicolon
r_uint32
id|bitlen_hi
comma
id|bitlen_lo
suffix:semicolon
r_int
r_int
id|i
comma
id|offset
comma
id|padlen
suffix:semicolon
r_int
r_char
id|bits
(braket
l_int|8
)braket
suffix:semicolon
r_static
r_const
r_int
r_char
id|padding
(braket
l_int|64
)braket
op_assign
(brace
l_int|0x80
comma
)brace
suffix:semicolon
id|bitlen
op_assign
id|c-&gt;len
op_lshift
l_int|3
suffix:semicolon
id|offset
op_assign
id|c-&gt;len
op_amp
l_int|0x3f
suffix:semicolon
id|padlen
op_assign
(paren
(paren
id|offset
OL
l_int|56
)paren
ques
c_cond
l_int|56
suffix:colon
(paren
l_int|64
op_plus
l_int|56
)paren
)paren
id|offset
suffix:semicolon
id|arm_SHA1_Update
c_func
(paren
id|c
comma
id|padding
comma
id|padlen
)paren
suffix:semicolon
id|bitlen_hi
op_assign
id|bitlen
op_rshift
l_int|32
suffix:semicolon
id|bitlen_lo
op_assign
id|bitlen
op_amp
l_int|0xffffffff
suffix:semicolon
id|bits
(braket
l_int|0
)braket
op_assign
id|bitlen_hi
op_rshift
l_int|24
suffix:semicolon
id|bits
(braket
l_int|1
)braket
op_assign
id|bitlen_hi
op_rshift
l_int|16
suffix:semicolon
id|bits
(braket
l_int|2
)braket
op_assign
id|bitlen_hi
op_rshift
l_int|8
suffix:semicolon
id|bits
(braket
l_int|3
)braket
op_assign
id|bitlen_hi
suffix:semicolon
id|bits
(braket
l_int|4
)braket
op_assign
id|bitlen_lo
op_rshift
l_int|24
suffix:semicolon
id|bits
(braket
l_int|5
)braket
op_assign
id|bitlen_lo
op_rshift
l_int|16
suffix:semicolon
id|bits
(braket
l_int|6
)braket
op_assign
id|bitlen_lo
op_rshift
l_int|8
suffix:semicolon
id|bits
(braket
l_int|7
)braket
op_assign
id|bitlen_lo
suffix:semicolon
id|arm_SHA1_Update
c_func
(paren
id|c
comma
id|bits
comma
l_int|8
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
l_int|5
suffix:semicolon
id|i
op_increment
)paren
(brace
r_uint32
id|v
op_assign
id|c-&gt;hash
(braket
id|i
)braket
suffix:semicolon
id|hash
(braket
l_int|0
)braket
op_assign
id|v
op_rshift
l_int|24
suffix:semicolon
id|hash
(braket
l_int|1
)braket
op_assign
id|v
op_rshift
l_int|16
suffix:semicolon
id|hash
(braket
l_int|2
)braket
op_assign
id|v
op_rshift
l_int|8
suffix:semicolon
id|hash
(braket
l_int|3
)braket
op_assign
id|v
suffix:semicolon
id|hash
op_add_assign
l_int|4
suffix:semicolon
)brace
)brace
eof
