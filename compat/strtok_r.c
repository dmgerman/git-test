multiline_comment|/* Reentrant string tokenizer.  Generic version.&n;   Copyright (C) 1991,1996-1999,2001,2004 Free Software Foundation, Inc.&n;   This file is part of the GNU C Library.&n;&n;   The GNU C Library is free software; you can redistribute it and/or&n;   modify it under the terms of the GNU Lesser General Public&n;   License as published by the Free Software Foundation; either&n;   version 2.1 of the License, or (at your option) any later version.&n;&n;   The GNU C Library is distributed in the hope that it will be useful,&n;   but WITHOUT ANY WARRANTY; without even the implied warranty of&n;   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU&n;   Lesser General Public License for more details.&n;&n;   You should have received a copy of the GNU Lesser General Public&n;   License along with the GNU C Library; if not, write to the Free&n;   Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA&n;   02111-1307 USA.  */
macro_line|#include &quot;../git-compat-util.h&quot;
multiline_comment|/* Parse S into tokens separated by characters in DELIM.&n;   If S is NULL, the saved pointer in SAVE_PTR is used as&n;   the next starting point.  For example:&n;&t;char s[] = &quot;-abc-=-def&quot;;&n;&t;char *sp;&n;&t;x = strtok_r(s, &quot;-&quot;, &amp;sp);&t;// x = &quot;abc&quot;, sp = &quot;=-def&quot;&n;&t;x = strtok_r(NULL, &quot;-=&quot;, &amp;sp);&t;// x = &quot;def&quot;, sp = NULL&n;&t;x = strtok_r(NULL, &quot;=&quot;, &amp;sp);&t;// x = NULL&n;&t;&t;// s = &quot;abc&bslash;0-def&bslash;0&quot;&n;*/
r_char
op_star
DECL|function|gitstrtok_r
id|gitstrtok_r
(paren
r_char
op_star
id|s
comma
r_const
r_char
op_star
id|delim
comma
r_char
op_star
op_star
id|save_ptr
)paren
(brace
r_char
op_star
id|token
suffix:semicolon
r_if
c_cond
(paren
id|s
op_eq
l_int|NULL
)paren
id|s
op_assign
op_star
id|save_ptr
suffix:semicolon
multiline_comment|/* Scan leading delimiters.  */
id|s
op_add_assign
id|strspn
(paren
id|s
comma
id|delim
)paren
suffix:semicolon
r_if
c_cond
(paren
op_star
id|s
op_eq
l_char|&squot;&bslash;0&squot;
)paren
(brace
op_star
id|save_ptr
op_assign
id|s
suffix:semicolon
r_return
l_int|NULL
suffix:semicolon
)brace
multiline_comment|/* Find the end of the token.  */
id|token
op_assign
id|s
suffix:semicolon
id|s
op_assign
id|strpbrk
(paren
id|token
comma
id|delim
)paren
suffix:semicolon
r_if
c_cond
(paren
id|s
op_eq
l_int|NULL
)paren
multiline_comment|/* This token finishes the string.  */
op_star
id|save_ptr
op_assign
id|token
op_plus
id|strlen
(paren
id|token
)paren
suffix:semicolon
r_else
(brace
multiline_comment|/* Terminate the token and make *SAVE_PTR point past it.  */
op_star
id|s
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
op_star
id|save_ptr
op_assign
id|s
op_plus
l_int|1
suffix:semicolon
)brace
r_return
id|token
suffix:semicolon
)brace
eof
