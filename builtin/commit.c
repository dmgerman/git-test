multiline_comment|/*&n; * Builtin &quot;git commit&quot;&n; *&n; * Copyright (c) 2007 Kristian H&oslash;gsberg &lt;krh@redhat.com&gt;&n; * Based on git-commit.sh by Junio C Hamano and Linus Torvalds&n; */
macro_line|#include &quot;cache.h&quot;
macro_line|#include &quot;cache-tree.h&quot;
macro_line|#include &quot;color.h&quot;
macro_line|#include &quot;dir.h&quot;
macro_line|#include &quot;builtin.h&quot;
macro_line|#include &quot;diff.h&quot;
macro_line|#include &quot;diffcore.h&quot;
macro_line|#include &quot;commit.h&quot;
macro_line|#include &quot;revision.h&quot;
macro_line|#include &quot;wt-status.h&quot;
macro_line|#include &quot;run-command.h&quot;
macro_line|#include &quot;refs.h&quot;
macro_line|#include &quot;log-tree.h&quot;
macro_line|#include &quot;strbuf.h&quot;
macro_line|#include &quot;utf8.h&quot;
macro_line|#include &quot;parse-options.h&quot;
macro_line|#include &quot;string-list.h&quot;
macro_line|#include &quot;rerere.h&quot;
macro_line|#include &quot;unpack-trees.h&quot;
macro_line|#include &quot;quote.h&quot;
macro_line|#include &quot;submodule.h&quot;
macro_line|#include &quot;gpg-interface.h&quot;
DECL|variable|builtin_commit_usage
r_static
r_const
r_char
op_star
r_const
id|builtin_commit_usage
(braket
)braket
op_assign
(brace
l_string|&quot;git commit [options] [--] &lt;filepattern&gt;...&quot;
comma
l_int|NULL
)brace
suffix:semicolon
DECL|variable|builtin_status_usage
r_static
r_const
r_char
op_star
r_const
id|builtin_status_usage
(braket
)braket
op_assign
(brace
l_string|&quot;git status [options] [--] &lt;filepattern&gt;...&quot;
comma
l_int|NULL
)brace
suffix:semicolon
DECL|variable|implicit_ident_advice
r_static
r_const
r_char
id|implicit_ident_advice
(braket
)braket
op_assign
id|N_
c_func
(paren
l_string|&quot;Your name and email address were configured automatically based&bslash;n&quot;
l_string|&quot;on your username and hostname. Please check that they are accurate.&bslash;n&quot;
l_string|&quot;You can suppress this message by setting them explicitly:&bslash;n&quot;
l_string|&quot;&bslash;n&quot;
l_string|&quot;    git config --global user.name &bslash;&quot;Your Name&bslash;&quot;&bslash;n&quot;
l_string|&quot;    git config --global user.email you@example.com&bslash;n&quot;
l_string|&quot;&bslash;n&quot;
l_string|&quot;After doing this, you may fix the identity used for this commit with:&bslash;n&quot;
l_string|&quot;&bslash;n&quot;
l_string|&quot;    git commit --amend --reset-author&bslash;n&quot;
)paren
suffix:semicolon
DECL|variable|empty_amend_advice
r_static
r_const
r_char
id|empty_amend_advice
(braket
)braket
op_assign
id|N_
c_func
(paren
l_string|&quot;You asked to amend the most recent commit, but doing so would make&bslash;n&quot;
l_string|&quot;it empty. You can repeat your command with --allow-empty, or you can&bslash;n&quot;
l_string|&quot;remove the commit entirely with &bslash;&quot;git reset HEAD^&bslash;&quot;.&bslash;n&quot;
)paren
suffix:semicolon
DECL|variable|empty_cherry_pick_advice
r_static
r_const
r_char
id|empty_cherry_pick_advice
(braket
)braket
op_assign
id|N_
c_func
(paren
l_string|&quot;The previous cherry-pick is now empty, possibly due to conflict resolution.&bslash;n&quot;
l_string|&quot;If you wish to commit it anyway, use:&bslash;n&quot;
l_string|&quot;&bslash;n&quot;
l_string|&quot;    git commit --allow-empty&bslash;n&quot;
l_string|&quot;&bslash;n&quot;
l_string|&quot;Otherwise, please use &squot;git reset&squot;&bslash;n&quot;
)paren
suffix:semicolon
DECL|variable|use_message_buffer
r_static
r_const
r_char
op_star
id|use_message_buffer
suffix:semicolon
DECL|variable|commit_editmsg
r_static
r_const
r_char
id|commit_editmsg
(braket
)braket
op_assign
l_string|&quot;COMMIT_EDITMSG&quot;
suffix:semicolon
DECL|variable|index_lock
r_static
r_struct
id|lock_file
id|index_lock
suffix:semicolon
multiline_comment|/* real index */
DECL|variable|false_lock
r_static
r_struct
id|lock_file
id|false_lock
suffix:semicolon
multiline_comment|/* used only for partial commits */
r_static
r_enum
(brace
DECL|enumerator|COMMIT_AS_IS
id|COMMIT_AS_IS
op_assign
l_int|1
comma
DECL|enumerator|COMMIT_NORMAL
id|COMMIT_NORMAL
comma
DECL|enumerator|COMMIT_PARTIAL
id|COMMIT_PARTIAL
DECL|variable|commit_style
)brace
id|commit_style
suffix:semicolon
DECL|variable|logfile
DECL|variable|force_author
r_static
r_const
r_char
op_star
id|logfile
comma
op_star
id|force_author
suffix:semicolon
DECL|variable|template_file
r_static
r_const
r_char
op_star
id|template_file
suffix:semicolon
multiline_comment|/*&n; * The _message variables are commit names from which to take&n; * the commit message and/or authorship.&n; */
DECL|variable|author_message
DECL|variable|author_message_buffer
r_static
r_const
r_char
op_star
id|author_message
comma
op_star
id|author_message_buffer
suffix:semicolon
DECL|variable|edit_message
DECL|variable|use_message
r_static
r_char
op_star
id|edit_message
comma
op_star
id|use_message
suffix:semicolon
DECL|variable|fixup_message
DECL|variable|squash_message
r_static
r_char
op_star
id|fixup_message
comma
op_star
id|squash_message
suffix:semicolon
DECL|variable|all
DECL|variable|also
DECL|variable|interactive
DECL|variable|patch_interactive
DECL|variable|only
DECL|variable|amend
DECL|variable|signoff
r_static
r_int
id|all
comma
id|also
comma
id|interactive
comma
id|patch_interactive
comma
id|only
comma
id|amend
comma
id|signoff
suffix:semicolon
DECL|variable|edit_flag
r_static
r_int
id|edit_flag
op_assign
l_int|1
suffix:semicolon
multiline_comment|/* unspecified */
DECL|variable|quiet
DECL|variable|verbose
DECL|variable|no_verify
DECL|variable|allow_empty
DECL|variable|dry_run
DECL|variable|renew_authorship
r_static
r_int
id|quiet
comma
id|verbose
comma
id|no_verify
comma
id|allow_empty
comma
id|dry_run
comma
id|renew_authorship
suffix:semicolon
DECL|variable|no_post_rewrite
DECL|variable|allow_empty_message
r_static
r_int
id|no_post_rewrite
comma
id|allow_empty_message
suffix:semicolon
DECL|variable|untracked_files_arg
DECL|variable|force_date
DECL|variable|ignore_submodule_arg
r_static
r_char
op_star
id|untracked_files_arg
comma
op_star
id|force_date
comma
op_star
id|ignore_submodule_arg
suffix:semicolon
DECL|variable|sign_commit
r_static
r_char
op_star
id|sign_commit
suffix:semicolon
multiline_comment|/*&n; * The default commit message cleanup mode will remove the lines&n; * beginning with # (shell comments) and leading and trailing&n; * whitespaces (empty lines or containing only whitespaces)&n; * if editor is used, and only the whitespaces if the message&n; * is specified explicitly.&n; */
r_static
r_enum
(brace
DECL|enumerator|CLEANUP_SPACE
id|CLEANUP_SPACE
comma
DECL|enumerator|CLEANUP_NONE
id|CLEANUP_NONE
comma
DECL|enumerator|CLEANUP_ALL
id|CLEANUP_ALL
DECL|variable|cleanup_mode
)brace
id|cleanup_mode
suffix:semicolon
DECL|variable|cleanup_arg
r_static
r_char
op_star
id|cleanup_arg
suffix:semicolon
DECL|variable|whence
r_static
r_enum
id|commit_whence
id|whence
suffix:semicolon
DECL|variable|use_editor
DECL|variable|include_status
r_static
r_int
id|use_editor
op_assign
l_int|1
comma
id|include_status
op_assign
l_int|1
suffix:semicolon
DECL|variable|show_ignored_in_status
r_static
r_int
id|show_ignored_in_status
suffix:semicolon
DECL|variable|only_include_assumed
r_static
r_const
r_char
op_star
id|only_include_assumed
suffix:semicolon
DECL|variable|message
r_static
r_struct
id|strbuf
id|message
op_assign
id|STRBUF_INIT
suffix:semicolon
DECL|variable|null_termination
r_static
r_int
id|null_termination
suffix:semicolon
r_static
r_enum
(brace
DECL|enumerator|STATUS_FORMAT_LONG
id|STATUS_FORMAT_LONG
comma
DECL|enumerator|STATUS_FORMAT_SHORT
id|STATUS_FORMAT_SHORT
comma
DECL|enumerator|STATUS_FORMAT_PORCELAIN
id|STATUS_FORMAT_PORCELAIN
DECL|variable|status_format
)brace
id|status_format
op_assign
id|STATUS_FORMAT_LONG
suffix:semicolon
DECL|variable|status_show_branch
r_static
r_int
id|status_show_branch
suffix:semicolon
DECL|function|opt_parse_m
r_static
r_int
id|opt_parse_m
c_func
(paren
r_const
r_struct
id|option
op_star
id|opt
comma
r_const
r_char
op_star
id|arg
comma
r_int
id|unset
)paren
(brace
r_struct
id|strbuf
op_star
id|buf
op_assign
id|opt-&gt;value
suffix:semicolon
r_if
c_cond
(paren
id|unset
)paren
id|strbuf_setlen
c_func
(paren
id|buf
comma
l_int|0
)paren
suffix:semicolon
r_else
(brace
id|strbuf_addstr
c_func
(paren
id|buf
comma
id|arg
)paren
suffix:semicolon
id|strbuf_addstr
c_func
(paren
id|buf
comma
l_string|&quot;&bslash;n&bslash;n&quot;
)paren
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|variable|builtin_commit_options
r_static
r_struct
id|option
id|builtin_commit_options
(braket
)braket
op_assign
(brace
id|OPT__QUIET
c_func
(paren
op_amp
id|quiet
comma
l_string|&quot;suppress summary after successful commit&quot;
)paren
comma
id|OPT__VERBOSE
c_func
(paren
op_amp
id|verbose
comma
l_string|&quot;show diff in commit message template&quot;
)paren
comma
id|OPT_GROUP
c_func
(paren
l_string|&quot;Commit message options&quot;
)paren
comma
id|OPT_FILENAME
c_func
(paren
l_char|&squot;F&squot;
comma
l_string|&quot;file&quot;
comma
op_amp
id|logfile
comma
l_string|&quot;read message from file&quot;
)paren
comma
id|OPT_STRING
c_func
(paren
l_int|0
comma
l_string|&quot;author&quot;
comma
op_amp
id|force_author
comma
l_string|&quot;author&quot;
comma
l_string|&quot;override author for commit&quot;
)paren
comma
id|OPT_STRING
c_func
(paren
l_int|0
comma
l_string|&quot;date&quot;
comma
op_amp
id|force_date
comma
l_string|&quot;date&quot;
comma
l_string|&quot;override date for commit&quot;
)paren
comma
id|OPT_CALLBACK
c_func
(paren
l_char|&squot;m&squot;
comma
l_string|&quot;message&quot;
comma
op_amp
id|message
comma
l_string|&quot;message&quot;
comma
l_string|&quot;commit message&quot;
comma
id|opt_parse_m
)paren
comma
id|OPT_STRING
c_func
(paren
l_char|&squot;c&squot;
comma
l_string|&quot;reedit-message&quot;
comma
op_amp
id|edit_message
comma
l_string|&quot;commit&quot;
comma
l_string|&quot;reuse and edit message from specified commit&quot;
)paren
comma
id|OPT_STRING
c_func
(paren
l_char|&squot;C&squot;
comma
l_string|&quot;reuse-message&quot;
comma
op_amp
id|use_message
comma
l_string|&quot;commit&quot;
comma
l_string|&quot;reuse message from specified commit&quot;
)paren
comma
id|OPT_STRING
c_func
(paren
l_int|0
comma
l_string|&quot;fixup&quot;
comma
op_amp
id|fixup_message
comma
l_string|&quot;commit&quot;
comma
l_string|&quot;use autosquash formatted message to fixup specified commit&quot;
)paren
comma
id|OPT_STRING
c_func
(paren
l_int|0
comma
l_string|&quot;squash&quot;
comma
op_amp
id|squash_message
comma
l_string|&quot;commit&quot;
comma
l_string|&quot;use autosquash formatted message to squash specified commit&quot;
)paren
comma
id|OPT_BOOLEAN
c_func
(paren
l_int|0
comma
l_string|&quot;reset-author&quot;
comma
op_amp
id|renew_authorship
comma
l_string|&quot;the commit is authored by me now (used with -C/-c/--amend)&quot;
)paren
comma
id|OPT_BOOLEAN
c_func
(paren
l_char|&squot;s&squot;
comma
l_string|&quot;signoff&quot;
comma
op_amp
id|signoff
comma
l_string|&quot;add Signed-off-by:&quot;
)paren
comma
id|OPT_FILENAME
c_func
(paren
l_char|&squot;t&squot;
comma
l_string|&quot;template&quot;
comma
op_amp
id|template_file
comma
l_string|&quot;use specified template file&quot;
)paren
comma
id|OPT_BOOL
c_func
(paren
l_char|&squot;e&squot;
comma
l_string|&quot;edit&quot;
comma
op_amp
id|edit_flag
comma
l_string|&quot;force edit of commit&quot;
)paren
comma
id|OPT_STRING
c_func
(paren
l_int|0
comma
l_string|&quot;cleanup&quot;
comma
op_amp
id|cleanup_arg
comma
l_string|&quot;default&quot;
comma
l_string|&quot;how to strip spaces and #comments from message&quot;
)paren
comma
id|OPT_BOOLEAN
c_func
(paren
l_int|0
comma
l_string|&quot;status&quot;
comma
op_amp
id|include_status
comma
l_string|&quot;include status in commit message template&quot;
)paren
comma
(brace
id|OPTION_STRING
comma
l_char|&squot;S&squot;
comma
l_string|&quot;gpg-sign&quot;
comma
op_amp
id|sign_commit
comma
l_string|&quot;key id&quot;
comma
l_string|&quot;GPG sign commit&quot;
comma
id|PARSE_OPT_OPTARG
comma
l_int|NULL
comma
(paren
r_intptr
)paren
l_string|&quot;&quot;
)brace
comma
multiline_comment|/* end commit message options */
id|OPT_GROUP
c_func
(paren
l_string|&quot;Commit contents options&quot;
)paren
comma
id|OPT_BOOLEAN
c_func
(paren
l_char|&squot;a&squot;
comma
l_string|&quot;all&quot;
comma
op_amp
id|all
comma
l_string|&quot;commit all changed files&quot;
)paren
comma
id|OPT_BOOLEAN
c_func
(paren
l_char|&squot;i&squot;
comma
l_string|&quot;include&quot;
comma
op_amp
id|also
comma
l_string|&quot;add specified files to index for commit&quot;
)paren
comma
id|OPT_BOOLEAN
c_func
(paren
l_int|0
comma
l_string|&quot;interactive&quot;
comma
op_amp
id|interactive
comma
l_string|&quot;interactively add files&quot;
)paren
comma
id|OPT_BOOLEAN
c_func
(paren
l_char|&squot;p&squot;
comma
l_string|&quot;patch&quot;
comma
op_amp
id|patch_interactive
comma
l_string|&quot;interactively add changes&quot;
)paren
comma
id|OPT_BOOLEAN
c_func
(paren
l_char|&squot;o&squot;
comma
l_string|&quot;only&quot;
comma
op_amp
id|only
comma
l_string|&quot;commit only specified files&quot;
)paren
comma
id|OPT_BOOLEAN
c_func
(paren
l_char|&squot;n&squot;
comma
l_string|&quot;no-verify&quot;
comma
op_amp
id|no_verify
comma
l_string|&quot;bypass pre-commit hook&quot;
)paren
comma
id|OPT_BOOLEAN
c_func
(paren
l_int|0
comma
l_string|&quot;dry-run&quot;
comma
op_amp
id|dry_run
comma
l_string|&quot;show what would be committed&quot;
)paren
comma
id|OPT_SET_INT
c_func
(paren
l_int|0
comma
l_string|&quot;short&quot;
comma
op_amp
id|status_format
comma
l_string|&quot;show status concisely&quot;
comma
id|STATUS_FORMAT_SHORT
)paren
comma
id|OPT_BOOLEAN
c_func
(paren
l_int|0
comma
l_string|&quot;branch&quot;
comma
op_amp
id|status_show_branch
comma
l_string|&quot;show branch information&quot;
)paren
comma
id|OPT_SET_INT
c_func
(paren
l_int|0
comma
l_string|&quot;porcelain&quot;
comma
op_amp
id|status_format
comma
l_string|&quot;machine-readable output&quot;
comma
id|STATUS_FORMAT_PORCELAIN
)paren
comma
id|OPT_BOOLEAN
c_func
(paren
l_char|&squot;z&squot;
comma
l_string|&quot;null&quot;
comma
op_amp
id|null_termination
comma
l_string|&quot;terminate entries with NUL&quot;
)paren
comma
id|OPT_BOOLEAN
c_func
(paren
l_int|0
comma
l_string|&quot;amend&quot;
comma
op_amp
id|amend
comma
l_string|&quot;amend previous commit&quot;
)paren
comma
id|OPT_BOOLEAN
c_func
(paren
l_int|0
comma
l_string|&quot;no-post-rewrite&quot;
comma
op_amp
id|no_post_rewrite
comma
l_string|&quot;bypass post-rewrite hook&quot;
)paren
comma
(brace
id|OPTION_STRING
comma
l_char|&squot;u&squot;
comma
l_string|&quot;untracked-files&quot;
comma
op_amp
id|untracked_files_arg
comma
l_string|&quot;mode&quot;
comma
l_string|&quot;show untracked files, optional modes: all, normal, no. (Default: all)&quot;
comma
id|PARSE_OPT_OPTARG
comma
l_int|NULL
comma
(paren
r_intptr
)paren
l_string|&quot;all&quot;
)brace
comma
multiline_comment|/* end commit contents options */
(brace
id|OPTION_BOOLEAN
comma
l_int|0
comma
l_string|&quot;allow-empty&quot;
comma
op_amp
id|allow_empty
comma
l_int|NULL
comma
l_string|&quot;ok to record an empty change&quot;
comma
id|PARSE_OPT_NOARG
op_or
id|PARSE_OPT_HIDDEN
)brace
comma
(brace
id|OPTION_BOOLEAN
comma
l_int|0
comma
l_string|&quot;allow-empty-message&quot;
comma
op_amp
id|allow_empty_message
comma
l_int|NULL
comma
l_string|&quot;ok to record a change with an empty message&quot;
comma
id|PARSE_OPT_NOARG
op_or
id|PARSE_OPT_HIDDEN
)brace
comma
id|OPT_END
c_func
(paren
)paren
)brace
suffix:semicolon
DECL|function|determine_whence
r_static
r_void
id|determine_whence
c_func
(paren
r_struct
id|wt_status
op_star
id|s
)paren
(brace
r_if
c_cond
(paren
id|file_exists
c_func
(paren
id|git_path
c_func
(paren
l_string|&quot;MERGE_HEAD&quot;
)paren
)paren
)paren
id|whence
op_assign
id|FROM_MERGE
suffix:semicolon
r_else
r_if
c_cond
(paren
id|file_exists
c_func
(paren
id|git_path
c_func
(paren
l_string|&quot;CHERRY_PICK_HEAD&quot;
)paren
)paren
)paren
id|whence
op_assign
id|FROM_CHERRY_PICK
suffix:semicolon
r_else
id|whence
op_assign
id|FROM_COMMIT
suffix:semicolon
r_if
c_cond
(paren
id|s
)paren
id|s-&gt;whence
op_assign
id|whence
suffix:semicolon
)brace
DECL|function|whence_s
r_static
r_const
r_char
op_star
id|whence_s
c_func
(paren
r_void
)paren
(brace
r_const
r_char
op_star
id|s
op_assign
l_string|&quot;&quot;
suffix:semicolon
r_switch
c_cond
(paren
id|whence
)paren
(brace
r_case
id|FROM_COMMIT
suffix:colon
r_break
suffix:semicolon
r_case
id|FROM_MERGE
suffix:colon
id|s
op_assign
id|_
c_func
(paren
l_string|&quot;merge&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|FROM_CHERRY_PICK
suffix:colon
id|s
op_assign
id|_
c_func
(paren
l_string|&quot;cherry-pick&quot;
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
id|s
suffix:semicolon
)brace
DECL|function|rollback_index_files
r_static
r_void
id|rollback_index_files
c_func
(paren
r_void
)paren
(brace
r_switch
c_cond
(paren
id|commit_style
)paren
(brace
r_case
id|COMMIT_AS_IS
suffix:colon
r_break
suffix:semicolon
multiline_comment|/* nothing to do */
r_case
id|COMMIT_NORMAL
suffix:colon
id|rollback_lock_file
c_func
(paren
op_amp
id|index_lock
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|COMMIT_PARTIAL
suffix:colon
id|rollback_lock_file
c_func
(paren
op_amp
id|index_lock
)paren
suffix:semicolon
id|rollback_lock_file
c_func
(paren
op_amp
id|false_lock
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
)brace
DECL|function|commit_index_files
r_static
r_int
id|commit_index_files
c_func
(paren
r_void
)paren
(brace
r_int
id|err
op_assign
l_int|0
suffix:semicolon
r_switch
c_cond
(paren
id|commit_style
)paren
(brace
r_case
id|COMMIT_AS_IS
suffix:colon
r_break
suffix:semicolon
multiline_comment|/* nothing to do */
r_case
id|COMMIT_NORMAL
suffix:colon
id|err
op_assign
id|commit_lock_file
c_func
(paren
op_amp
id|index_lock
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|COMMIT_PARTIAL
suffix:colon
id|err
op_assign
id|commit_lock_file
c_func
(paren
op_amp
id|index_lock
)paren
suffix:semicolon
id|rollback_lock_file
c_func
(paren
op_amp
id|false_lock
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
id|err
suffix:semicolon
)brace
multiline_comment|/*&n; * Take a union of paths in the index and the named tree (typically, &quot;HEAD&quot;),&n; * and return the paths that match the given pattern in list.&n; */
DECL|function|list_paths
r_static
r_int
id|list_paths
c_func
(paren
r_struct
id|string_list
op_star
id|list
comma
r_const
r_char
op_star
id|with_tree
comma
r_const
r_char
op_star
id|prefix
comma
r_const
r_char
op_star
op_star
id|pattern
)paren
(brace
r_int
id|i
suffix:semicolon
r_char
op_star
id|m
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|pattern
(braket
id|i
)braket
suffix:semicolon
id|i
op_increment
)paren
suffix:semicolon
id|m
op_assign
id|xcalloc
c_func
(paren
l_int|1
comma
id|i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|with_tree
)paren
(brace
r_char
op_star
id|max_prefix
op_assign
id|common_prefix
c_func
(paren
id|pattern
)paren
suffix:semicolon
id|overlay_tree_on_cache
c_func
(paren
id|with_tree
comma
id|max_prefix
ques
c_cond
id|max_prefix
suffix:colon
id|prefix
)paren
suffix:semicolon
id|free
c_func
(paren
id|max_prefix
)paren
suffix:semicolon
)brace
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|active_nr
suffix:semicolon
id|i
op_increment
)paren
(brace
r_struct
id|cache_entry
op_star
id|ce
op_assign
id|active_cache
(braket
id|i
)braket
suffix:semicolon
r_struct
id|string_list_item
op_star
id|item
suffix:semicolon
r_if
c_cond
(paren
id|ce-&gt;ce_flags
op_amp
id|CE_UPDATE
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|match_pathspec
c_func
(paren
id|pattern
comma
id|ce-&gt;name
comma
id|ce_namelen
c_func
(paren
id|ce
)paren
comma
l_int|0
comma
id|m
)paren
)paren
r_continue
suffix:semicolon
id|item
op_assign
id|string_list_insert
c_func
(paren
id|list
comma
id|ce-&gt;name
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ce_skip_worktree
c_func
(paren
id|ce
)paren
)paren
id|item-&gt;util
op_assign
id|item
suffix:semicolon
multiline_comment|/* better a valid pointer than a fake one */
)brace
r_return
id|report_path_error
c_func
(paren
id|m
comma
id|pattern
comma
id|prefix
)paren
suffix:semicolon
)brace
DECL|function|add_remove_files
r_static
r_void
id|add_remove_files
c_func
(paren
r_struct
id|string_list
op_star
id|list
)paren
(brace
r_int
id|i
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
l_int|0
suffix:semicolon
id|i
OL
id|list-&gt;nr
suffix:semicolon
id|i
op_increment
)paren
(brace
r_struct
id|stat
id|st
suffix:semicolon
r_struct
id|string_list_item
op_star
id|p
op_assign
op_amp
(paren
id|list-&gt;items
(braket
id|i
)braket
)paren
suffix:semicolon
multiline_comment|/* p-&gt;util is skip-worktree */
r_if
c_cond
(paren
id|p-&gt;util
)paren
r_continue
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|lstat
c_func
(paren
id|p-&gt;string
comma
op_amp
id|st
)paren
)paren
(brace
r_if
c_cond
(paren
id|add_to_cache
c_func
(paren
id|p-&gt;string
comma
op_amp
id|st
comma
l_int|0
)paren
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;updating files failed&quot;
)paren
)paren
suffix:semicolon
)brace
r_else
id|remove_file_from_cache
c_func
(paren
id|p-&gt;string
)paren
suffix:semicolon
)brace
)brace
DECL|function|create_base_index
r_static
r_void
id|create_base_index
c_func
(paren
r_const
r_struct
id|commit
op_star
id|current_head
)paren
(brace
r_struct
id|tree
op_star
id|tree
suffix:semicolon
r_struct
id|unpack_trees_options
id|opts
suffix:semicolon
r_struct
id|tree_desc
id|t
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|current_head
)paren
(brace
id|discard_cache
c_func
(paren
)paren
suffix:semicolon
r_return
suffix:semicolon
)brace
id|memset
c_func
(paren
op_amp
id|opts
comma
l_int|0
comma
r_sizeof
(paren
id|opts
)paren
)paren
suffix:semicolon
id|opts.head_idx
op_assign
l_int|1
suffix:semicolon
id|opts.index_only
op_assign
l_int|1
suffix:semicolon
id|opts.merge
op_assign
l_int|1
suffix:semicolon
id|opts.src_index
op_assign
op_amp
id|the_index
suffix:semicolon
id|opts.dst_index
op_assign
op_amp
id|the_index
suffix:semicolon
id|opts.fn
op_assign
id|oneway_merge
suffix:semicolon
id|tree
op_assign
id|parse_tree_indirect
c_func
(paren
id|current_head-&gt;object.sha1
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|tree
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;failed to unpack HEAD tree object&quot;
)paren
)paren
suffix:semicolon
id|parse_tree
c_func
(paren
id|tree
)paren
suffix:semicolon
id|init_tree_desc
c_func
(paren
op_amp
id|t
comma
id|tree-&gt;buffer
comma
id|tree-&gt;size
)paren
suffix:semicolon
r_if
c_cond
(paren
id|unpack_trees
c_func
(paren
l_int|1
comma
op_amp
id|t
comma
op_amp
id|opts
)paren
)paren
m_exit
(paren
l_int|128
)paren
suffix:semicolon
multiline_comment|/* We&squot;ve already reported the error, finish dying */
)brace
DECL|function|refresh_cache_or_die
r_static
r_void
id|refresh_cache_or_die
c_func
(paren
r_int
id|refresh_flags
)paren
(brace
multiline_comment|/*&n;&t; * refresh_flags contains REFRESH_QUIET, so the only errors&n;&t; * are for unmerged entries.&n;&t; */
r_if
c_cond
(paren
id|refresh_cache
c_func
(paren
id|refresh_flags
op_or
id|REFRESH_IN_PORCELAIN
)paren
)paren
id|die_resolve_conflict
c_func
(paren
l_string|&quot;commit&quot;
)paren
suffix:semicolon
)brace
DECL|function|prepare_index
r_static
r_char
op_star
id|prepare_index
c_func
(paren
r_int
id|argc
comma
r_const
r_char
op_star
op_star
id|argv
comma
r_const
r_char
op_star
id|prefix
comma
r_const
r_struct
id|commit
op_star
id|current_head
comma
r_int
id|is_status
)paren
(brace
r_int
id|fd
suffix:semicolon
r_struct
id|string_list
id|partial
suffix:semicolon
r_const
r_char
op_star
op_star
id|pathspec
op_assign
l_int|NULL
suffix:semicolon
r_char
op_star
id|old_index_env
op_assign
l_int|NULL
suffix:semicolon
r_int
id|refresh_flags
op_assign
id|REFRESH_QUIET
suffix:semicolon
r_if
c_cond
(paren
id|is_status
)paren
id|refresh_flags
op_or_assign
id|REFRESH_UNMERGED
suffix:semicolon
r_if
c_cond
(paren
op_star
id|argv
)paren
id|pathspec
op_assign
id|get_pathspec
c_func
(paren
id|prefix
comma
id|argv
)paren
suffix:semicolon
r_if
c_cond
(paren
id|read_cache_preload
c_func
(paren
id|pathspec
)paren
OL
l_int|0
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;index file corrupt&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|interactive
)paren
(brace
id|fd
op_assign
id|hold_locked_index
c_func
(paren
op_amp
id|index_lock
comma
l_int|1
)paren
suffix:semicolon
id|refresh_cache_or_die
c_func
(paren
id|refresh_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|write_cache
c_func
(paren
id|fd
comma
id|active_cache
comma
id|active_nr
)paren
op_logical_or
id|close_lock_file
c_func
(paren
op_amp
id|index_lock
)paren
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;unable to create temporary index&quot;
)paren
)paren
suffix:semicolon
id|old_index_env
op_assign
id|getenv
c_func
(paren
id|INDEX_ENVIRONMENT
)paren
suffix:semicolon
id|setenv
c_func
(paren
id|INDEX_ENVIRONMENT
comma
id|index_lock.filename
comma
l_int|1
)paren
suffix:semicolon
r_if
c_cond
(paren
id|interactive_add
c_func
(paren
id|argc
comma
id|argv
comma
id|prefix
comma
id|patch_interactive
)paren
op_ne
l_int|0
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;interactive add failed&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|old_index_env
op_logical_and
op_star
id|old_index_env
)paren
id|setenv
c_func
(paren
id|INDEX_ENVIRONMENT
comma
id|old_index_env
comma
l_int|1
)paren
suffix:semicolon
r_else
id|unsetenv
c_func
(paren
id|INDEX_ENVIRONMENT
)paren
suffix:semicolon
id|discard_cache
c_func
(paren
)paren
suffix:semicolon
id|read_cache_from
c_func
(paren
id|index_lock.filename
)paren
suffix:semicolon
id|commit_style
op_assign
id|COMMIT_NORMAL
suffix:semicolon
r_return
id|index_lock.filename
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Non partial, non as-is commit.&n;&t; *&n;&t; * (1) get the real index;&n;&t; * (2) update the_index as necessary;&n;&t; * (3) write the_index out to the real index (still locked);&n;&t; * (4) return the name of the locked index file.&n;&t; *&n;&t; * The caller should run hooks on the locked real index, and&n;&t; * (A) if all goes well, commit the real index;&n;&t; * (B) on failure, rollback the real index.&n;&t; */
r_if
c_cond
(paren
id|all
op_logical_or
(paren
id|also
op_logical_and
id|pathspec
op_logical_and
op_star
id|pathspec
)paren
)paren
(brace
id|fd
op_assign
id|hold_locked_index
c_func
(paren
op_amp
id|index_lock
comma
l_int|1
)paren
suffix:semicolon
id|add_files_to_cache
c_func
(paren
id|also
ques
c_cond
id|prefix
suffix:colon
l_int|NULL
comma
id|pathspec
comma
l_int|0
)paren
suffix:semicolon
id|refresh_cache_or_die
c_func
(paren
id|refresh_flags
)paren
suffix:semicolon
id|update_main_cache_tree
c_func
(paren
id|WRITE_TREE_SILENT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|write_cache
c_func
(paren
id|fd
comma
id|active_cache
comma
id|active_nr
)paren
op_logical_or
id|close_lock_file
c_func
(paren
op_amp
id|index_lock
)paren
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;unable to write new_index file&quot;
)paren
)paren
suffix:semicolon
id|commit_style
op_assign
id|COMMIT_NORMAL
suffix:semicolon
r_return
id|index_lock.filename
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * As-is commit.&n;&t; *&n;&t; * (1) return the name of the real index file.&n;&t; *&n;&t; * The caller should run hooks on the real index,&n;&t; * and create commit from the_index.&n;&t; * We still need to refresh the index here.&n;&t; */
r_if
c_cond
(paren
op_logical_neg
id|pathspec
op_logical_or
op_logical_neg
op_star
id|pathspec
)paren
(brace
id|fd
op_assign
id|hold_locked_index
c_func
(paren
op_amp
id|index_lock
comma
l_int|1
)paren
suffix:semicolon
id|refresh_cache_or_die
c_func
(paren
id|refresh_flags
)paren
suffix:semicolon
r_if
c_cond
(paren
id|active_cache_changed
)paren
(brace
id|update_main_cache_tree
c_func
(paren
id|WRITE_TREE_SILENT
)paren
suffix:semicolon
r_if
c_cond
(paren
id|write_cache
c_func
(paren
id|fd
comma
id|active_cache
comma
id|active_nr
)paren
op_logical_or
id|commit_locked_index
c_func
(paren
op_amp
id|index_lock
)paren
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;unable to write new_index file&quot;
)paren
)paren
suffix:semicolon
)brace
r_else
(brace
id|rollback_lock_file
c_func
(paren
op_amp
id|index_lock
)paren
suffix:semicolon
)brace
id|commit_style
op_assign
id|COMMIT_AS_IS
suffix:semicolon
r_return
id|get_index_file
c_func
(paren
)paren
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * A partial commit.&n;&t; *&n;&t; * (0) find the set of affected paths;&n;&t; * (1) get lock on the real index file;&n;&t; * (2) update the_index with the given paths;&n;&t; * (3) write the_index out to the real index (still locked);&n;&t; * (4) get lock on the false index file;&n;&t; * (5) reset the_index from HEAD;&n;&t; * (6) update the_index the same way as (2);&n;&t; * (7) write the_index out to the false index file;&n;&t; * (8) return the name of the false index file (still locked);&n;&t; *&n;&t; * The caller should run hooks on the locked false index, and&n;&t; * create commit from it.  Then&n;&t; * (A) if all goes well, commit the real index;&n;&t; * (B) on failure, rollback the real index;&n;&t; * In either case, rollback the false index.&n;&t; */
id|commit_style
op_assign
id|COMMIT_PARTIAL
suffix:semicolon
r_if
c_cond
(paren
id|whence
op_ne
id|FROM_COMMIT
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;cannot do a partial commit during a %s.&quot;
)paren
comma
id|whence_s
c_func
(paren
)paren
)paren
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|partial
comma
l_int|0
comma
r_sizeof
(paren
id|partial
)paren
)paren
suffix:semicolon
id|partial.strdup_strings
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
id|list_paths
c_func
(paren
op_amp
id|partial
comma
op_logical_neg
id|current_head
ques
c_cond
l_int|NULL
suffix:colon
l_string|&quot;HEAD&quot;
comma
id|prefix
comma
id|pathspec
)paren
)paren
m_exit
(paren
l_int|1
)paren
suffix:semicolon
id|discard_cache
c_func
(paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|read_cache
c_func
(paren
)paren
OL
l_int|0
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;cannot read the index&quot;
)paren
)paren
suffix:semicolon
id|fd
op_assign
id|hold_locked_index
c_func
(paren
op_amp
id|index_lock
comma
l_int|1
)paren
suffix:semicolon
id|add_remove_files
c_func
(paren
op_amp
id|partial
)paren
suffix:semicolon
id|refresh_cache
c_func
(paren
id|REFRESH_QUIET
)paren
suffix:semicolon
r_if
c_cond
(paren
id|write_cache
c_func
(paren
id|fd
comma
id|active_cache
comma
id|active_nr
)paren
op_logical_or
id|close_lock_file
c_func
(paren
op_amp
id|index_lock
)paren
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;unable to write new_index file&quot;
)paren
)paren
suffix:semicolon
id|fd
op_assign
id|hold_lock_file_for_update
c_func
(paren
op_amp
id|false_lock
comma
id|git_path
c_func
(paren
l_string|&quot;next-index-%&quot;
id|PRIuMAX
comma
(paren
r_uintmax
)paren
id|getpid
c_func
(paren
)paren
)paren
comma
id|LOCK_DIE_ON_ERROR
)paren
suffix:semicolon
id|create_base_index
c_func
(paren
id|current_head
)paren
suffix:semicolon
id|add_remove_files
c_func
(paren
op_amp
id|partial
)paren
suffix:semicolon
id|refresh_cache
c_func
(paren
id|REFRESH_QUIET
)paren
suffix:semicolon
r_if
c_cond
(paren
id|write_cache
c_func
(paren
id|fd
comma
id|active_cache
comma
id|active_nr
)paren
op_logical_or
id|close_lock_file
c_func
(paren
op_amp
id|false_lock
)paren
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;unable to write temporary index file&quot;
)paren
)paren
suffix:semicolon
id|discard_cache
c_func
(paren
)paren
suffix:semicolon
id|read_cache_from
c_func
(paren
id|false_lock.filename
)paren
suffix:semicolon
r_return
id|false_lock.filename
suffix:semicolon
)brace
DECL|function|run_status
r_static
r_int
id|run_status
c_func
(paren
id|FILE
op_star
id|fp
comma
r_const
r_char
op_star
id|index_file
comma
r_const
r_char
op_star
id|prefix
comma
r_int
id|nowarn
comma
r_struct
id|wt_status
op_star
id|s
)paren
(brace
r_int
r_char
id|sha1
(braket
l_int|20
)braket
suffix:semicolon
r_if
c_cond
(paren
id|s-&gt;relative_paths
)paren
id|s-&gt;prefix
op_assign
id|prefix
suffix:semicolon
r_if
c_cond
(paren
id|amend
)paren
(brace
id|s-&gt;amend
op_assign
l_int|1
suffix:semicolon
id|s-&gt;reference
op_assign
l_string|&quot;HEAD^1&quot;
suffix:semicolon
)brace
id|s-&gt;verbose
op_assign
id|verbose
suffix:semicolon
id|s-&gt;index_file
op_assign
id|index_file
suffix:semicolon
id|s-&gt;fp
op_assign
id|fp
suffix:semicolon
id|s-&gt;nowarn
op_assign
id|nowarn
suffix:semicolon
id|s-&gt;is_initial
op_assign
id|get_sha1
c_func
(paren
id|s-&gt;reference
comma
id|sha1
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
id|wt_status_collect
c_func
(paren
id|s
)paren
suffix:semicolon
r_switch
c_cond
(paren
id|status_format
)paren
(brace
r_case
id|STATUS_FORMAT_SHORT
suffix:colon
id|wt_shortstatus_print
c_func
(paren
id|s
comma
id|null_termination
comma
id|status_show_branch
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|STATUS_FORMAT_PORCELAIN
suffix:colon
id|wt_porcelain_print
c_func
(paren
id|s
comma
id|null_termination
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|STATUS_FORMAT_LONG
suffix:colon
id|wt_status_print
c_func
(paren
id|s
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
id|s-&gt;commitable
suffix:semicolon
)brace
DECL|function|is_a_merge
r_static
r_int
id|is_a_merge
c_func
(paren
r_const
r_struct
id|commit
op_star
id|current_head
)paren
(brace
r_return
op_logical_neg
op_logical_neg
(paren
id|current_head-&gt;parents
op_logical_and
id|current_head-&gt;parents-&gt;next
)paren
suffix:semicolon
)brace
DECL|variable|sign_off_header
r_static
r_const
r_char
id|sign_off_header
(braket
)braket
op_assign
l_string|&quot;Signed-off-by: &quot;
suffix:semicolon
DECL|function|export_one
r_static
r_void
id|export_one
c_func
(paren
r_const
r_char
op_star
id|var
comma
r_const
r_char
op_star
id|s
comma
r_const
r_char
op_star
id|e
comma
r_int
id|hack
)paren
(brace
r_struct
id|strbuf
id|buf
op_assign
id|STRBUF_INIT
suffix:semicolon
r_if
c_cond
(paren
id|hack
)paren
id|strbuf_addch
c_func
(paren
op_amp
id|buf
comma
id|hack
)paren
suffix:semicolon
id|strbuf_addf
c_func
(paren
op_amp
id|buf
comma
l_string|&quot;%.*s&quot;
comma
(paren
r_int
)paren
(paren
id|e
id|s
)paren
comma
id|s
)paren
suffix:semicolon
id|setenv
c_func
(paren
id|var
comma
id|buf.buf
comma
l_int|1
)paren
suffix:semicolon
id|strbuf_release
c_func
(paren
op_amp
id|buf
)paren
suffix:semicolon
)brace
DECL|function|determine_author_info
r_static
r_void
id|determine_author_info
c_func
(paren
r_struct
id|strbuf
op_star
id|author_ident
)paren
(brace
r_char
op_star
id|name
comma
op_star
id|email
comma
op_star
id|date
suffix:semicolon
r_struct
id|ident_split
id|author
suffix:semicolon
id|name
op_assign
id|getenv
c_func
(paren
l_string|&quot;GIT_AUTHOR_NAME&quot;
)paren
suffix:semicolon
id|email
op_assign
id|getenv
c_func
(paren
l_string|&quot;GIT_AUTHOR_EMAIL&quot;
)paren
suffix:semicolon
id|date
op_assign
id|getenv
c_func
(paren
l_string|&quot;GIT_AUTHOR_DATE&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|author_message
)paren
(brace
r_const
r_char
op_star
id|a
comma
op_star
id|lb
comma
op_star
id|rb
comma
op_star
id|eol
suffix:semicolon
r_int
id|len
suffix:semicolon
id|a
op_assign
id|strstr
c_func
(paren
id|author_message_buffer
comma
l_string|&quot;&bslash;nauthor &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|a
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;invalid commit: %s&quot;
)paren
comma
id|author_message
)paren
suffix:semicolon
id|lb
op_assign
id|strchrnul
c_func
(paren
id|a
op_plus
id|strlen
c_func
(paren
l_string|&quot;&bslash;nauthor &quot;
)paren
comma
l_char|&squot;&lt;&squot;
)paren
suffix:semicolon
id|rb
op_assign
id|strchrnul
c_func
(paren
id|lb
comma
l_char|&squot;&gt;&squot;
)paren
suffix:semicolon
id|eol
op_assign
id|strchrnul
c_func
(paren
id|rb
comma
l_char|&squot;&bslash;n&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
op_star
id|lb
op_logical_or
op_logical_neg
op_star
id|rb
op_logical_or
op_logical_neg
op_star
id|eol
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;invalid commit: %s&quot;
)paren
comma
id|author_message
)paren
suffix:semicolon
r_if
c_cond
(paren
id|lb
op_eq
id|a
op_plus
id|strlen
c_func
(paren
l_string|&quot;&bslash;nauthor &quot;
)paren
)paren
multiline_comment|/* &bslash;nauthor &lt;foo@example.com&gt; */
id|name
op_assign
id|xcalloc
c_func
(paren
l_int|1
comma
l_int|1
)paren
suffix:semicolon
r_else
id|name
op_assign
id|xmemdupz
c_func
(paren
id|a
op_plus
id|strlen
c_func
(paren
l_string|&quot;&bslash;nauthor &quot;
)paren
comma
(paren
id|lb
id|strlen
c_func
(paren
l_string|&quot; &quot;
)paren
(paren
id|a
op_plus
id|strlen
c_func
(paren
l_string|&quot;&bslash;nauthor &quot;
)paren
)paren
)paren
)paren
suffix:semicolon
id|email
op_assign
id|xmemdupz
c_func
(paren
id|lb
op_plus
id|strlen
c_func
(paren
l_string|&quot;&lt;&quot;
)paren
comma
id|rb
(paren
id|lb
op_plus
id|strlen
c_func
(paren
l_string|&quot;&lt;&quot;
)paren
)paren
)paren
suffix:semicolon
id|date
op_assign
id|xmemdupz
c_func
(paren
id|rb
op_plus
id|strlen
c_func
(paren
l_string|&quot;&gt; &quot;
)paren
comma
id|eol
(paren
id|rb
op_plus
id|strlen
c_func
(paren
l_string|&quot;&gt; &quot;
)paren
)paren
)paren
suffix:semicolon
id|len
op_assign
id|eol
(paren
id|rb
op_plus
id|strlen
c_func
(paren
l_string|&quot;&gt; &quot;
)paren
)paren
suffix:semicolon
id|date
op_assign
id|xmalloc
c_func
(paren
id|len
op_plus
l_int|2
)paren
suffix:semicolon
op_star
id|date
op_assign
l_char|&squot;@&squot;
suffix:semicolon
id|memcpy
c_func
(paren
id|date
op_plus
l_int|1
comma
id|rb
op_plus
id|strlen
c_func
(paren
l_string|&quot;&gt; &quot;
)paren
comma
id|len
)paren
suffix:semicolon
id|date
(braket
id|len
op_plus
l_int|1
)braket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
)brace
r_if
c_cond
(paren
id|force_author
)paren
(brace
r_const
r_char
op_star
id|lb
op_assign
id|strstr
c_func
(paren
id|force_author
comma
l_string|&quot; &lt;&quot;
)paren
suffix:semicolon
r_const
r_char
op_star
id|rb
op_assign
id|strchr
c_func
(paren
id|force_author
comma
l_char|&squot;&gt;&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|lb
op_logical_or
op_logical_neg
id|rb
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;malformed --author parameter&quot;
)paren
)paren
suffix:semicolon
id|name
op_assign
id|xstrndup
c_func
(paren
id|force_author
comma
id|lb
id|force_author
)paren
suffix:semicolon
id|email
op_assign
id|xstrndup
c_func
(paren
id|lb
op_plus
l_int|2
comma
id|rb
(paren
id|lb
op_plus
l_int|2
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|force_date
)paren
id|date
op_assign
id|force_date
suffix:semicolon
id|strbuf_addstr
c_func
(paren
id|author_ident
comma
id|fmt_ident
c_func
(paren
id|name
comma
id|email
comma
id|date
comma
id|IDENT_ERROR_ON_NO_NAME
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|split_ident_line
c_func
(paren
op_amp
id|author
comma
id|author_ident-&gt;buf
comma
id|author_ident-&gt;len
)paren
)paren
(brace
id|export_one
c_func
(paren
l_string|&quot;GIT_AUTHOR_NAME&quot;
comma
id|author.name_begin
comma
id|author.name_end
comma
l_int|0
)paren
suffix:semicolon
id|export_one
c_func
(paren
l_string|&quot;GIT_AUTHOR_EMAIL&quot;
comma
id|author.mail_begin
comma
id|author.mail_end
comma
l_int|0
)paren
suffix:semicolon
id|export_one
c_func
(paren
l_string|&quot;GIT_AUTHOR_DATE&quot;
comma
id|author.date_begin
comma
id|author.tz_end
comma
l_char|&squot;@&squot;
)paren
suffix:semicolon
)brace
)brace
DECL|function|ends_rfc2822_footer
r_static
r_int
id|ends_rfc2822_footer
c_func
(paren
r_struct
id|strbuf
op_star
id|sb
)paren
(brace
r_int
id|ch
suffix:semicolon
r_int
id|hit
op_assign
l_int|0
suffix:semicolon
r_int
id|i
comma
id|j
comma
id|k
suffix:semicolon
r_int
id|len
op_assign
id|sb-&gt;len
suffix:semicolon
r_int
id|first
op_assign
l_int|1
suffix:semicolon
r_const
r_char
op_star
id|buf
op_assign
id|sb-&gt;buf
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|len
l_int|1
suffix:semicolon
id|i
OG
l_int|0
suffix:semicolon
id|i
op_decrement
)paren
(brace
r_if
c_cond
(paren
id|hit
op_logical_and
id|buf
(braket
id|i
)braket
op_eq
l_char|&squot;&bslash;n&squot;
)paren
r_break
suffix:semicolon
id|hit
op_assign
(paren
id|buf
(braket
id|i
)braket
op_eq
l_char|&squot;&bslash;n&squot;
)paren
suffix:semicolon
)brace
r_while
c_loop
(paren
id|i
OL
id|len
l_int|1
op_logical_and
id|buf
(braket
id|i
)braket
op_eq
l_char|&squot;&bslash;n&squot;
)paren
id|i
op_increment
suffix:semicolon
r_for
c_loop
(paren
suffix:semicolon
id|i
OL
id|len
suffix:semicolon
id|i
op_assign
id|k
)paren
(brace
r_for
c_loop
(paren
id|k
op_assign
id|i
suffix:semicolon
id|k
OL
id|len
op_logical_and
id|buf
(braket
id|k
)braket
op_ne
l_char|&squot;&bslash;n&squot;
suffix:semicolon
id|k
op_increment
)paren
suffix:semicolon
multiline_comment|/* do nothing */
id|k
op_increment
suffix:semicolon
r_if
c_cond
(paren
(paren
id|buf
(braket
id|k
)braket
op_eq
l_char|&squot; &squot;
op_logical_or
id|buf
(braket
id|k
)braket
op_eq
l_char|&squot;&bslash;t&squot;
)paren
op_logical_and
op_logical_neg
id|first
)paren
r_continue
suffix:semicolon
id|first
op_assign
l_int|0
suffix:semicolon
r_for
c_loop
(paren
id|j
op_assign
l_int|0
suffix:semicolon
id|i
op_plus
id|j
OL
id|len
suffix:semicolon
id|j
op_increment
)paren
(brace
id|ch
op_assign
id|buf
(braket
id|i
op_plus
id|j
)braket
suffix:semicolon
r_if
c_cond
(paren
id|ch
op_eq
l_char|&squot;:&squot;
)paren
r_break
suffix:semicolon
r_if
c_cond
(paren
id|isalnum
c_func
(paren
id|ch
)paren
op_logical_or
(paren
id|ch
op_eq
l_char|&squot;-&squot;
)paren
)paren
r_continue
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
)brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|cut_ident_timestamp_part
r_static
r_char
op_star
id|cut_ident_timestamp_part
c_func
(paren
r_char
op_star
id|string
)paren
(brace
r_char
op_star
id|ket
op_assign
id|strrchr
c_func
(paren
id|string
comma
l_char|&squot;&gt;&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ket
op_logical_or
id|ket
(braket
l_int|1
)braket
op_ne
l_char|&squot; &squot;
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;Malformed ident string: &squot;%s&squot;&quot;
)paren
comma
id|string
)paren
suffix:semicolon
op_star
op_increment
id|ket
op_assign
l_char|&squot;&bslash;0&squot;
suffix:semicolon
r_return
id|ket
suffix:semicolon
)brace
DECL|function|prepare_to_commit
r_static
r_int
id|prepare_to_commit
c_func
(paren
r_const
r_char
op_star
id|index_file
comma
r_const
r_char
op_star
id|prefix
comma
r_struct
id|commit
op_star
id|current_head
comma
r_struct
id|wt_status
op_star
id|s
comma
r_struct
id|strbuf
op_star
id|author_ident
)paren
(brace
r_struct
id|stat
id|statbuf
suffix:semicolon
r_struct
id|strbuf
id|committer_ident
op_assign
id|STRBUF_INIT
suffix:semicolon
r_int
id|commitable
comma
id|saved_color_setting
suffix:semicolon
r_struct
id|strbuf
id|sb
op_assign
id|STRBUF_INIT
suffix:semicolon
r_char
op_star
id|buffer
suffix:semicolon
r_const
r_char
op_star
id|hook_arg1
op_assign
l_int|NULL
suffix:semicolon
r_const
r_char
op_star
id|hook_arg2
op_assign
l_int|NULL
suffix:semicolon
r_int
id|ident_shown
op_assign
l_int|0
suffix:semicolon
r_int
id|clean_message_contents
op_assign
(paren
id|cleanup_mode
op_ne
id|CLEANUP_NONE
)paren
suffix:semicolon
multiline_comment|/* This checks and barfs if author is badly specified */
id|determine_author_info
c_func
(paren
id|author_ident
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|no_verify
op_logical_and
id|run_hook
c_func
(paren
id|index_file
comma
l_string|&quot;pre-commit&quot;
comma
l_int|NULL
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|squash_message
)paren
(brace
multiline_comment|/*&n;&t;&t; * Insert the proper subject line before other commit&n;&t;&t; * message options add their content.&n;&t;&t; */
r_if
c_cond
(paren
id|use_message
op_logical_and
op_logical_neg
id|strcmp
c_func
(paren
id|use_message
comma
id|squash_message
)paren
)paren
id|strbuf_addstr
c_func
(paren
op_amp
id|sb
comma
l_string|&quot;squash! &quot;
)paren
suffix:semicolon
r_else
(brace
r_struct
id|pretty_print_context
id|ctx
op_assign
(brace
l_int|0
)brace
suffix:semicolon
r_struct
id|commit
op_star
id|c
suffix:semicolon
id|c
op_assign
id|lookup_commit_reference_by_name
c_func
(paren
id|squash_message
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|c
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;could not lookup commit %s&quot;
)paren
comma
id|squash_message
)paren
suffix:semicolon
id|ctx.output_encoding
op_assign
id|get_commit_output_encoding
c_func
(paren
)paren
suffix:semicolon
id|format_commit_message
c_func
(paren
id|c
comma
l_string|&quot;squash! %s&bslash;n&bslash;n&quot;
comma
op_amp
id|sb
comma
op_amp
id|ctx
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|message.len
)paren
(brace
id|strbuf_addbuf
c_func
(paren
op_amp
id|sb
comma
op_amp
id|message
)paren
suffix:semicolon
id|hook_arg1
op_assign
l_string|&quot;message&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|logfile
op_logical_and
op_logical_neg
id|strcmp
c_func
(paren
id|logfile
comma
l_string|&quot;-&quot;
)paren
)paren
(brace
r_if
c_cond
(paren
id|isatty
c_func
(paren
l_int|0
)paren
)paren
id|fprintf
c_func
(paren
id|stderr
comma
id|_
c_func
(paren
l_string|&quot;(reading log message from standard input)&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|strbuf_read
c_func
(paren
op_amp
id|sb
comma
l_int|0
comma
l_int|0
)paren
OL
l_int|0
)paren
id|die_errno
c_func
(paren
id|_
c_func
(paren
l_string|&quot;could not read log from standard input&quot;
)paren
)paren
suffix:semicolon
id|hook_arg1
op_assign
l_string|&quot;message&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|logfile
)paren
(brace
r_if
c_cond
(paren
id|strbuf_read_file
c_func
(paren
op_amp
id|sb
comma
id|logfile
comma
l_int|0
)paren
OL
l_int|0
)paren
id|die_errno
c_func
(paren
id|_
c_func
(paren
l_string|&quot;could not read log file &squot;%s&squot;&quot;
)paren
comma
id|logfile
)paren
suffix:semicolon
id|hook_arg1
op_assign
l_string|&quot;message&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|use_message
)paren
(brace
id|buffer
op_assign
id|strstr
c_func
(paren
id|use_message_buffer
comma
l_string|&quot;&bslash;n&bslash;n&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|buffer
op_logical_or
id|buffer
(braket
l_int|2
)braket
op_eq
l_char|&squot;&bslash;0&squot;
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;commit has empty message&quot;
)paren
)paren
suffix:semicolon
id|strbuf_add
c_func
(paren
op_amp
id|sb
comma
id|buffer
op_plus
l_int|2
comma
id|strlen
c_func
(paren
id|buffer
op_plus
l_int|2
)paren
)paren
suffix:semicolon
id|hook_arg1
op_assign
l_string|&quot;commit&quot;
suffix:semicolon
id|hook_arg2
op_assign
id|use_message
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|fixup_message
)paren
(brace
r_struct
id|pretty_print_context
id|ctx
op_assign
(brace
l_int|0
)brace
suffix:semicolon
r_struct
id|commit
op_star
id|commit
suffix:semicolon
id|commit
op_assign
id|lookup_commit_reference_by_name
c_func
(paren
id|fixup_message
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|commit
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;could not lookup commit %s&quot;
)paren
comma
id|fixup_message
)paren
suffix:semicolon
id|ctx.output_encoding
op_assign
id|get_commit_output_encoding
c_func
(paren
)paren
suffix:semicolon
id|format_commit_message
c_func
(paren
id|commit
comma
l_string|&quot;fixup! %s&bslash;n&bslash;n&quot;
comma
op_amp
id|sb
comma
op_amp
id|ctx
)paren
suffix:semicolon
id|hook_arg1
op_assign
l_string|&quot;message&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|stat
c_func
(paren
id|git_path
c_func
(paren
l_string|&quot;MERGE_MSG&quot;
)paren
comma
op_amp
id|statbuf
)paren
)paren
(brace
r_if
c_cond
(paren
id|strbuf_read_file
c_func
(paren
op_amp
id|sb
comma
id|git_path
c_func
(paren
l_string|&quot;MERGE_MSG&quot;
)paren
comma
l_int|0
)paren
OL
l_int|0
)paren
id|die_errno
c_func
(paren
id|_
c_func
(paren
l_string|&quot;could not read MERGE_MSG&quot;
)paren
)paren
suffix:semicolon
id|hook_arg1
op_assign
l_string|&quot;merge&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|stat
c_func
(paren
id|git_path
c_func
(paren
l_string|&quot;SQUASH_MSG&quot;
)paren
comma
op_amp
id|statbuf
)paren
)paren
(brace
r_if
c_cond
(paren
id|strbuf_read_file
c_func
(paren
op_amp
id|sb
comma
id|git_path
c_func
(paren
l_string|&quot;SQUASH_MSG&quot;
)paren
comma
l_int|0
)paren
OL
l_int|0
)paren
id|die_errno
c_func
(paren
id|_
c_func
(paren
l_string|&quot;could not read SQUASH_MSG&quot;
)paren
)paren
suffix:semicolon
id|hook_arg1
op_assign
l_string|&quot;squash&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|template_file
)paren
(brace
r_if
c_cond
(paren
id|strbuf_read_file
c_func
(paren
op_amp
id|sb
comma
id|template_file
comma
l_int|0
)paren
OL
l_int|0
)paren
id|die_errno
c_func
(paren
id|_
c_func
(paren
l_string|&quot;could not read &squot;%s&squot;&quot;
)paren
comma
id|template_file
)paren
suffix:semicolon
id|hook_arg1
op_assign
l_string|&quot;template&quot;
suffix:semicolon
id|clean_message_contents
op_assign
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * The remaining cases don&squot;t modify the template message, but&n;&t; * just set the argument(s) to the prepare-commit-msg hook.&n;&t; */
r_else
r_if
c_cond
(paren
id|whence
op_eq
id|FROM_MERGE
)paren
id|hook_arg1
op_assign
l_string|&quot;merge&quot;
suffix:semicolon
r_else
r_if
c_cond
(paren
id|whence
op_eq
id|FROM_CHERRY_PICK
)paren
(brace
id|hook_arg1
op_assign
l_string|&quot;commit&quot;
suffix:semicolon
id|hook_arg2
op_assign
l_string|&quot;CHERRY_PICK_HEAD&quot;
suffix:semicolon
)brace
r_if
c_cond
(paren
id|squash_message
)paren
(brace
multiline_comment|/*&n;&t;&t; * If squash_commit was used for the commit subject,&n;&t;&t; * then we&squot;re possibly hijacking other commit log options.&n;&t;&t; * Reset the hook args to tell the real story.&n;&t;&t; */
id|hook_arg1
op_assign
l_string|&quot;message&quot;
suffix:semicolon
id|hook_arg2
op_assign
l_string|&quot;&quot;
suffix:semicolon
)brace
id|s-&gt;fp
op_assign
id|fopen
c_func
(paren
id|git_path
c_func
(paren
id|commit_editmsg
)paren
comma
l_string|&quot;w&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|s-&gt;fp
op_eq
l_int|NULL
)paren
id|die_errno
c_func
(paren
id|_
c_func
(paren
l_string|&quot;could not open &squot;%s&squot;&quot;
)paren
comma
id|git_path
c_func
(paren
id|commit_editmsg
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|clean_message_contents
)paren
id|stripspace
c_func
(paren
op_amp
id|sb
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|signoff
)paren
(brace
r_struct
id|strbuf
id|sob
op_assign
id|STRBUF_INIT
suffix:semicolon
r_int
id|i
suffix:semicolon
id|strbuf_addstr
c_func
(paren
op_amp
id|sob
comma
id|sign_off_header
)paren
suffix:semicolon
id|strbuf_addstr
c_func
(paren
op_amp
id|sob
comma
id|fmt_name
c_func
(paren
id|getenv
c_func
(paren
l_string|&quot;GIT_COMMITTER_NAME&quot;
)paren
comma
id|getenv
c_func
(paren
l_string|&quot;GIT_COMMITTER_EMAIL&quot;
)paren
)paren
)paren
suffix:semicolon
id|strbuf_addch
c_func
(paren
op_amp
id|sob
comma
l_char|&squot;&bslash;n&squot;
)paren
suffix:semicolon
r_for
c_loop
(paren
id|i
op_assign
id|sb.len
l_int|1
suffix:semicolon
id|i
OG
l_int|0
op_logical_and
id|sb.buf
(braket
id|i
l_int|1
)braket
op_ne
l_char|&squot;&bslash;n&squot;
suffix:semicolon
id|i
op_decrement
)paren
suffix:semicolon
multiline_comment|/* do nothing */
r_if
c_cond
(paren
id|prefixcmp
c_func
(paren
id|sb.buf
op_plus
id|i
comma
id|sob.buf
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|i
op_logical_or
op_logical_neg
id|ends_rfc2822_footer
c_func
(paren
op_amp
id|sb
)paren
)paren
id|strbuf_addch
c_func
(paren
op_amp
id|sb
comma
l_char|&squot;&bslash;n&squot;
)paren
suffix:semicolon
id|strbuf_addbuf
c_func
(paren
op_amp
id|sb
comma
op_amp
id|sob
)paren
suffix:semicolon
)brace
id|strbuf_release
c_func
(paren
op_amp
id|sob
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|fwrite
c_func
(paren
id|sb.buf
comma
l_int|1
comma
id|sb.len
comma
id|s-&gt;fp
)paren
OL
id|sb.len
)paren
id|die_errno
c_func
(paren
id|_
c_func
(paren
l_string|&quot;could not write commit template&quot;
)paren
)paren
suffix:semicolon
id|strbuf_release
c_func
(paren
op_amp
id|sb
)paren
suffix:semicolon
multiline_comment|/* This checks if committer ident is explicitly given */
id|strbuf_addstr
c_func
(paren
op_amp
id|committer_ident
comma
id|git_committer_info
c_func
(paren
l_int|0
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|use_editor
op_logical_and
id|include_status
)paren
(brace
r_char
op_star
id|ai_tmp
comma
op_star
id|ci_tmp
suffix:semicolon
r_if
c_cond
(paren
id|whence
op_ne
id|FROM_COMMIT
)paren
id|status_printf_ln
c_func
(paren
id|s
comma
id|GIT_COLOR_NORMAL
comma
id|_
c_func
(paren
l_string|&quot;&bslash;n&quot;
l_string|&quot;It looks like you may be committing a %s.&bslash;n&quot;
l_string|&quot;If this is not correct, please remove the file&bslash;n&quot;
l_string|&quot;&t;%s&bslash;n&quot;
l_string|&quot;and try again.&bslash;n&quot;
l_string|&quot;&quot;
)paren
comma
id|whence_s
c_func
(paren
)paren
comma
id|git_path
c_func
(paren
id|whence
op_eq
id|FROM_MERGE
ques
c_cond
l_string|&quot;MERGE_HEAD&quot;
suffix:colon
l_string|&quot;CHERRY_PICK_HEAD&quot;
)paren
)paren
suffix:semicolon
id|fprintf
c_func
(paren
id|s-&gt;fp
comma
l_string|&quot;&bslash;n&quot;
)paren
suffix:semicolon
id|status_printf
c_func
(paren
id|s
comma
id|GIT_COLOR_NORMAL
comma
id|_
c_func
(paren
l_string|&quot;Please enter the commit message for your changes.&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cleanup_mode
op_eq
id|CLEANUP_ALL
)paren
id|status_printf_more
c_func
(paren
id|s
comma
id|GIT_COLOR_NORMAL
comma
id|_
c_func
(paren
l_string|&quot; Lines starting&bslash;n&quot;
l_string|&quot;with &squot;#&squot; will be ignored, and an empty&quot;
l_string|&quot; message aborts the commit.&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_else
multiline_comment|/* CLEANUP_SPACE, that is. */
id|status_printf_more
c_func
(paren
id|s
comma
id|GIT_COLOR_NORMAL
comma
id|_
c_func
(paren
l_string|&quot; Lines starting&bslash;n&quot;
l_string|&quot;with &squot;#&squot; will be kept; you may remove them&quot;
l_string|&quot; yourself if you want to.&bslash;n&quot;
l_string|&quot;An empty message aborts the commit.&bslash;n&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|only_include_assumed
)paren
id|status_printf_ln
c_func
(paren
id|s
comma
id|GIT_COLOR_NORMAL
comma
l_string|&quot;%s&quot;
comma
id|only_include_assumed
)paren
suffix:semicolon
id|ai_tmp
op_assign
id|cut_ident_timestamp_part
c_func
(paren
id|author_ident-&gt;buf
)paren
suffix:semicolon
id|ci_tmp
op_assign
id|cut_ident_timestamp_part
c_func
(paren
id|committer_ident.buf
)paren
suffix:semicolon
r_if
c_cond
(paren
id|strcmp
c_func
(paren
id|author_ident-&gt;buf
comma
id|committer_ident.buf
)paren
)paren
id|status_printf_ln
c_func
(paren
id|s
comma
id|GIT_COLOR_NORMAL
comma
id|_
c_func
(paren
l_string|&quot;%s&quot;
l_string|&quot;Author:    %s&quot;
)paren
comma
id|ident_shown
op_increment
ques
c_cond
l_string|&quot;&quot;
suffix:colon
l_string|&quot;&bslash;n&quot;
comma
id|author_ident-&gt;buf
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|user_ident_sufficiently_given
c_func
(paren
)paren
)paren
id|status_printf_ln
c_func
(paren
id|s
comma
id|GIT_COLOR_NORMAL
comma
id|_
c_func
(paren
l_string|&quot;%s&quot;
l_string|&quot;Committer: %s&quot;
)paren
comma
id|ident_shown
op_increment
ques
c_cond
l_string|&quot;&quot;
suffix:colon
l_string|&quot;&bslash;n&quot;
comma
id|committer_ident.buf
)paren
suffix:semicolon
r_if
c_cond
(paren
id|ident_shown
)paren
id|status_printf_ln
c_func
(paren
id|s
comma
id|GIT_COLOR_NORMAL
comma
l_string|&quot;&quot;
)paren
suffix:semicolon
id|saved_color_setting
op_assign
id|s-&gt;use_color
suffix:semicolon
id|s-&gt;use_color
op_assign
l_int|0
suffix:semicolon
id|commitable
op_assign
id|run_status
c_func
(paren
id|s-&gt;fp
comma
id|index_file
comma
id|prefix
comma
l_int|1
comma
id|s
)paren
suffix:semicolon
id|s-&gt;use_color
op_assign
id|saved_color_setting
suffix:semicolon
op_star
id|ai_tmp
op_assign
l_char|&squot; &squot;
suffix:semicolon
op_star
id|ci_tmp
op_assign
l_char|&squot; &squot;
suffix:semicolon
)brace
r_else
(brace
r_int
r_char
id|sha1
(braket
l_int|20
)braket
suffix:semicolon
r_const
r_char
op_star
id|parent
op_assign
l_string|&quot;HEAD&quot;
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|active_nr
op_logical_and
id|read_cache
c_func
(paren
)paren
OL
l_int|0
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;Cannot read index&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|amend
)paren
id|parent
op_assign
l_string|&quot;HEAD^1&quot;
suffix:semicolon
r_if
c_cond
(paren
id|get_sha1
c_func
(paren
id|parent
comma
id|sha1
)paren
)paren
id|commitable
op_assign
op_logical_neg
op_logical_neg
id|active_nr
suffix:semicolon
r_else
id|commitable
op_assign
id|index_differs_from
c_func
(paren
id|parent
comma
l_int|0
)paren
suffix:semicolon
)brace
id|strbuf_release
c_func
(paren
op_amp
id|committer_ident
)paren
suffix:semicolon
id|fclose
c_func
(paren
id|s-&gt;fp
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * Reject an attempt to record a non-merge empty commit without&n;&t; * explicit --allow-empty. In the cherry-pick case, it may be&n;&t; * empty due to conflict resolution, which the user should okay.&n;&t; */
r_if
c_cond
(paren
op_logical_neg
id|commitable
op_logical_and
id|whence
op_ne
id|FROM_MERGE
op_logical_and
op_logical_neg
id|allow_empty
op_logical_and
op_logical_neg
(paren
id|amend
op_logical_and
id|is_a_merge
c_func
(paren
id|current_head
)paren
)paren
)paren
(brace
id|run_status
c_func
(paren
id|stdout
comma
id|index_file
comma
id|prefix
comma
l_int|0
comma
id|s
)paren
suffix:semicolon
r_if
c_cond
(paren
id|amend
)paren
id|fputs
c_func
(paren
id|_
c_func
(paren
id|empty_amend_advice
)paren
comma
id|stderr
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
id|whence
op_eq
id|FROM_CHERRY_PICK
)paren
id|fputs
c_func
(paren
id|_
c_func
(paren
id|empty_cherry_pick_advice
)paren
comma
id|stderr
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
multiline_comment|/*&n;&t; * Re-read the index as pre-commit hook could have updated it,&n;&t; * and write it out as a tree.  We must do this before we invoke&n;&t; * the editor and after we invoke run_status above.&n;&t; */
id|discard_cache
c_func
(paren
)paren
suffix:semicolon
id|read_cache_from
c_func
(paren
id|index_file
)paren
suffix:semicolon
r_if
c_cond
(paren
id|update_main_cache_tree
c_func
(paren
l_int|0
)paren
)paren
(brace
id|error
c_func
(paren
id|_
c_func
(paren
l_string|&quot;Error building trees&quot;
)paren
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|run_hook
c_func
(paren
id|index_file
comma
l_string|&quot;prepare-commit-msg&quot;
comma
id|git_path
c_func
(paren
id|commit_editmsg
)paren
comma
id|hook_arg1
comma
id|hook_arg2
comma
l_int|NULL
)paren
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|use_editor
)paren
(brace
r_char
id|index
(braket
id|PATH_MAX
)braket
suffix:semicolon
r_const
r_char
op_star
id|env
(braket
l_int|2
)braket
op_assign
(brace
l_int|NULL
)brace
suffix:semicolon
id|env
(braket
l_int|0
)braket
op_assign
id|index
suffix:semicolon
id|snprintf
c_func
(paren
id|index
comma
r_sizeof
(paren
id|index
)paren
comma
l_string|&quot;GIT_INDEX_FILE=%s&quot;
comma
id|index_file
)paren
suffix:semicolon
r_if
c_cond
(paren
id|launch_editor
c_func
(paren
id|git_path
c_func
(paren
id|commit_editmsg
)paren
comma
l_int|NULL
comma
id|env
)paren
)paren
(brace
id|fprintf
c_func
(paren
id|stderr
comma
id|_
c_func
(paren
l_string|&quot;Please supply the message using either -m or -F option.&bslash;n&quot;
)paren
)paren
suffix:semicolon
m_exit
(paren
l_int|1
)paren
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
op_logical_neg
id|no_verify
op_logical_and
id|run_hook
c_func
(paren
id|index_file
comma
l_string|&quot;commit-msg&quot;
comma
id|git_path
c_func
(paren
id|commit_editmsg
)paren
comma
l_int|NULL
)paren
)paren
(brace
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/*&n; * Find out if the message in the strbuf contains only whitespace and&n; * Signed-off-by lines.&n; */
DECL|function|message_is_empty
r_static
r_int
id|message_is_empty
c_func
(paren
r_struct
id|strbuf
op_star
id|sb
)paren
(brace
r_struct
id|strbuf
id|tmpl
op_assign
id|STRBUF_INIT
suffix:semicolon
r_const
r_char
op_star
id|nl
suffix:semicolon
r_int
id|eol
comma
id|i
comma
id|start
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
id|cleanup_mode
op_eq
id|CLEANUP_NONE
op_logical_and
id|sb-&gt;len
)paren
r_return
l_int|0
suffix:semicolon
multiline_comment|/* See if the template is just a prefix of the message. */
r_if
c_cond
(paren
id|template_file
op_logical_and
id|strbuf_read_file
c_func
(paren
op_amp
id|tmpl
comma
id|template_file
comma
l_int|0
)paren
OG
l_int|0
)paren
(brace
id|stripspace
c_func
(paren
op_amp
id|tmpl
comma
id|cleanup_mode
op_eq
id|CLEANUP_ALL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|start
op_plus
id|tmpl.len
op_le
id|sb-&gt;len
op_logical_and
id|memcmp
c_func
(paren
id|tmpl.buf
comma
id|sb-&gt;buf
op_plus
id|start
comma
id|tmpl.len
)paren
op_eq
l_int|0
)paren
id|start
op_add_assign
id|tmpl.len
suffix:semicolon
)brace
id|strbuf_release
c_func
(paren
op_amp
id|tmpl
)paren
suffix:semicolon
multiline_comment|/* Check if the rest is just whitespace and Signed-of-by&squot;s. */
r_for
c_loop
(paren
id|i
op_assign
id|start
suffix:semicolon
id|i
OL
id|sb-&gt;len
suffix:semicolon
id|i
op_increment
)paren
(brace
id|nl
op_assign
id|memchr
c_func
(paren
id|sb-&gt;buf
op_plus
id|i
comma
l_char|&squot;&bslash;n&squot;
comma
id|sb-&gt;len
id|i
)paren
suffix:semicolon
r_if
c_cond
(paren
id|nl
)paren
id|eol
op_assign
id|nl
id|sb-&gt;buf
suffix:semicolon
r_else
id|eol
op_assign
id|sb-&gt;len
suffix:semicolon
r_if
c_cond
(paren
id|strlen
c_func
(paren
id|sign_off_header
)paren
op_le
id|eol
id|i
op_logical_and
op_logical_neg
id|prefixcmp
c_func
(paren
id|sb-&gt;buf
op_plus
id|i
comma
id|sign_off_header
)paren
)paren
(brace
id|i
op_assign
id|eol
suffix:semicolon
r_continue
suffix:semicolon
)brace
r_while
c_loop
(paren
id|i
OL
id|eol
)paren
r_if
c_cond
(paren
op_logical_neg
id|isspace
c_func
(paren
id|sb-&gt;buf
(braket
id|i
op_increment
)braket
)paren
)paren
r_return
l_int|0
suffix:semicolon
)brace
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|find_author_by_nickname
r_static
r_const
r_char
op_star
id|find_author_by_nickname
c_func
(paren
r_const
r_char
op_star
id|name
)paren
(brace
r_struct
id|rev_info
id|revs
suffix:semicolon
r_struct
id|commit
op_star
id|commit
suffix:semicolon
r_struct
id|strbuf
id|buf
op_assign
id|STRBUF_INIT
suffix:semicolon
r_const
r_char
op_star
id|av
(braket
l_int|20
)braket
suffix:semicolon
r_int
id|ac
op_assign
l_int|0
suffix:semicolon
id|init_revisions
c_func
(paren
op_amp
id|revs
comma
l_int|NULL
)paren
suffix:semicolon
id|strbuf_addf
c_func
(paren
op_amp
id|buf
comma
l_string|&quot;--author=%s&quot;
comma
id|name
)paren
suffix:semicolon
id|av
(braket
op_increment
id|ac
)braket
op_assign
l_string|&quot;--all&quot;
suffix:semicolon
id|av
(braket
op_increment
id|ac
)braket
op_assign
l_string|&quot;-i&quot;
suffix:semicolon
id|av
(braket
op_increment
id|ac
)braket
op_assign
id|buf.buf
suffix:semicolon
id|av
(braket
op_increment
id|ac
)braket
op_assign
l_int|NULL
suffix:semicolon
id|setup_revisions
c_func
(paren
id|ac
comma
id|av
comma
op_amp
id|revs
comma
l_int|NULL
)paren
suffix:semicolon
id|prepare_revision_walk
c_func
(paren
op_amp
id|revs
)paren
suffix:semicolon
id|commit
op_assign
id|get_revision
c_func
(paren
op_amp
id|revs
)paren
suffix:semicolon
r_if
c_cond
(paren
id|commit
)paren
(brace
r_struct
id|pretty_print_context
id|ctx
op_assign
(brace
l_int|0
)brace
suffix:semicolon
id|ctx.date_mode
op_assign
id|DATE_NORMAL
suffix:semicolon
id|strbuf_release
c_func
(paren
op_amp
id|buf
)paren
suffix:semicolon
id|format_commit_message
c_func
(paren
id|commit
comma
l_string|&quot;%an &lt;%ae&gt;&quot;
comma
op_amp
id|buf
comma
op_amp
id|ctx
)paren
suffix:semicolon
r_return
id|strbuf_detach
c_func
(paren
op_amp
id|buf
comma
l_int|NULL
)paren
suffix:semicolon
)brace
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;No existing author found with &squot;%s&squot;&quot;
)paren
comma
id|name
)paren
suffix:semicolon
)brace
DECL|function|handle_untracked_files_arg
r_static
r_void
id|handle_untracked_files_arg
c_func
(paren
r_struct
id|wt_status
op_star
id|s
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|untracked_files_arg
)paren
suffix:semicolon
multiline_comment|/* default already initialized */
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|untracked_files_arg
comma
l_string|&quot;no&quot;
)paren
)paren
id|s-&gt;show_untracked_files
op_assign
id|SHOW_NO_UNTRACKED_FILES
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|untracked_files_arg
comma
l_string|&quot;normal&quot;
)paren
)paren
id|s-&gt;show_untracked_files
op_assign
id|SHOW_NORMAL_UNTRACKED_FILES
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|untracked_files_arg
comma
l_string|&quot;all&quot;
)paren
)paren
id|s-&gt;show_untracked_files
op_assign
id|SHOW_ALL_UNTRACKED_FILES
suffix:semicolon
r_else
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;Invalid untracked files mode &squot;%s&squot;&quot;
)paren
comma
id|untracked_files_arg
)paren
suffix:semicolon
)brace
DECL|function|read_commit_message
r_static
r_const
r_char
op_star
id|read_commit_message
c_func
(paren
r_const
r_char
op_star
id|name
)paren
(brace
r_const
r_char
op_star
id|out_enc
comma
op_star
id|out
suffix:semicolon
r_struct
id|commit
op_star
id|commit
suffix:semicolon
id|commit
op_assign
id|lookup_commit_reference_by_name
c_func
(paren
id|name
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|commit
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;could not lookup commit %s&quot;
)paren
comma
id|name
)paren
suffix:semicolon
id|out_enc
op_assign
id|get_commit_output_encoding
c_func
(paren
)paren
suffix:semicolon
id|out
op_assign
id|logmsg_reencode
c_func
(paren
id|commit
comma
id|out_enc
)paren
suffix:semicolon
multiline_comment|/*&n;&t; * If we failed to reencode the buffer, just copy it&n;&t; * byte for byte so the user can try to fix it up.&n;&t; * This also handles the case where input and output&n;&t; * encodings are identical.&n;&t; */
r_if
c_cond
(paren
id|out
op_eq
l_int|NULL
)paren
id|out
op_assign
id|xstrdup
c_func
(paren
id|commit-&gt;buffer
)paren
suffix:semicolon
r_return
id|out
suffix:semicolon
)brace
DECL|function|parse_and_validate_options
r_static
r_int
id|parse_and_validate_options
c_func
(paren
r_int
id|argc
comma
r_const
r_char
op_star
id|argv
(braket
)braket
comma
r_const
r_char
op_star
r_const
id|usage
(braket
)braket
comma
r_const
r_char
op_star
id|prefix
comma
r_struct
id|commit
op_star
id|current_head
comma
r_struct
id|wt_status
op_star
id|s
)paren
(brace
r_int
id|f
op_assign
l_int|0
suffix:semicolon
id|argc
op_assign
id|parse_options
c_func
(paren
id|argc
comma
id|argv
comma
id|prefix
comma
id|builtin_commit_options
comma
id|usage
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|force_author
op_logical_and
op_logical_neg
id|strchr
c_func
(paren
id|force_author
comma
l_char|&squot;&gt;&squot;
)paren
)paren
id|force_author
op_assign
id|find_author_by_nickname
c_func
(paren
id|force_author
)paren
suffix:semicolon
r_if
c_cond
(paren
id|force_author
op_logical_and
id|renew_authorship
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;Using both --reset-author and --author does not make sense&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|logfile
op_logical_or
id|message.len
op_logical_or
id|use_message
op_logical_or
id|fixup_message
)paren
id|use_editor
op_assign
l_int|0
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_le
id|edit_flag
)paren
id|use_editor
op_assign
id|edit_flag
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|use_editor
)paren
id|setenv
c_func
(paren
l_string|&quot;GIT_EDITOR&quot;
comma
l_string|&quot;:&quot;
comma
l_int|1
)paren
suffix:semicolon
multiline_comment|/* Sanity check options */
r_if
c_cond
(paren
id|amend
op_logical_and
op_logical_neg
id|current_head
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;You have nothing to amend.&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|amend
op_logical_and
id|whence
op_ne
id|FROM_COMMIT
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;You are in the middle of a %s -- cannot amend.&quot;
)paren
comma
id|whence_s
c_func
(paren
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fixup_message
op_logical_and
id|squash_message
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;Options --squash and --fixup cannot be used together&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|use_message
)paren
id|f
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|edit_message
)paren
id|f
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|fixup_message
)paren
id|f
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|logfile
)paren
id|f
op_increment
suffix:semicolon
r_if
c_cond
(paren
id|f
OG
l_int|1
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;Only one of -c/-C/-F/--fixup can be used.&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|message.len
op_logical_and
id|f
OG
l_int|0
)paren
id|die
c_func
(paren
(paren
id|_
c_func
(paren
l_string|&quot;Option -m cannot be combined with -c/-C/-F/--fixup.&quot;
)paren
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|edit_message
)paren
id|use_message
op_assign
id|edit_message
suffix:semicolon
r_if
c_cond
(paren
id|amend
op_logical_and
op_logical_neg
id|use_message
op_logical_and
op_logical_neg
id|fixup_message
)paren
id|use_message
op_assign
l_string|&quot;HEAD&quot;
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|use_message
op_logical_and
id|whence
op_ne
id|FROM_CHERRY_PICK
op_logical_and
id|renew_authorship
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;--reset-author can be used only with -C, -c or --amend.&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|use_message
)paren
(brace
id|use_message_buffer
op_assign
id|read_commit_message
c_func
(paren
id|use_message
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|renew_authorship
)paren
(brace
id|author_message
op_assign
id|use_message
suffix:semicolon
id|author_message_buffer
op_assign
id|use_message_buffer
suffix:semicolon
)brace
)brace
r_if
c_cond
(paren
id|whence
op_eq
id|FROM_CHERRY_PICK
op_logical_and
op_logical_neg
id|renew_authorship
)paren
(brace
id|author_message
op_assign
l_string|&quot;CHERRY_PICK_HEAD&quot;
suffix:semicolon
id|author_message_buffer
op_assign
id|read_commit_message
c_func
(paren
id|author_message
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|patch_interactive
)paren
id|interactive
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
op_logical_neg
id|also
op_plus
op_logical_neg
op_logical_neg
id|only
op_plus
op_logical_neg
op_logical_neg
id|all
op_plus
op_logical_neg
op_logical_neg
id|interactive
OG
l_int|1
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;Only one of --include/--only/--all/--interactive/--patch can be used.&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|argc
op_eq
l_int|0
op_logical_and
(paren
id|also
op_logical_or
(paren
id|only
op_logical_and
op_logical_neg
id|amend
)paren
)paren
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;No paths with --include/--only does not make sense.&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|argc
op_eq
l_int|0
op_logical_and
id|only
op_logical_and
id|amend
)paren
id|only_include_assumed
op_assign
id|_
c_func
(paren
l_string|&quot;Clever... amending the last one with dirty index.&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|argc
OG
l_int|0
op_logical_and
op_logical_neg
id|also
op_logical_and
op_logical_neg
id|only
)paren
id|only_include_assumed
op_assign
id|_
c_func
(paren
l_string|&quot;Explicit paths specified without -i nor -o; assuming --only paths...&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|cleanup_arg
op_logical_or
op_logical_neg
id|strcmp
c_func
(paren
id|cleanup_arg
comma
l_string|&quot;default&quot;
)paren
)paren
id|cleanup_mode
op_assign
id|use_editor
ques
c_cond
id|CLEANUP_ALL
suffix:colon
id|CLEANUP_SPACE
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|cleanup_arg
comma
l_string|&quot;verbatim&quot;
)paren
)paren
id|cleanup_mode
op_assign
id|CLEANUP_NONE
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|cleanup_arg
comma
l_string|&quot;whitespace&quot;
)paren
)paren
id|cleanup_mode
op_assign
id|CLEANUP_SPACE
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|cleanup_arg
comma
l_string|&quot;strip&quot;
)paren
)paren
id|cleanup_mode
op_assign
id|CLEANUP_ALL
suffix:semicolon
r_else
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;Invalid cleanup mode %s&quot;
)paren
comma
id|cleanup_arg
)paren
suffix:semicolon
id|handle_untracked_files_arg
c_func
(paren
id|s
)paren
suffix:semicolon
r_if
c_cond
(paren
id|all
op_logical_and
id|argc
OG
l_int|0
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;Paths with -a does not make sense.&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|null_termination
op_logical_and
id|status_format
op_eq
id|STATUS_FORMAT_LONG
)paren
id|status_format
op_assign
id|STATUS_FORMAT_PORCELAIN
suffix:semicolon
r_if
c_cond
(paren
id|status_format
op_ne
id|STATUS_FORMAT_LONG
)paren
id|dry_run
op_assign
l_int|1
suffix:semicolon
r_return
id|argc
suffix:semicolon
)brace
DECL|function|dry_run_commit
r_static
r_int
id|dry_run_commit
c_func
(paren
r_int
id|argc
comma
r_const
r_char
op_star
op_star
id|argv
comma
r_const
r_char
op_star
id|prefix
comma
r_const
r_struct
id|commit
op_star
id|current_head
comma
r_struct
id|wt_status
op_star
id|s
)paren
(brace
r_int
id|commitable
suffix:semicolon
r_const
r_char
op_star
id|index_file
suffix:semicolon
id|index_file
op_assign
id|prepare_index
c_func
(paren
id|argc
comma
id|argv
comma
id|prefix
comma
id|current_head
comma
l_int|1
)paren
suffix:semicolon
id|commitable
op_assign
id|run_status
c_func
(paren
id|stdout
comma
id|index_file
comma
id|prefix
comma
l_int|0
comma
id|s
)paren
suffix:semicolon
id|rollback_index_files
c_func
(paren
)paren
suffix:semicolon
r_return
id|commitable
ques
c_cond
l_int|0
suffix:colon
l_int|1
suffix:semicolon
)brace
DECL|function|parse_status_slot
r_static
r_int
id|parse_status_slot
c_func
(paren
r_const
r_char
op_star
id|var
comma
r_int
id|offset
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|strcasecmp
c_func
(paren
id|var
op_plus
id|offset
comma
l_string|&quot;header&quot;
)paren
)paren
r_return
id|WT_STATUS_HEADER
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcasecmp
c_func
(paren
id|var
op_plus
id|offset
comma
l_string|&quot;branch&quot;
)paren
)paren
r_return
id|WT_STATUS_ONBRANCH
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcasecmp
c_func
(paren
id|var
op_plus
id|offset
comma
l_string|&quot;updated&quot;
)paren
op_logical_or
op_logical_neg
id|strcasecmp
c_func
(paren
id|var
op_plus
id|offset
comma
l_string|&quot;added&quot;
)paren
)paren
r_return
id|WT_STATUS_UPDATED
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcasecmp
c_func
(paren
id|var
op_plus
id|offset
comma
l_string|&quot;changed&quot;
)paren
)paren
r_return
id|WT_STATUS_CHANGED
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcasecmp
c_func
(paren
id|var
op_plus
id|offset
comma
l_string|&quot;untracked&quot;
)paren
)paren
r_return
id|WT_STATUS_UNTRACKED
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcasecmp
c_func
(paren
id|var
op_plus
id|offset
comma
l_string|&quot;nobranch&quot;
)paren
)paren
r_return
id|WT_STATUS_NOBRANCH
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcasecmp
c_func
(paren
id|var
op_plus
id|offset
comma
l_string|&quot;unmerged&quot;
)paren
)paren
r_return
id|WT_STATUS_UNMERGED
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
DECL|function|git_status_config
r_static
r_int
id|git_status_config
c_func
(paren
r_const
r_char
op_star
id|k
comma
r_const
r_char
op_star
id|v
comma
r_void
op_star
id|cb
)paren
(brace
r_struct
id|wt_status
op_star
id|s
op_assign
id|cb
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|k
comma
l_string|&quot;status.submodulesummary&quot;
)paren
)paren
(brace
r_int
id|is_bool
suffix:semicolon
id|s-&gt;submodule_summary
op_assign
id|git_config_bool_or_int
c_func
(paren
id|k
comma
id|v
comma
op_amp
id|is_bool
)paren
suffix:semicolon
r_if
c_cond
(paren
id|is_bool
op_logical_and
id|s-&gt;submodule_summary
)paren
id|s-&gt;submodule_summary
op_assign
l_int|1
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|k
comma
l_string|&quot;status.color&quot;
)paren
op_logical_or
op_logical_neg
id|strcmp
c_func
(paren
id|k
comma
l_string|&quot;color.status&quot;
)paren
)paren
(brace
id|s-&gt;use_color
op_assign
id|git_config_colorbool
c_func
(paren
id|k
comma
id|v
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|prefixcmp
c_func
(paren
id|k
comma
l_string|&quot;status.color.&quot;
)paren
op_logical_or
op_logical_neg
id|prefixcmp
c_func
(paren
id|k
comma
l_string|&quot;color.status.&quot;
)paren
)paren
(brace
r_int
id|slot
op_assign
id|parse_status_slot
c_func
(paren
id|k
comma
l_int|13
)paren
suffix:semicolon
r_if
c_cond
(paren
id|slot
OL
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|v
)paren
r_return
id|config_error_nonbool
c_func
(paren
id|k
)paren
suffix:semicolon
id|color_parse
c_func
(paren
id|v
comma
id|k
comma
id|s-&gt;color_palette
(braket
id|slot
)braket
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|k
comma
l_string|&quot;status.relativepaths&quot;
)paren
)paren
(brace
id|s-&gt;relative_paths
op_assign
id|git_config_bool
c_func
(paren
id|k
comma
id|v
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|k
comma
l_string|&quot;status.showuntrackedfiles&quot;
)paren
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|v
)paren
r_return
id|config_error_nonbool
c_func
(paren
id|k
)paren
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|v
comma
l_string|&quot;no&quot;
)paren
)paren
id|s-&gt;show_untracked_files
op_assign
id|SHOW_NO_UNTRACKED_FILES
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|v
comma
l_string|&quot;normal&quot;
)paren
)paren
id|s-&gt;show_untracked_files
op_assign
id|SHOW_NORMAL_UNTRACKED_FILES
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|v
comma
l_string|&quot;all&quot;
)paren
)paren
id|s-&gt;show_untracked_files
op_assign
id|SHOW_ALL_UNTRACKED_FILES
suffix:semicolon
r_else
r_return
id|error
c_func
(paren
id|_
c_func
(paren
l_string|&quot;Invalid untracked files mode &squot;%s&squot;&quot;
)paren
comma
id|v
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
r_return
id|git_diff_ui_config
c_func
(paren
id|k
comma
id|v
comma
l_int|NULL
)paren
suffix:semicolon
)brace
DECL|function|cmd_status
r_int
id|cmd_status
c_func
(paren
r_int
id|argc
comma
r_const
r_char
op_star
op_star
id|argv
comma
r_const
r_char
op_star
id|prefix
)paren
(brace
r_struct
id|wt_status
id|s
suffix:semicolon
r_int
id|fd
suffix:semicolon
r_int
r_char
id|sha1
(braket
l_int|20
)braket
suffix:semicolon
r_static
r_struct
id|option
id|builtin_status_options
(braket
)braket
op_assign
(brace
id|OPT__VERBOSE
c_func
(paren
op_amp
id|verbose
comma
l_string|&quot;be verbose&quot;
)paren
comma
id|OPT_SET_INT
c_func
(paren
l_char|&squot;s&squot;
comma
l_string|&quot;short&quot;
comma
op_amp
id|status_format
comma
l_string|&quot;show status concisely&quot;
comma
id|STATUS_FORMAT_SHORT
)paren
comma
id|OPT_BOOLEAN
c_func
(paren
l_char|&squot;b&squot;
comma
l_string|&quot;branch&quot;
comma
op_amp
id|status_show_branch
comma
l_string|&quot;show branch information&quot;
)paren
comma
id|OPT_SET_INT
c_func
(paren
l_int|0
comma
l_string|&quot;porcelain&quot;
comma
op_amp
id|status_format
comma
l_string|&quot;machine-readable output&quot;
comma
id|STATUS_FORMAT_PORCELAIN
)paren
comma
id|OPT_BOOLEAN
c_func
(paren
l_char|&squot;z&squot;
comma
l_string|&quot;null&quot;
comma
op_amp
id|null_termination
comma
l_string|&quot;terminate entries with NUL&quot;
)paren
comma
(brace
id|OPTION_STRING
comma
l_char|&squot;u&squot;
comma
l_string|&quot;untracked-files&quot;
comma
op_amp
id|untracked_files_arg
comma
l_string|&quot;mode&quot;
comma
l_string|&quot;show untracked files, optional modes: all, normal, no. (Default: all)&quot;
comma
id|PARSE_OPT_OPTARG
comma
l_int|NULL
comma
(paren
r_intptr
)paren
l_string|&quot;all&quot;
)brace
comma
id|OPT_BOOLEAN
c_func
(paren
l_int|0
comma
l_string|&quot;ignored&quot;
comma
op_amp
id|show_ignored_in_status
comma
l_string|&quot;show ignored files&quot;
)paren
comma
(brace
id|OPTION_STRING
comma
l_int|0
comma
l_string|&quot;ignore-submodules&quot;
comma
op_amp
id|ignore_submodule_arg
comma
l_string|&quot;when&quot;
comma
l_string|&quot;ignore changes to submodules, optional when: all, dirty, untracked. (Default: all)&quot;
comma
id|PARSE_OPT_OPTARG
comma
l_int|NULL
comma
(paren
r_intptr
)paren
l_string|&quot;all&quot;
)brace
comma
id|OPT_END
c_func
(paren
)paren
comma
)brace
suffix:semicolon
r_if
c_cond
(paren
id|argc
op_eq
l_int|2
op_logical_and
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;-h&quot;
)paren
)paren
id|usage_with_options
c_func
(paren
id|builtin_status_usage
comma
id|builtin_status_options
)paren
suffix:semicolon
id|wt_status_prepare
c_func
(paren
op_amp
id|s
)paren
suffix:semicolon
id|gitmodules_config
c_func
(paren
)paren
suffix:semicolon
id|git_config
c_func
(paren
id|git_status_config
comma
op_amp
id|s
)paren
suffix:semicolon
id|determine_whence
c_func
(paren
op_amp
id|s
)paren
suffix:semicolon
id|argc
op_assign
id|parse_options
c_func
(paren
id|argc
comma
id|argv
comma
id|prefix
comma
id|builtin_status_options
comma
id|builtin_status_usage
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
id|null_termination
op_logical_and
id|status_format
op_eq
id|STATUS_FORMAT_LONG
)paren
id|status_format
op_assign
id|STATUS_FORMAT_PORCELAIN
suffix:semicolon
id|handle_untracked_files_arg
c_func
(paren
op_amp
id|s
)paren
suffix:semicolon
r_if
c_cond
(paren
id|show_ignored_in_status
)paren
id|s.show_ignored_files
op_assign
l_int|1
suffix:semicolon
r_if
c_cond
(paren
op_star
id|argv
)paren
id|s.pathspec
op_assign
id|get_pathspec
c_func
(paren
id|prefix
comma
id|argv
)paren
suffix:semicolon
id|read_cache_preload
c_func
(paren
id|s.pathspec
)paren
suffix:semicolon
id|refresh_index
c_func
(paren
op_amp
id|the_index
comma
id|REFRESH_QUIET
op_or
id|REFRESH_UNMERGED
comma
id|s.pathspec
comma
l_int|NULL
comma
l_int|NULL
)paren
suffix:semicolon
id|fd
op_assign
id|hold_locked_index
c_func
(paren
op_amp
id|index_lock
comma
l_int|0
)paren
suffix:semicolon
r_if
c_cond
(paren
l_int|0
op_le
id|fd
)paren
id|update_index_if_able
c_func
(paren
op_amp
id|the_index
comma
op_amp
id|index_lock
)paren
suffix:semicolon
id|s.is_initial
op_assign
id|get_sha1
c_func
(paren
id|s.reference
comma
id|sha1
)paren
ques
c_cond
l_int|1
suffix:colon
l_int|0
suffix:semicolon
id|s.ignore_submodule_arg
op_assign
id|ignore_submodule_arg
suffix:semicolon
id|wt_status_collect
c_func
(paren
op_amp
id|s
)paren
suffix:semicolon
r_if
c_cond
(paren
id|s.relative_paths
)paren
id|s.prefix
op_assign
id|prefix
suffix:semicolon
r_switch
c_cond
(paren
id|status_format
)paren
(brace
r_case
id|STATUS_FORMAT_SHORT
suffix:colon
id|wt_shortstatus_print
c_func
(paren
op_amp
id|s
comma
id|null_termination
comma
id|status_show_branch
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|STATUS_FORMAT_PORCELAIN
suffix:colon
id|wt_porcelain_print
c_func
(paren
op_amp
id|s
comma
id|null_termination
)paren
suffix:semicolon
r_break
suffix:semicolon
r_case
id|STATUS_FORMAT_LONG
suffix:colon
id|s.verbose
op_assign
id|verbose
suffix:semicolon
id|s.ignore_submodule_arg
op_assign
id|ignore_submodule_arg
suffix:semicolon
id|wt_status_print
c_func
(paren
op_amp
id|s
)paren
suffix:semicolon
r_break
suffix:semicolon
)brace
r_return
l_int|0
suffix:semicolon
)brace
DECL|function|print_summary
r_static
r_void
id|print_summary
c_func
(paren
r_const
r_char
op_star
id|prefix
comma
r_const
r_int
r_char
op_star
id|sha1
comma
r_int
id|initial_commit
)paren
(brace
r_struct
id|rev_info
id|rev
suffix:semicolon
r_struct
id|commit
op_star
id|commit
suffix:semicolon
r_struct
id|strbuf
id|format
op_assign
id|STRBUF_INIT
suffix:semicolon
r_int
r_char
id|junk_sha1
(braket
l_int|20
)braket
suffix:semicolon
r_const
r_char
op_star
id|head
suffix:semicolon
r_struct
id|pretty_print_context
id|pctx
op_assign
(brace
l_int|0
)brace
suffix:semicolon
r_struct
id|strbuf
id|author_ident
op_assign
id|STRBUF_INIT
suffix:semicolon
r_struct
id|strbuf
id|committer_ident
op_assign
id|STRBUF_INIT
suffix:semicolon
id|commit
op_assign
id|lookup_commit
c_func
(paren
id|sha1
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|commit
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;couldn&squot;t look up newly created commit&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|commit
op_logical_or
id|parse_commit
c_func
(paren
id|commit
)paren
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;could not parse newly created commit&quot;
)paren
)paren
suffix:semicolon
id|strbuf_addstr
c_func
(paren
op_amp
id|format
comma
l_string|&quot;format:%h] %s&quot;
)paren
suffix:semicolon
id|format_commit_message
c_func
(paren
id|commit
comma
l_string|&quot;%an &lt;%ae&gt;&quot;
comma
op_amp
id|author_ident
comma
op_amp
id|pctx
)paren
suffix:semicolon
id|format_commit_message
c_func
(paren
id|commit
comma
l_string|&quot;%cn &lt;%ce&gt;&quot;
comma
op_amp
id|committer_ident
comma
op_amp
id|pctx
)paren
suffix:semicolon
r_if
c_cond
(paren
id|strbuf_cmp
c_func
(paren
op_amp
id|author_ident
comma
op_amp
id|committer_ident
)paren
)paren
(brace
id|strbuf_addstr
c_func
(paren
op_amp
id|format
comma
l_string|&quot;&bslash;n Author: &quot;
)paren
suffix:semicolon
id|strbuf_addbuf_percentquote
c_func
(paren
op_amp
id|format
comma
op_amp
id|author_ident
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|user_ident_sufficiently_given
c_func
(paren
)paren
)paren
(brace
id|strbuf_addstr
c_func
(paren
op_amp
id|format
comma
l_string|&quot;&bslash;n Committer: &quot;
)paren
suffix:semicolon
id|strbuf_addbuf_percentquote
c_func
(paren
op_amp
id|format
comma
op_amp
id|committer_ident
)paren
suffix:semicolon
r_if
c_cond
(paren
id|advice_implicit_identity
)paren
(brace
id|strbuf_addch
c_func
(paren
op_amp
id|format
comma
l_char|&squot;&bslash;n&squot;
)paren
suffix:semicolon
id|strbuf_addstr
c_func
(paren
op_amp
id|format
comma
id|_
c_func
(paren
id|implicit_ident_advice
)paren
)paren
suffix:semicolon
)brace
)brace
id|strbuf_release
c_func
(paren
op_amp
id|author_ident
)paren
suffix:semicolon
id|strbuf_release
c_func
(paren
op_amp
id|committer_ident
)paren
suffix:semicolon
id|init_revisions
c_func
(paren
op_amp
id|rev
comma
id|prefix
)paren
suffix:semicolon
id|setup_revisions
c_func
(paren
l_int|0
comma
l_int|NULL
comma
op_amp
id|rev
comma
l_int|NULL
)paren
suffix:semicolon
id|rev.diff
op_assign
l_int|1
suffix:semicolon
id|rev.diffopt.output_format
op_assign
id|DIFF_FORMAT_SHORTSTAT
op_or
id|DIFF_FORMAT_SUMMARY
suffix:semicolon
id|rev.verbose_header
op_assign
l_int|1
suffix:semicolon
id|rev.show_root_diff
op_assign
l_int|1
suffix:semicolon
id|get_commit_format
c_func
(paren
id|format.buf
comma
op_amp
id|rev
)paren
suffix:semicolon
id|rev.always_show_header
op_assign
l_int|0
suffix:semicolon
id|rev.diffopt.detect_rename
op_assign
l_int|1
suffix:semicolon
id|rev.diffopt.break_opt
op_assign
l_int|0
suffix:semicolon
id|diff_setup_done
c_func
(paren
op_amp
id|rev.diffopt
)paren
suffix:semicolon
id|head
op_assign
id|resolve_ref_unsafe
c_func
(paren
l_string|&quot;HEAD&quot;
comma
id|junk_sha1
comma
l_int|0
comma
l_int|NULL
)paren
suffix:semicolon
id|printf
c_func
(paren
l_string|&quot;[%s%s &quot;
comma
op_logical_neg
id|prefixcmp
c_func
(paren
id|head
comma
l_string|&quot;refs/heads/&quot;
)paren
ques
c_cond
id|head
op_plus
l_int|11
suffix:colon
op_logical_neg
id|strcmp
c_func
(paren
id|head
comma
l_string|&quot;HEAD&quot;
)paren
ques
c_cond
id|_
c_func
(paren
l_string|&quot;detached HEAD&quot;
)paren
suffix:colon
id|head
comma
id|initial_commit
ques
c_cond
id|_
c_func
(paren
l_string|&quot; (root-commit)&quot;
)paren
suffix:colon
l_string|&quot;&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|log_tree_commit
c_func
(paren
op_amp
id|rev
comma
id|commit
)paren
)paren
(brace
id|rev.always_show_header
op_assign
l_int|1
suffix:semicolon
id|rev.use_terminator
op_assign
l_int|1
suffix:semicolon
id|log_tree_commit
c_func
(paren
op_amp
id|rev
comma
id|commit
)paren
suffix:semicolon
)brace
id|strbuf_release
c_func
(paren
op_amp
id|format
)paren
suffix:semicolon
)brace
DECL|function|git_commit_config
r_static
r_int
id|git_commit_config
c_func
(paren
r_const
r_char
op_star
id|k
comma
r_const
r_char
op_star
id|v
comma
r_void
op_star
id|cb
)paren
(brace
r_struct
id|wt_status
op_star
id|s
op_assign
id|cb
suffix:semicolon
r_int
id|status
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|k
comma
l_string|&quot;commit.template&quot;
)paren
)paren
r_return
id|git_config_pathname
c_func
(paren
op_amp
id|template_file
comma
id|k
comma
id|v
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|k
comma
l_string|&quot;commit.status&quot;
)paren
)paren
(brace
id|include_status
op_assign
id|git_config_bool
c_func
(paren
id|k
comma
id|v
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
id|status
op_assign
id|git_gpg_config
c_func
(paren
id|k
comma
id|v
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|status
)paren
r_return
id|status
suffix:semicolon
r_return
id|git_status_config
c_func
(paren
id|k
comma
id|v
comma
id|s
)paren
suffix:semicolon
)brace
DECL|variable|post_rewrite_hook
r_static
r_const
r_char
id|post_rewrite_hook
(braket
)braket
op_assign
l_string|&quot;hooks/post-rewrite&quot;
suffix:semicolon
DECL|function|run_rewrite_hook
r_static
r_int
id|run_rewrite_hook
c_func
(paren
r_const
r_int
r_char
op_star
id|oldsha1
comma
r_const
r_int
r_char
op_star
id|newsha1
)paren
(brace
multiline_comment|/* oldsha1 SP newsha1 LF NUL */
r_static
r_char
id|buf
(braket
l_int|2
op_star
l_int|40
op_plus
l_int|3
)braket
suffix:semicolon
r_struct
id|child_process
id|proc
suffix:semicolon
r_const
r_char
op_star
id|argv
(braket
l_int|3
)braket
suffix:semicolon
r_int
id|code
suffix:semicolon
r_int
id|n
suffix:semicolon
r_if
c_cond
(paren
id|access
c_func
(paren
id|git_path
c_func
(paren
id|post_rewrite_hook
)paren
comma
id|X_OK
)paren
OL
l_int|0
)paren
r_return
l_int|0
suffix:semicolon
id|argv
(braket
l_int|0
)braket
op_assign
id|git_path
c_func
(paren
id|post_rewrite_hook
)paren
suffix:semicolon
id|argv
(braket
l_int|1
)braket
op_assign
l_string|&quot;amend&quot;
suffix:semicolon
id|argv
(braket
l_int|2
)braket
op_assign
l_int|NULL
suffix:semicolon
id|memset
c_func
(paren
op_amp
id|proc
comma
l_int|0
comma
r_sizeof
(paren
id|proc
)paren
)paren
suffix:semicolon
id|proc.argv
op_assign
id|argv
suffix:semicolon
id|proc.in
op_assign
l_int|1
suffix:semicolon
id|proc.stdout_to_stderr
op_assign
l_int|1
suffix:semicolon
id|code
op_assign
id|start_command
c_func
(paren
op_amp
id|proc
)paren
suffix:semicolon
r_if
c_cond
(paren
id|code
)paren
r_return
id|code
suffix:semicolon
id|n
op_assign
id|snprintf
c_func
(paren
id|buf
comma
r_sizeof
(paren
id|buf
)paren
comma
l_string|&quot;%s %s&bslash;n&quot;
comma
id|sha1_to_hex
c_func
(paren
id|oldsha1
)paren
comma
id|sha1_to_hex
c_func
(paren
id|newsha1
)paren
)paren
suffix:semicolon
id|write_in_full
c_func
(paren
id|proc.in
comma
id|buf
comma
id|n
)paren
suffix:semicolon
id|close
c_func
(paren
id|proc.in
)paren
suffix:semicolon
r_return
id|finish_command
c_func
(paren
op_amp
id|proc
)paren
suffix:semicolon
)brace
DECL|function|cmd_commit
r_int
id|cmd_commit
c_func
(paren
r_int
id|argc
comma
r_const
r_char
op_star
op_star
id|argv
comma
r_const
r_char
op_star
id|prefix
)paren
(brace
r_struct
id|strbuf
id|sb
op_assign
id|STRBUF_INIT
suffix:semicolon
r_struct
id|strbuf
id|author_ident
op_assign
id|STRBUF_INIT
suffix:semicolon
r_const
r_char
op_star
id|index_file
comma
op_star
id|reflog_msg
suffix:semicolon
r_char
op_star
id|nl
comma
op_star
id|p
suffix:semicolon
r_int
r_char
id|sha1
(braket
l_int|20
)braket
suffix:semicolon
r_struct
id|ref_lock
op_star
id|ref_lock
suffix:semicolon
r_struct
id|commit_list
op_star
id|parents
op_assign
l_int|NULL
comma
op_star
op_star
id|pptr
op_assign
op_amp
id|parents
suffix:semicolon
r_struct
id|stat
id|statbuf
suffix:semicolon
r_int
id|allow_fast_forward
op_assign
l_int|1
suffix:semicolon
r_struct
id|wt_status
id|s
suffix:semicolon
r_struct
id|commit
op_star
id|current_head
op_assign
l_int|NULL
suffix:semicolon
r_struct
id|commit_extra_header
op_star
id|extra
op_assign
l_int|NULL
suffix:semicolon
r_if
c_cond
(paren
id|argc
op_eq
l_int|2
op_logical_and
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;-h&quot;
)paren
)paren
id|usage_with_options
c_func
(paren
id|builtin_commit_usage
comma
id|builtin_commit_options
)paren
suffix:semicolon
id|wt_status_prepare
c_func
(paren
op_amp
id|s
)paren
suffix:semicolon
id|git_config
c_func
(paren
id|git_commit_config
comma
op_amp
id|s
)paren
suffix:semicolon
id|determine_whence
c_func
(paren
op_amp
id|s
)paren
suffix:semicolon
r_if
c_cond
(paren
id|get_sha1
c_func
(paren
l_string|&quot;HEAD&quot;
comma
id|sha1
)paren
)paren
id|current_head
op_assign
l_int|NULL
suffix:semicolon
r_else
(brace
id|current_head
op_assign
id|lookup_commit_or_die
c_func
(paren
id|sha1
comma
l_string|&quot;HEAD&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|current_head
op_logical_or
id|parse_commit
c_func
(paren
id|current_head
)paren
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;could not parse HEAD commit&quot;
)paren
)paren
suffix:semicolon
)brace
id|argc
op_assign
id|parse_and_validate_options
c_func
(paren
id|argc
comma
id|argv
comma
id|builtin_commit_usage
comma
id|prefix
comma
id|current_head
comma
op_amp
id|s
)paren
suffix:semicolon
r_if
c_cond
(paren
id|dry_run
)paren
r_return
id|dry_run_commit
c_func
(paren
id|argc
comma
id|argv
comma
id|prefix
comma
id|current_head
comma
op_amp
id|s
)paren
suffix:semicolon
id|index_file
op_assign
id|prepare_index
c_func
(paren
id|argc
comma
id|argv
comma
id|prefix
comma
id|current_head
comma
l_int|0
)paren
suffix:semicolon
multiline_comment|/* Set up everything for writing the commit object.  This includes&n;&t;   running hooks, writing the trees, and interacting with the user.  */
r_if
c_cond
(paren
op_logical_neg
id|prepare_to_commit
c_func
(paren
id|index_file
comma
id|prefix
comma
id|current_head
comma
op_amp
id|s
comma
op_amp
id|author_ident
)paren
)paren
(brace
id|rollback_index_files
c_func
(paren
)paren
suffix:semicolon
r_return
l_int|1
suffix:semicolon
)brace
multiline_comment|/* Determine parents */
id|reflog_msg
op_assign
id|getenv
c_func
(paren
l_string|&quot;GIT_REFLOG_ACTION&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|current_head
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|reflog_msg
)paren
id|reflog_msg
op_assign
l_string|&quot;commit (initial)&quot;
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|amend
)paren
(brace
r_struct
id|commit_list
op_star
id|c
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|reflog_msg
)paren
id|reflog_msg
op_assign
l_string|&quot;commit (amend)&quot;
suffix:semicolon
r_for
c_loop
(paren
id|c
op_assign
id|current_head-&gt;parents
suffix:semicolon
id|c
suffix:semicolon
id|c
op_assign
id|c-&gt;next
)paren
id|pptr
op_assign
op_amp
id|commit_list_insert
c_func
(paren
id|c-&gt;item
comma
id|pptr
)paren
op_member_access_from_pointer
id|next
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
id|whence
op_eq
id|FROM_MERGE
)paren
(brace
r_struct
id|strbuf
id|m
op_assign
id|STRBUF_INIT
suffix:semicolon
id|FILE
op_star
id|fp
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|reflog_msg
)paren
id|reflog_msg
op_assign
l_string|&quot;commit (merge)&quot;
suffix:semicolon
id|pptr
op_assign
op_amp
id|commit_list_insert
c_func
(paren
id|current_head
comma
id|pptr
)paren
op_member_access_from_pointer
id|next
suffix:semicolon
id|fp
op_assign
id|fopen
c_func
(paren
id|git_path
c_func
(paren
l_string|&quot;MERGE_HEAD&quot;
)paren
comma
l_string|&quot;r&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|fp
op_eq
l_int|NULL
)paren
id|die_errno
c_func
(paren
id|_
c_func
(paren
l_string|&quot;could not open &squot;%s&squot; for reading&quot;
)paren
comma
id|git_path
c_func
(paren
l_string|&quot;MERGE_HEAD&quot;
)paren
)paren
suffix:semicolon
r_while
c_loop
(paren
id|strbuf_getline
c_func
(paren
op_amp
id|m
comma
id|fp
comma
l_char|&squot;&bslash;n&squot;
)paren
op_ne
id|EOF
)paren
(brace
r_struct
id|commit
op_star
id|parent
suffix:semicolon
id|parent
op_assign
id|get_merge_parent
c_func
(paren
id|m.buf
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|parent
)paren
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;Corrupt MERGE_HEAD file (%s)&quot;
)paren
comma
id|m.buf
)paren
suffix:semicolon
id|pptr
op_assign
op_amp
id|commit_list_insert
c_func
(paren
id|parent
comma
id|pptr
)paren
op_member_access_from_pointer
id|next
suffix:semicolon
)brace
id|fclose
c_func
(paren
id|fp
)paren
suffix:semicolon
id|strbuf_release
c_func
(paren
op_amp
id|m
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|stat
c_func
(paren
id|git_path
c_func
(paren
l_string|&quot;MERGE_MODE&quot;
)paren
comma
op_amp
id|statbuf
)paren
)paren
(brace
r_if
c_cond
(paren
id|strbuf_read_file
c_func
(paren
op_amp
id|sb
comma
id|git_path
c_func
(paren
l_string|&quot;MERGE_MODE&quot;
)paren
comma
l_int|0
)paren
OL
l_int|0
)paren
id|die_errno
c_func
(paren
id|_
c_func
(paren
l_string|&quot;could not read MERGE_MODE&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|sb.buf
comma
l_string|&quot;no-ff&quot;
)paren
)paren
id|allow_fast_forward
op_assign
l_int|0
suffix:semicolon
)brace
r_if
c_cond
(paren
id|allow_fast_forward
)paren
id|parents
op_assign
id|reduce_heads
c_func
(paren
id|parents
)paren
suffix:semicolon
)brace
r_else
(brace
r_if
c_cond
(paren
op_logical_neg
id|reflog_msg
)paren
id|reflog_msg
op_assign
(paren
id|whence
op_eq
id|FROM_CHERRY_PICK
)paren
ques
c_cond
l_string|&quot;commit (cherry-pick)&quot;
suffix:colon
l_string|&quot;commit&quot;
suffix:semicolon
id|pptr
op_assign
op_amp
id|commit_list_insert
c_func
(paren
id|current_head
comma
id|pptr
)paren
op_member_access_from_pointer
id|next
suffix:semicolon
)brace
multiline_comment|/* Finally, get the commit message */
id|strbuf_reset
c_func
(paren
op_amp
id|sb
)paren
suffix:semicolon
r_if
c_cond
(paren
id|strbuf_read_file
c_func
(paren
op_amp
id|sb
comma
id|git_path
c_func
(paren
id|commit_editmsg
)paren
comma
l_int|0
)paren
OL
l_int|0
)paren
(brace
r_int
id|saved_errno
op_assign
id|errno
suffix:semicolon
id|rollback_index_files
c_func
(paren
)paren
suffix:semicolon
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;could not read commit message: %s&quot;
)paren
comma
id|strerror
c_func
(paren
id|saved_errno
)paren
)paren
suffix:semicolon
)brace
multiline_comment|/* Truncate the message just before the diff, if any. */
r_if
c_cond
(paren
id|verbose
)paren
(brace
id|p
op_assign
id|strstr
c_func
(paren
id|sb.buf
comma
l_string|&quot;&bslash;ndiff --git &quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|p
op_ne
l_int|NULL
)paren
id|strbuf_setlen
c_func
(paren
op_amp
id|sb
comma
id|p
id|sb.buf
op_plus
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|cleanup_mode
op_ne
id|CLEANUP_NONE
)paren
id|stripspace
c_func
(paren
op_amp
id|sb
comma
id|cleanup_mode
op_eq
id|CLEANUP_ALL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|message_is_empty
c_func
(paren
op_amp
id|sb
)paren
op_logical_and
op_logical_neg
id|allow_empty_message
)paren
(brace
id|rollback_index_files
c_func
(paren
)paren
suffix:semicolon
id|fprintf
c_func
(paren
id|stderr
comma
id|_
c_func
(paren
l_string|&quot;Aborting commit due to empty commit message.&bslash;n&quot;
)paren
)paren
suffix:semicolon
m_exit
(paren
l_int|1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|amend
)paren
(brace
r_const
r_char
op_star
id|exclude_gpgsig
(braket
l_int|2
)braket
op_assign
(brace
l_string|&quot;gpgsig&quot;
comma
l_int|NULL
)brace
suffix:semicolon
id|extra
op_assign
id|read_commit_extra_headers
c_func
(paren
id|current_head
comma
id|exclude_gpgsig
)paren
suffix:semicolon
)brace
r_else
(brace
r_struct
id|commit_extra_header
op_star
op_star
id|tail
op_assign
op_amp
id|extra
suffix:semicolon
id|append_merge_tag_headers
c_func
(paren
id|parents
comma
op_amp
id|tail
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|commit_tree_extended
c_func
(paren
op_amp
id|sb
comma
id|active_cache_tree-&gt;sha1
comma
id|parents
comma
id|sha1
comma
id|author_ident.buf
comma
id|sign_commit
comma
id|extra
)paren
)paren
(brace
id|rollback_index_files
c_func
(paren
)paren
suffix:semicolon
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;failed to write commit object&quot;
)paren
)paren
suffix:semicolon
)brace
id|strbuf_release
c_func
(paren
op_amp
id|author_ident
)paren
suffix:semicolon
id|free_commit_extra_headers
c_func
(paren
id|extra
)paren
suffix:semicolon
id|ref_lock
op_assign
id|lock_any_ref_for_update
c_func
(paren
l_string|&quot;HEAD&quot;
comma
op_logical_neg
id|current_head
ques
c_cond
l_int|NULL
suffix:colon
id|current_head-&gt;object.sha1
comma
l_int|0
)paren
suffix:semicolon
id|nl
op_assign
id|strchr
c_func
(paren
id|sb.buf
comma
l_char|&squot;&bslash;n&squot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|nl
)paren
id|strbuf_setlen
c_func
(paren
op_amp
id|sb
comma
id|nl
op_plus
l_int|1
id|sb.buf
)paren
suffix:semicolon
r_else
id|strbuf_addch
c_func
(paren
op_amp
id|sb
comma
l_char|&squot;&bslash;n&squot;
)paren
suffix:semicolon
id|strbuf_insert
c_func
(paren
op_amp
id|sb
comma
l_int|0
comma
id|reflog_msg
comma
id|strlen
c_func
(paren
id|reflog_msg
)paren
)paren
suffix:semicolon
id|strbuf_insert
c_func
(paren
op_amp
id|sb
comma
id|strlen
c_func
(paren
id|reflog_msg
)paren
comma
l_string|&quot;: &quot;
comma
l_int|2
)paren
suffix:semicolon
r_if
c_cond
(paren
op_logical_neg
id|ref_lock
)paren
(brace
id|rollback_index_files
c_func
(paren
)paren
suffix:semicolon
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;cannot lock HEAD ref&quot;
)paren
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
id|write_ref_sha1
c_func
(paren
id|ref_lock
comma
id|sha1
comma
id|sb.buf
)paren
OL
l_int|0
)paren
(brace
id|rollback_index_files
c_func
(paren
)paren
suffix:semicolon
id|die
c_func
(paren
id|_
c_func
(paren
l_string|&quot;cannot update HEAD ref&quot;
)paren
)paren
suffix:semicolon
)brace
id|unlink
c_func
(paren
id|git_path
c_func
(paren
l_string|&quot;CHERRY_PICK_HEAD&quot;
)paren
)paren
suffix:semicolon
id|unlink
c_func
(paren
id|git_path
c_func
(paren
l_string|&quot;REVERT_HEAD&quot;
)paren
)paren
suffix:semicolon
id|unlink
c_func
(paren
id|git_path
c_func
(paren
l_string|&quot;MERGE_HEAD&quot;
)paren
)paren
suffix:semicolon
id|unlink
c_func
(paren
id|git_path
c_func
(paren
l_string|&quot;MERGE_MSG&quot;
)paren
)paren
suffix:semicolon
id|unlink
c_func
(paren
id|git_path
c_func
(paren
l_string|&quot;MERGE_MODE&quot;
)paren
)paren
suffix:semicolon
id|unlink
c_func
(paren
id|git_path
c_func
(paren
l_string|&quot;SQUASH_MSG&quot;
)paren
)paren
suffix:semicolon
r_if
c_cond
(paren
id|commit_index_files
c_func
(paren
)paren
)paren
id|die
(paren
id|_
c_func
(paren
l_string|&quot;Repository has been updated, but unable to write&bslash;n&quot;
l_string|&quot;new_index file. Check that disk is not full or quota is&bslash;n&quot;
l_string|&quot;not exceeded, and then &bslash;&quot;git reset HEAD&bslash;&quot; to recover.&quot;
)paren
)paren
suffix:semicolon
id|rerere
c_func
(paren
l_int|0
)paren
suffix:semicolon
id|run_hook
c_func
(paren
id|get_index_file
c_func
(paren
)paren
comma
l_string|&quot;post-commit&quot;
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|amend
op_logical_and
op_logical_neg
id|no_post_rewrite
)paren
(brace
r_struct
id|notes_rewrite_cfg
op_star
id|cfg
suffix:semicolon
id|cfg
op_assign
id|init_copy_notes_for_rewrite
c_func
(paren
l_string|&quot;amend&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|cfg
)paren
(brace
multiline_comment|/* we are amending, so current_head is not NULL */
id|copy_note_for_rewrite
c_func
(paren
id|cfg
comma
id|current_head-&gt;object.sha1
comma
id|sha1
)paren
suffix:semicolon
id|finish_copy_notes_for_rewrite
c_func
(paren
id|cfg
)paren
suffix:semicolon
)brace
id|run_rewrite_hook
c_func
(paren
id|current_head-&gt;object.sha1
comma
id|sha1
)paren
suffix:semicolon
)brace
r_if
c_cond
(paren
op_logical_neg
id|quiet
)paren
id|print_summary
c_func
(paren
id|prefix
comma
id|sha1
comma
op_logical_neg
id|current_head
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
eof
