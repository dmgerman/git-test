multiline_comment|/*&n; * Another stupid program, this one parsing the headers of an&n; * email to figure out authorship and subject&n; */
macro_line|#include &quot;cache.h&quot;
macro_line|#include &quot;builtin.h&quot;
macro_line|#include &quot;utf8.h&quot;
macro_line|#include &quot;strbuf.h&quot;
macro_line|#include &quot;mailinfo.h&quot;
DECL|variable|mailinfo_usage
r_static
r_const
r_char
id|mailinfo_usage
(braket
)braket
op_assign
l_string|&quot;git mailinfo [-k | -b] [-m | --message-id] [-u | --encoding=&lt;encoding&gt; | -n] [--scissors | --no-scissors] &lt;msg&gt; &lt;patch&gt; &lt; mail &gt;info&quot;
suffix:semicolon
DECL|function|cmd_mailinfo
r_int
id|cmd_mailinfo
c_func
(paren
r_int
id|argc
comma
r_const
r_char
op_star
op_star
id|argv
comma
r_const
r_char
op_star
id|prefix
)paren
(brace
r_const
r_char
op_star
id|def_charset
suffix:semicolon
r_struct
id|mailinfo
id|mi
suffix:semicolon
r_int
id|status
suffix:semicolon
multiline_comment|/* NEEDSWORK: might want to do the optional .git/ directory&n;&t; * discovery&n;&t; */
id|setup_mailinfo
c_func
(paren
op_amp
id|mi
)paren
suffix:semicolon
id|def_charset
op_assign
id|get_commit_output_encoding
c_func
(paren
)paren
suffix:semicolon
id|mi.metainfo_charset
op_assign
id|def_charset
suffix:semicolon
r_while
c_loop
(paren
l_int|1
OL
id|argc
op_logical_and
id|argv
(braket
l_int|1
)braket
(braket
l_int|0
)braket
op_eq
l_char|&squot;-&squot;
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;-k&quot;
)paren
)paren
id|mi.keep_subject
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;-b&quot;
)paren
)paren
id|mi.keep_non_patch_brackets_in_subject
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;-m&quot;
)paren
op_logical_or
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;--message-id&quot;
)paren
)paren
id|mi.add_message_id
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;-u&quot;
)paren
)paren
id|mi.metainfo_charset
op_assign
id|def_charset
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;-n&quot;
)paren
)paren
id|mi.metainfo_charset
op_assign
l_int|NULL
suffix:semicolon
r_else
r_if
c_cond
(paren
id|starts_with
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;--encoding=&quot;
)paren
)paren
id|mi.metainfo_charset
op_assign
id|argv
(braket
l_int|1
)braket
op_plus
l_int|11
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;--scissors&quot;
)paren
)paren
id|mi.use_scissors
op_assign
l_int|1
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;--no-scissors&quot;
)paren
)paren
id|mi.use_scissors
op_assign
l_int|0
suffix:semicolon
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;--no-inbody-headers&quot;
)paren
)paren
id|mi.use_inbody_headers
op_assign
l_int|0
suffix:semicolon
r_else
id|usage
c_func
(paren
id|mailinfo_usage
)paren
suffix:semicolon
id|argc
op_decrement
suffix:semicolon
id|argv
op_increment
suffix:semicolon
)brace
r_if
c_cond
(paren
id|argc
op_ne
l_int|3
)paren
id|usage
c_func
(paren
id|mailinfo_usage
)paren
suffix:semicolon
id|mi.input
op_assign
id|stdin
suffix:semicolon
id|mi.output
op_assign
id|stdout
suffix:semicolon
id|status
op_assign
op_logical_neg
op_logical_neg
id|mailinfo
c_func
(paren
op_amp
id|mi
comma
id|argv
(braket
l_int|1
)braket
comma
id|argv
(braket
l_int|2
)braket
)paren
suffix:semicolon
id|clear_mailinfo
c_func
(paren
op_amp
id|mi
)paren
suffix:semicolon
r_return
id|status
suffix:semicolon
)brace
eof
