macro_line|#include &quot;builtin.h&quot;
macro_line|#include &quot;cache.h&quot;
macro_line|#include &quot;strbuf.h&quot;
DECL|function|comment_lines
r_static
r_void
id|comment_lines
c_func
(paren
r_struct
id|strbuf
op_star
id|buf
)paren
(brace
r_char
op_star
id|msg
suffix:semicolon
r_int
id|len
suffix:semicolon
id|msg
op_assign
id|strbuf_detach
c_func
(paren
id|buf
comma
op_amp
id|len
)paren
suffix:semicolon
id|strbuf_add_commented_lines
c_func
(paren
id|buf
comma
id|msg
comma
id|len
)paren
suffix:semicolon
id|free
c_func
(paren
id|msg
)paren
suffix:semicolon
)brace
DECL|variable|usage_msg
r_static
r_const
r_char
op_star
id|usage_msg
op_assign
l_string|&quot;&bslash;n&quot;
l_string|&quot;  git stripspace [-s | --strip-comments] &lt; input&bslash;n&quot;
l_string|&quot;  git stripspace [-c | --comment-lines] &lt; input&quot;
suffix:semicolon
DECL|function|cmd_stripspace
r_int
id|cmd_stripspace
c_func
(paren
r_int
id|argc
comma
r_const
r_char
op_star
op_star
id|argv
comma
r_const
r_char
op_star
id|prefix
)paren
(brace
r_struct
id|strbuf
id|buf
op_assign
id|STRBUF_INIT
suffix:semicolon
r_int
id|strip_comments
op_assign
l_int|0
suffix:semicolon
r_enum
(brace
id|INVAL
op_assign
l_int|0
comma
id|STRIP_SPACE
op_assign
l_int|1
comma
id|COMMENT_LINES
op_assign
l_int|2
)brace
id|mode
op_assign
id|STRIP_SPACE
suffix:semicolon
r_if
c_cond
(paren
id|argc
op_eq
l_int|2
)paren
(brace
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;-s&quot;
)paren
op_logical_or
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;--strip-comments&quot;
)paren
)paren
(brace
id|strip_comments
op_assign
l_int|1
suffix:semicolon
)brace
r_else
r_if
c_cond
(paren
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;-c&quot;
)paren
op_logical_or
op_logical_neg
id|strcmp
c_func
(paren
id|argv
(braket
l_int|1
)braket
comma
l_string|&quot;--comment-lines&quot;
)paren
)paren
(brace
id|mode
op_assign
id|COMMENT_LINES
suffix:semicolon
)brace
r_else
(brace
id|mode
op_assign
id|INVAL
suffix:semicolon
)brace
)brace
r_else
r_if
c_cond
(paren
id|argc
OG
l_int|1
)paren
(brace
id|mode
op_assign
id|INVAL
suffix:semicolon
)brace
r_if
c_cond
(paren
id|mode
op_eq
id|INVAL
)paren
id|usage
c_func
(paren
id|usage_msg
)paren
suffix:semicolon
r_if
c_cond
(paren
id|strip_comments
op_logical_or
id|mode
op_eq
id|COMMENT_LINES
)paren
id|git_config
c_func
(paren
id|git_default_config
comma
l_int|NULL
)paren
suffix:semicolon
r_if
c_cond
(paren
id|strbuf_read
c_func
(paren
op_amp
id|buf
comma
l_int|0
comma
l_int|1024
)paren
OL
l_int|0
)paren
id|die_errno
c_func
(paren
l_string|&quot;could not read the input&quot;
)paren
suffix:semicolon
r_if
c_cond
(paren
id|mode
op_eq
id|STRIP_SPACE
)paren
id|strbuf_stripspace
c_func
(paren
op_amp
id|buf
comma
id|strip_comments
)paren
suffix:semicolon
r_else
id|comment_lines
c_func
(paren
op_amp
id|buf
)paren
suffix:semicolon
id|write_or_die
c_func
(paren
l_int|1
comma
id|buf.buf
comma
id|buf.len
)paren
suffix:semicolon
id|strbuf_release
c_func
(paren
op_amp
id|buf
)paren
suffix:semicolon
r_return
l_int|0
suffix:semicolon
)brace
eof
